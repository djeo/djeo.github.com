/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"dijit/form/nls/validate":function(){define("dijit/form/nls/validate",{root:({invalidMessage:"The value entered is not valid.",missingMessage:"This value is required.",rangeMessage:"This value is out of range."}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"dijit/form/TextBox":function(){require({cache:{"url:dijit/form/templates/TextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\" id=\"widget_${id}\" role=\"presentation\"\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\r\n\t\t\t${!nameAttrSetting} type='${type}'\r\n\t/></div\r\n></div>\r\n"}});define("dijit/form/TextBox",["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","./_FormValueWidget","./_TextBoxMixin","dojo/text!./templates/TextBox.html",".."],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_1([_8,_9],{templateString:_a,_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" data-dojo-attach-point=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:_6("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var _d=this.type.toLowerCase();if(this.templateString&&this.templateString.toLowerCase()=="input"||((_d=="hidden"||_d=="file")&&this.templateString==this.constructor.prototype.templateString)){this.templateString=this._singleNodeTemplate;}this.inherited(arguments);},_onInput:function(e){this.inherited(arguments);if(this.intermediateChanges){var _e=this;setTimeout(function(){_e._handleOnChange(_e.get("value"),false);},0);}},_setPlaceHolderAttr:function(v){this._set("placeHolder",v);if(!this._phspan){this._attachPoints.push("_phspan");this._phspan=_2.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");}this._phspan.innerHTML="";this._phspan.appendChild(document.createTextNode(v));this._updatePlaceHolder();},_updatePlaceHolder:function(){if(this._phspan){this._phspan.style.display=(this.placeHolder&&!this.focused&&!this.textbox.value)?"":"none";}},_setValueAttr:function(_f,_10,_11){this.inherited(arguments);this._updatePlaceHolder();},getDisplayedValue:function(){_4.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use set('displayedValue') instead.","","2.0");return this.get("displayedValue");},setDisplayedValue:function(_12){_4.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",_12);},_onBlur:function(e){if(this.disabled){return;}this.inherited(arguments);this._updatePlaceHolder();},_onFocus:function(by){if(this.disabled||this.readOnly){return;}this.inherited(arguments);this._updatePlaceHolder();}});if(_6("ie")){_c=_1(_c,{declaredClass:"dijit.form.TextBox",_isTextSelected:function(){var _13=_7.doc.selection.createRange();var _14=_13.parentElement();return _14==this.textbox&&_13.text.length==0;},postCreate:function(){this.inherited(arguments);setTimeout(_5.hitch(this,function(){try{var s=_3.getComputedStyle(this.domNode);if(s){var ff=s.fontFamily;if(ff){var _15=this.domNode.getElementsByTagName("INPUT");if(_15){for(var i=0;i<_15.length;i++){_15[i].style.fontFamily=ff;}}}}}catch(e){}}),0);}});_b._setSelectionRange=_9._setSelectionRange=function(_16,_17,_18){if(_16.createTextRange){var r=_16.createTextRange();r.collapse(true);r.moveStart("character",-99999);r.moveStart("character",_17);r.moveEnd("character",_18-_17);r.select();}};}else{if(_6("mozilla")){_c=_1(_c,{declaredClass:"dijit.form.TextBox",_onBlur:function(e){this.inherited(arguments);if(this.selectOnClick){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}}});}else{_c.prototype.declaredClass="dijit.form.TextBox";}}_5.setObject("dijit.form.TextBox",_c);return _c;});},"dijit/_editor/html":function(){define("dijit/_editor/html",["dojo/_base/lang","dojo/_base/sniff",".."],function(_19,has,_1a){_19.getObject("_editor",true,_1a);_1a._editor.escapeXml=function(str,_1b){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_1b){str=str.replace(/'/gm,"&#39;");}return str;};_1a._editor.getNodeHtml=function(_1c){var _1d;switch(_1c.nodeType){case 1:var _1e=_1c.nodeName.toLowerCase();if(!_1e||_1e.charAt(0)=="/"){return "";}_1d="<"+_1e;var _1f=[];var _20;if(has("ie")&&_1c.outerHTML){var s=_1c.outerHTML;s=s.substr(0,s.indexOf(">")).replace(/(['"])[^"']*\1/g,"");var reg=/(\b\w+)\s?=/g;var m,key;while((m=reg.exec(s))){key=m[1];if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(_1c.getAttribute("_djrealurl")){_1f.push([key,_1c.getAttribute("_djrealurl")]);continue;}}var val,_21;switch(key){case "style":val=_1c.style.cssText.toLowerCase();break;case "class":val=_1c.className;break;case "width":if(_1e==="img"){_21=/width=(\S+)/i.exec(s);if(_21){val=_21[1];}break;}case "height":if(_1e==="img"){_21=/height=(\S+)/i.exec(s);if(_21){val=_21[1];}break;}default:val=_1c.getAttribute(key);}if(val!=null){_1f.push([key,val.toString()]);}}}}else{var i=0;while((_20=_1c.attributes[i++])){var n=_20.name;if(n.substr(0,3)!="_dj"){var v=_20.value;if(n=="src"||n=="href"){if(_1c.getAttribute("_djrealurl")){v=_1c.getAttribute("_djrealurl");}}_1f.push([n,v]);}}}_1f.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((_20=_1f[j++])){_1d+=" "+_20[0]+"=\""+(_19.isString(_20[1])?_1a._editor.escapeXml(_20[1],true):_20[1])+"\"";}if(_1e==="script"){_1d+=">"+_1c.innerHTML+"</"+_1e+">";}else{if(_1c.childNodes.length){_1d+=">"+_1a._editor.getChildrenHtml(_1c)+"</"+_1e+">";}else{switch(_1e){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":_1d+=" />";break;default:_1d+="></"+_1e+">";}}}break;case 4:case 3:_1d=_1a._editor.escapeXml(_1c.nodeValue,true);break;case 8:_1d="<!--"+_1a._editor.escapeXml(_1c.nodeValue,true)+"-->";break;default:_1d="<!-- Element not recognized - Type: "+_1c.nodeType+" Name: "+_1c.nodeName+"-->";}return _1d;};_1a._editor.getChildrenHtml=function(dom){var out="";if(!dom){return out;}var _22=dom["childNodes"]||dom;var _23=!has("ie")||_22!==dom;var _24,i=0;while((_24=_22[i++])){if(!_23||_24.parentNode==dom){out+=_1a._editor.getNodeHtml(_24);}}return out;};return _1a._editor;});},"dijit/_editor/nls/commands":function(){define("dijit/_editor/nls/commands",{root:({"bold":"Bold","copy":"Copy","cut":"Cut","delete":"Delete","indent":"Indent","insertHorizontalRule":"Horizontal Rule","insertOrderedList":"Numbered List","insertUnorderedList":"Bullet List","italic":"Italic","justifyCenter":"Align Center","justifyFull":"Justify","justifyLeft":"Align Left","justifyRight":"Align Right","outdent":"Outdent","paste":"Paste","redo":"Redo","removeFormat":"Remove Format","selectAll":"Select All","strikethrough":"Strikethrough","subscript":"Subscript","superscript":"Superscript","underline":"Underline","undo":"Undo","unlink":"Remove Link","createLink":"Create Link","toggleDir":"Toggle Direction","insertImage":"Insert Image","insertTable":"Insert/Edit Table","toggleTableBorder":"Toggle Table Border","deleteTable":"Delete Table","tableProp":"Table Property","htmlToggle":"HTML Source","foreColor":"Foreground Color","hiliteColor":"Background Color","plainFormatBlock":"Paragraph Style","formatBlock":"Paragraph Style","fontSize":"Font Size","fontName":"Font Name","tabIndent":"Tab Indent","fullScreen":"Toggle Full Screen","viewSource":"View HTML Source","print":"Print","newPage":"New Page","systemShortcut":"The \"${0}\" action is only available in your browser using a keyboard shortcut. Use ${1}.","ctrlKey":"ctrl+${0}","appleKey":"âŒ˜${0}"}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range","../selection"],function(_25,_26,_27,_28,_29,has,win,_2a,_2b,_2c,_2d,_2e){return _25("dijit._editor.plugins.EnterKeyHandling",_2b,{blockNodeForEnter:"BR",constructor:function(_2f){if(_2f){if("blockNodeForEnter" in _2f){_2f.blockNodeForEnter=_2f.blockNodeForEnter.toUpperCase();}_29.mixin(this,_2f);}},setEditor:function(_30){if(this.editor===_30){return;}this.editor=_30;if(this.blockNodeForEnter=="BR"){this.editor.customUndo=true;_30.onLoadDeferred.then(_29.hitch(this,function(d){this.connect(_30.document,"onkeypress",function(e){if(e.charOrCode==_28.ENTER){var ne=_29.mixin({},e);ne.shiftKey=true;if(!this.handleEnterKey(ne)){_27.stop(e);}}});if(has("ie")==9){this.connect(_30.document,"onpaste",function(e){setTimeout(dojo.hitch(this,function(){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();r.move("character",1);r.select();}),0);});}return d;}));}else{if(this.blockNodeForEnter){var h=_29.hitch(this,this.handleEnterKey);_30.addKeyHandler(13,0,0,h);_30.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},onKeyPressed:function(){if(this._checkListLater){if(win.withGlobal(this.editor.window,"isCollapsed",dijit)){var _31=win.withGlobal(this.editor.window,"getAncestorElement",_2e,["LI"]);if(!_31){_2c.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _32=win.withGlobal(this.editor.window,"getAncestorElement",_2e,[this.blockNodeForEnter]);if(_32){_32.innerHTML=this.bogusHtmlContent;if(has("ie")){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{console.error("onKeyPressed: Cannot find the new block node");}}else{if(has("mozilla")){if(_31.parentNode.parentNode.nodeName=="LI"){_31=_31.parentNode.parentNode;}}var fc=_31.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_31.insertBefore(fc.ownerDocument.createTextNode("Â "),fc);var _33=_2d.create(this.editor.window);_33.setStart(_31.firstChild,0);var _34=_2d.getSelection(this.editor.window,true);_34.removeAllRanges();_34.addRange(_33);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){var _35,_36,_37,_38,_39,_3a,doc=this.editor.document,br,rs,txt;if(e.shiftKey){var _3b=win.withGlobal(this.editor.window,"getParentElement",_2e);var _3c=_2d.getAncestor(_3b,this.blockNodes);if(_3c){if(_3c.tagName=="LI"){return true;}_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);if(!_36.collapsed){_36.deleteContents();_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);}if(_2d.atBeginningOfContainer(_3c,_36.startContainer,_36.startOffset)){br=doc.createElement("br");_37=_2d.create(this.editor.window);_3c.insertBefore(br,_3c.firstChild);_37.setStartAfter(br);_35.removeAllRanges();_35.addRange(_37);}else{if(_2d.atEndOfContainer(_3c,_36.startContainer,_36.startOffset)){_37=_2d.create(this.editor.window);br=doc.createElement("br");_3c.appendChild(br);_3c.appendChild(doc.createTextNode("Â "));_37.setStart(_3c.lastChild,0);_35.removeAllRanges();_35.addRange(_37);}else{rs=_36.startContainer;if(rs&&rs.nodeType==3){txt=rs.nodeValue;win.withGlobal(this.editor.window,function(){_38=doc.createTextNode(txt.substring(0,_36.startOffset));_39=doc.createTextNode(txt.substring(_36.startOffset));_3a=doc.createElement("br");if(_39.nodeValue==""&&has("webkit")){_39=doc.createTextNode("Â ");}_26.place(_38,rs,"after");_26.place(_3a,_38,"after");_26.place(_39,_3a,"after");_26.destroy(rs);_37=_2d.create();_37.setStart(_39,0);_35.removeAllRanges();_35.addRange(_37);});return false;}return true;}}}else{_35=_2d.getSelection(this.editor.window);if(_35.rangeCount){_36=_35.getRangeAt(0);if(_36&&_36.startContainer){if(!_36.collapsed){_36.deleteContents();_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);}rs=_36.startContainer;if(rs&&rs.nodeType==3){win.withGlobal(this.editor.window,_29.hitch(this,function(){var _3d=false;var _3e=_36.startOffset;if(rs.length<_3e){ret=this._adjustNodeAndOffset(rs,_3e);rs=ret.node;_3e=ret.offset;}txt=rs.nodeValue;_38=doc.createTextNode(txt.substring(0,_3e));_39=doc.createTextNode(txt.substring(_3e));_3a=doc.createElement("br");if(!_39.length){_39=doc.createTextNode("Â ");_3d=true;}if(_38.length){_26.place(_38,rs,"after");}else{_38=rs;}_26.place(_3a,_38,"after");_26.place(_39,_3a,"after");_26.destroy(rs);_37=_2d.create();_37.setStart(_39,0);_37.setEnd(_39,_39.length);_35.removeAllRanges();_35.addRange(_37);if(_3d&&!has("webkit")){_2e.remove();}else{_2e.collapse(true);}}));}else{var _3f;if(_36.startOffset>=0){_3f=rs.childNodes[_36.startOffset];}win.withGlobal(this.editor.window,_29.hitch(this,function(){var _40=doc.createElement("br");var _41=doc.createTextNode("Â ");if(!_3f){rs.appendChild(_40);rs.appendChild(_41);}else{_26.place(_40,_3f,"before");_26.place(_41,_40,"after");}_37=_2d.create(win.global);_37.setStart(_41,0);_37.setEnd(_41,_41.length);_35.removeAllRanges();_35.addRange(_37);_2e.collapse(true);}));}}}else{_2c.prototype.execCommand.call(this.editor,"inserthtml","<br>");}}return false;}var _42=true;_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);if(!_36.collapsed){_36.deleteContents();_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);}var _43=_2d.getBlockAncestor(_36.endContainer,null,this.editor.editNode);var _44=_43.blockNode;if((this._checkListLater=(_44&&(_44.nodeName=="LI"||_44.parentNode.nodeName=="LI")))){if(has("mozilla")){this._pressedEnterInBlock=_44;}if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_44.innerHTML)){_44.innerHTML="";if(has("webkit")){_37=_2d.create(this.editor.window);_37.setStart(_44,0);_35.removeAllRanges();_35.addRange(_37);}this._checkListLater=false;}return true;}if(!_43.blockNode||_43.blockNode===this.editor.editNode){try{_2c.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);}catch(e2){}_43={blockNode:win.withGlobal(this.editor.window,"getAncestorElement",_2e,[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_43.blockNode){if(_43.blockNode!=this.editor.editNode&&(!(_43.blockNode.textContent||_43.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){this.removeTrailingBr(_43.blockNode);return false;}}else{_43.blockNode=this.editor.editNode;}_35=_2d.getSelection(this.editor.window);_36=_35.getRangeAt(0);}var _45=doc.createElement(this.blockNodeForEnter);_45.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_43.blockNode);var _46=_36.endOffset;var _47=_36.endContainer;if(_47.length<_46){var ret=this._adjustNodeAndOffset(_47,_46);_47=ret.node;_46=ret.offset;}if(_2d.atEndOfContainer(_43.blockNode,_47,_46)){if(_43.blockNode===_43.blockContainer){_43.blockNode.appendChild(_45);}else{_26.place(_45,_43.blockNode,"after");}_42=false;_37=_2d.create(this.editor.window);_37.setStart(_45,0);_35.removeAllRanges();_35.addRange(_37);if(this.editor.height){_2a.scrollIntoView(_45);}}else{if(_2d.atBeginningOfContainer(_43.blockNode,_36.startContainer,_36.startOffset)){_26.place(_45,_43.blockNode,_43.blockNode===_43.blockContainer?"first":"before");if(_45.nextSibling&&this.editor.height){_37=_2d.create(this.editor.window);_37.setStart(_45.nextSibling,0);_35.removeAllRanges();_35.addRange(_37);_2a.scrollIntoView(_45.nextSibling);}_42=false;}else{if(_43.blockNode===_43.blockContainer){_43.blockNode.appendChild(_45);}else{_26.place(_45,_43.blockNode,"after");}_42=false;if(_43.blockNode.style){if(_45.style){if(_43.blockNode.style.cssText){_45.style.cssText=_43.blockNode.style.cssText;}}}rs=_36.startContainer;var _48;if(rs&&rs.nodeType==3){var _49,_4a;_46=_36.endOffset;if(rs.length<_46){ret=this._adjustNodeAndOffset(rs,_46);rs=ret.node;_46=ret.offset;}txt=rs.nodeValue;_38=doc.createTextNode(txt.substring(0,_46));_39=doc.createTextNode(txt.substring(_46,txt.length));_26.place(_38,rs,"before");_26.place(_39,rs,"after");_26.destroy(rs);var _4b=_38.parentNode;while(_4b!==_43.blockNode){var tg=_4b.tagName;var _4c=doc.createElement(tg);if(_4b.style){if(_4c.style){if(_4b.style.cssText){_4c.style.cssText=_4b.style.cssText;}}}if(_4b.tagName==="FONT"){if(_4b.color){_4c.color=_4b.color;}if(_4b.face){_4c.face=_4b.face;}if(_4b.size){_4c.size=_4b.size;}}_49=_39;while(_49){_4a=_49.nextSibling;_4c.appendChild(_49);_49=_4a;}_26.place(_4c,_4b,"after");_38=_4b;_39=_4c;_4b=_4b.parentNode;}_49=_39;if(_49.nodeType==1||(_49.nodeType==3&&_49.nodeValue)){_45.innerHTML="";}_48=_49;while(_49){_4a=_49.nextSibling;_45.appendChild(_49);_49=_4a;}}_37=_2d.create(this.editor.window);var _4d;var _4e=_48;if(this.blockNodeForEnter!=="BR"){while(_4e){_4d=_4e;_4a=_4e.firstChild;_4e=_4a;}if(_4d&&_4d.parentNode){_45=_4d.parentNode;_37.setStart(_45,0);_35.removeAllRanges();_35.addRange(_37);if(this.editor.height){_2a.scrollIntoView(_45);}if(has("mozilla")){this._pressedEnterInBlock=_43.blockNode;}}else{_42=true;}}else{_37.setStart(_45,0);_35.removeAllRanges();_35.addRange(_37);if(this.editor.height){_2a.scrollIntoView(_45);}if(has("mozilla")){this._pressedEnterInBlock=_43.blockNode;}}}}return _42;},_adjustNodeAndOffset:function(_4f,_50){while(_4f.length<_50&&_4f.nextSibling&&_4f.nextSibling.nodeType==3){_50=_50-_4f.length;_4f=_4f.nextSibling;}return {"node":_4f,"offset":_50};},removeTrailingBr:function(_51){var _52=/P|DIV|LI/i.test(_51.tagName)?_51:_2e.getParentOfType(_51,["P","DIV","LI"]);if(!_52){return;}if(_52.lastChild){if((_52.childNodes.length>1&&_52.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(_52.lastChild.nodeValue))||_52.lastChild.tagName=="BR"){_26.destroy(_52.lastChild);}}if(!_52.childNodes.length){_52.innerHTML=this.bogusHtmlContent;}}});});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/_base/window","dojo/i18n!./nls/ComboBox"],function(_53,_54,_55,_56,win){return _54("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=_56.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_57){this.value=_57;this.onChange(_57);},onClick:function(_58){if(_58==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(_58==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(_58);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(_59,_5a){var _5b=this._createMenuItem();var _5c=_5a(_59);if(_5c.html){_5b.innerHTML=_5c.label;}else{_5b.appendChild(win.doc.createTextNode(_5c.label));}if(_5b.innerHTML==""){_5b.innerHTML="&#160;";}this.applyTextDir(_5b,(_5b.innerText||_5b.textContent||""));return _5b;},createOptions:function(_5d,_5e,_5f){this.items=_5d;this.previousButton.style.display=(_5e.start==0)?"none":"";_55.set(this.previousButton,"id",this.id+"_prev");_53.forEach(_5d,function(_60,i){var _61=this._createOption(_60,_5f);_61.setAttribute("item",i);_55.set(_61,"id",this.id+i);this.nextButton.parentNode.insertBefore(_61,this.nextButton);},this);var _62=false;if(_5d.total&&!_5d.total.then&&_5d.total!=-1){if((_5e.start+_5e.count)<_5d.total){_62=true;}else{if((_5e.start+_5e.count)>_5d.total&&_5e.count==_5d.length){_62=true;}}}else{if(_5e.count==_5d.length){_62=true;}}this.nextButton.style.display=_62?"":"none";_55.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _63=this.containerNode;while(_63.childNodes.length>2){_63.removeChild(_63.childNodes[_63.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this._getSelectedAttr();}});});},"dijit/form/NumberSpinner":function(){define("dijit/form/NumberSpinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","./_Spinner","./NumberTextBox"],function(_64,_65,_66,_67,_68){return _64("dijit.form.NumberSpinner",[_67,_68.Mixin],{adjust:function(val,_69){var tc=this.constraints,v=isNaN(val),_6a=!isNaN(tc.max),_6b=!isNaN(tc.min);if(v&&_69!=0){val=(_69>0)?_6b?tc.min:_6a?tc.max:0:_6a?this.constraints.max:_6b?tc.min:0;}var _6c=val+_69;if(v||isNaN(_6c)){return val;}if(_6a&&(_6c>tc.max)){_6c=tc.max;}if(_6b&&(_6c<tc.min)){_6c=tc.min;}return _6c;},_onKeyPress:function(e){if((e.charOrCode==_66.HOME||e.charOrCode==_66.END)&&!(e.ctrlKey||e.altKey||e.metaKey)&&typeof this.get("value")!="undefined"){var _6d=this.constraints[(e.charOrCode==_66.HOME?"min":"max")];if(typeof _6d=="number"){this._setValueAttr(_6d,false);}_65.stop(e);}}});});},"dijit/form/DateTextBox":function(){define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(_6e,_6f,_70){return _6e("dijit.form.DateTextBox",_70,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:_6f,_selector:"date",value:new Date("")});});},"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\r\n\t<thead>\r\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\r\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\r\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\r\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\r\n\t\t\t</th>\r\n\t\t\t<th class='dijitReset' colspan=\"5\">\r\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\r\n\t\t\t\t</div>\r\n\t\t\t</th>\r\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\r\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\r\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\r\n\t\t\t</th>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t${!dayCellsHtml}\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\r\n\t\t\t${!dateRowsHtml}\r\n\t</tbody>\r\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\r\n\t\t<tr>\r\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\r\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\r\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\r\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\r\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\r\n\t\t\t\t</div>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</tfoot>\r\n</table>\r\n","dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/_base/connect","dojo/data/util/filter","dojo/_base/declare","dojo/_base/Deferred","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/_base/sniff","dojo/string","dojo/_base/window","./DataList","../registry","./_TextBoxMixin"],function(_71,_72,_73,_74,_75,_76,_77,_78,_79,_7a,has,_7b,win,_7c,_7d,_7e){return _73("dijit.form._AutoCompleterMixin",null,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_7f){var pos=0;if(typeof (_7f.selectionStart)=="number"){pos=_7f.selectionStart;}else{if(has("ie")){var tr=win.doc.selection.createRange().duplicate();var ntr=_7f.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_80,_81){_81=parseInt(_81);_7e.selectInputText(_80,_81,_81);},_setDisabledAttr:function(_82){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_82);},_abortQuery:function(){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}if(this._fetchHandle){if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_onInput:function(evt){this.inherited(arguments);if(evt.charOrCode==229){this._onKey(evt);}},_onKey:function(evt){var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==_77.SHIFT){return;}var _83=false;var pw=this.dropDown;var _84=null;this._prev_key_backspace=false;this._abortQuery();this.inherited(arguments);if(this._opened){_84=pw.getHighlightedOption();}switch(key){case _77.PAGE_DOWN:case _77.DOWN_ARROW:case _77.PAGE_UP:case _77.UP_ARROW:if(this._opened){this._announceOption(_84);}_76.stop(evt);break;case _77.ENTER:if(_84){if(_84==pw.nextButton){this._nextSearch(1);_76.stop(evt);break;}else{if(_84==pw.previousButton){this._nextSearch(-1);_76.stop(evt);break;}}}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}if(this._opened||this._fetchHandle){_76.stop(evt);}case _77.TAB:var _85=this.get("displayedValue");if(pw&&(_85==pw._messages["previousMessage"]||_85==pw._messages["nextMessage"])){break;}if(_84){this._selectOption(_84);}case _77.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;case " ":if(_84){_76.stop(evt);this._selectOption(_84);this.closeDropDown();}else{_83=true;}break;case _77.DELETE:case _77.BACKSPACE:this._prev_key_backspace=true;_83=true;break;default:_83=typeof key=="string"||key==229;}if(_83){this.item=undefined;this.searchTimer=setTimeout(_78.hitch(this,"_startSearchFromInput"),1);}},_autoCompleteText:function(_86){var fn=this.focusNode;_7e.selectInputText(fn,fn.value.length);var _87=this.ignoreCase?"toLowerCase":"substr";if(_86[_87](0).indexOf(this.focusNode.value[_87](0))==0){var _88=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((_88+1)>fn.value.length){fn.value=_86;_7e.selectInputText(fn,_88);}}else{fn.value=_86;_7e.selectInputText(fn);}},_openResultList:function(_89,_8a,_8b){this._fetchHandle=null;if(this.disabled||this.readOnly||(_8a[this.searchAttr]!==this._lastQuery)){return;}var _8c=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_89.length&&_8b.start==0){this.closeDropDown();return;}this.dropDown.createOptions(_89,_8b,_78.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if(_8b.direction){if(1==_8b.direction){this.dropDown.highlightFirstOption();}else{if(-1==_8b.direction){this.dropDown.highlightLastOption();}}if(_8c){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_8a[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _8d=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_8d==pw._messages["previousMessage"]||_8d==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_8d);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(_8e,_8f,_90){var _91="";if(_8e){if(!_90){_90=this.store._oldAPI?this.store.getValue(_8e,this.searchAttr):_8e[this.searchAttr];}_91=this._getValueField()!=this.searchAttr?this.store.getIdentity(_8e):_90;}this.set("value",_91,_8f,_90,_8e);},_announceOption:function(_92){if(!_92){return;}var _93;if(_92==this.dropDown.nextButton||_92==this.dropDown.previousButton){_93=_92.innerHTML;this.item=undefined;this.value="";}else{var _94=this.dropDown.items[_92.getAttribute("item")];_93=(this.store._oldAPI?this.store.getValue(_94,this.searchAttr):_94[this.searchAttr]).toString();this.set("item",_94,false,_93);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_75.get(_92,"id"));this._autoCompleteText(_93);},_selectOption:function(_95){this.closeDropDown();if(_95){this._announceOption(_95);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_getQueryString:function(_96){return _7b.substitute(this.queryExpr,[_96]);},_startSearch:function(key){if(!this.dropDown){var _97=this.id+"_popup",_98=_78.isString(this.dropDownClass)?_78.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _98({onChange:_78.hitch(this,this._selectOption),id:_97,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_97);}this._lastInput=key;var _99=_78.clone(this.query);var _9a={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}};_78.mixin(_9a,this.fetchProperties);var qs=this._getQueryString(key),q;if(this.store._oldAPI){q=qs;}else{q=_72.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_99[this.searchAttr]=q;var _9b=this,_9c=function(){var _9d=_9b._fetchHandle=_9b.store.query(_99,_9a);_74.when(_9d,function(res){_9b._fetchHandle=null;res.total=_9d.total;_9b._openResultList(res,_99,_9a);},function(err){_9b._fetchHandle=null;if(!_9b._cancelingQuery){console.error(_9b.declaredClass+" "+err.toString());_9b.closeDropDown();}});};this.searchTimer=setTimeout(_78.hitch(this,function(_9e,_9f){this.searchTimer=null;_9c();this._nextSearch=this.dropDown.onPage=function(_a0){_9a.start+=_9a.count*_a0;_9a.direction=_a0;_9c();_9f.focus();};},_99,this),this.searchDelay);},_getValueField:function(){return this.searchAttr;},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var _a1=this.srcNodeRef;var _a2=this.list;if(_a2){this.store=_7d.byId(_a2);}else{this.store=new _7c({},_a1);}if(!("value" in this.params)){var _a3=(this.item=this.store.fetchSelectedItem());if(_a3){var _a4=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(_a3,_a4):_a3[_a4];}}}this.inherited(arguments);},postCreate:function(){var _a5=_79("label[for=\""+this.id+"\"]");if(_a5.length){_a5[0].id=(this.id+"_label");this.domNode.setAttribute("aria-labelledby",_a5[0].id);}this.inherited(arguments);},_getMenuLabelFromItem:function(_a6){var _a7=this.labelFunc(_a6,this.store),_a8=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_a7=this.doHighlight(_a7,this._escapeHtml(this._lastInput));_a8="html";}return {html:_a8=="html",label:_a7};},doHighlight:function(_a9,_aa){var _ab=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");_aa=_7a.escapeString(_aa);return this._escapeHtml(_a9).replace(new RegExp((i==0?"^":"")+"("+_aa+")"+(i==(this.queryExpr.length-4)?"$":""),_ab),"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(_ac,_ad){return (_ad._oldAPI?_ad.getValue(_ac,this.labelAttr||this.searchAttr):_ac[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_ae,_af,_b0,_b1){this._set("item",_b1||null);if(!_ae){_ae="";}this.inherited(arguments);},_setTextDirAttr:function(_b2){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_b2);}}});});},"dijit/form/MappedTextBox":function(){define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_b3,_b4,_b5){return _b3("dijit.form.MappedTextBox",_b5,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_b4.place("<input type='hidden'"+(this.name?" name='"+this.name.replace(/'/g,"&quot;")+"'":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/ComboBoxMixin":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\"\r\n\trole=\"combobox\"\r\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\r\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\r\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/></div\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\r\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\r\n\t/></div\r\n></div>\r\n"}});define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_b6,_b7,_b8,_b9,_ba,_bb,_bc,_bd,_be){return _b6("dijit.form.ComboBoxMixin",[_bd,_bb],{dropDownClass:_bc,hasDownArrow:true,templateString:_be,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_bf){if(!_bf.get){_b9.mixin(_bf,{_oldAPI:true,get:function(id){var _c0=new _b7();this.fetchItemByIdentity({identity:id,onItem:function(_c1){_c0.resolve(_c1);},onError:function(_c2){_c0.reject(_c2);}});return _c0.promise;},query:function(_c3,_c4){var _c5=new _b7(function(){_c6.abort&&_c6.abort();});var _c6=this.fetch(_b9.mixin({query:_c3,onBegin:function(_c7){_c5.total=_c7;},onComplete:function(_c8){_c5.resolve(_c8);},onError:function(_c9){_c5.reject(_c9);}},_c4));return _ba(_c5);}});}this._set("store",_bf);},postMixInProperties:function(){if(this.params.store){this._setStoreAttr(this.params.store);}this.inherited(arguments);if(!this.params.store){var _ca=this.declaredClass;_b9.mixin(this.store,{getValue:function(_cb,_cc){_b8.deprecated(_ca+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return _cb[_cc];},getLabel:function(_cd){_b8.deprecated(_ca+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return _cd.name;},fetch:function(_ce){_b8.deprecated(_ca+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var _cf=["dojo/data/ObjectStore"];require(_cf,_b9.hitch(this,function(_d0){new _d0({objectStore:this}).fetch(_ce);}));}});}}});});},"dijit/form/_TextBoxMixin":function(){define("dijit/form/_TextBoxMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/_base/event","dojo/keys","dojo/_base/lang",".."],function(_d1,_d2,dom,_d3,_d4,_d5,_d6){var _d7=_d2("dijit.form._TextBoxMixin",null,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints);},_setValueAttr:function(_d8,_d9,_da){var _db;if(_d8!==undefined){_db=this.filter(_d8);if(typeof _da!="string"){if(_db!==null&&((typeof _db!="number")||!isNaN(_db))){_da=this.filter(this.format(_db,this.constraints));}else{_da="";}}}if(_da!=null&&_da!=undefined&&((typeof _da)!="number"||!isNaN(_da))&&this.textbox.value!=_da){this.textbox.value=_da;this._set("displayedValue",this.get("displayedValue"));}if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_da);}this.inherited(arguments,[_db,_d9]);},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},_setDisplayedValueAttr:function(_dc){if(_dc===null||_dc===undefined){_dc="";}else{if(typeof _dc!="string"){_dc=String(_dc);}}this.textbox.value=_dc;this._setValueAttr(this.get("value"),undefined);this._set("displayedValue",this.get("displayedValue"));if(this.textDir=="auto"){this.applyTextDir(this.focusNode,_dc);}},format:function(_dd){return ((_dd==null||_dd==undefined)?"":(_dd.toString?_dd.toString():_dd));},parse:function(_de){return _de;},_refreshState:function(){},onInput:function(){},__skipInputEvent:false,_onInput:function(){if(this.textDir=="auto"){this.applyTextDir(this.focusNode,this.focusNode.value);}this._refreshState();this._set("displayedValue",this.get("displayedValue"));},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);var _df=function(e){var _e0=e.charOrCode||e.keyCode||229;if(e.type=="keydown"){switch(_e0){case _d4.SHIFT:case _d4.ALT:case _d4.CTRL:case _d4.META:case _d4.CAPS_LOCK:return;default:if(_e0>=65&&_e0<=90){return;}}}if(e.type=="keypress"&&typeof _e0!="string"){return;}if(e.type=="input"){if(this.__skipInputEvent){this.__skipInputEvent=false;return;}}else{this.__skipInputEvent=true;}var _e1=_d5.mixin({},e,{charOrCode:_e0,wasConsumed:false,preventDefault:function(){_e1.wasConsumed=true;e.preventDefault();},stopPropagation:function(){e.stopPropagation();}});if(this.onInput(_e1)===false){_d3.stop(_e1);}if(_e1.wasConsumed){return;}setTimeout(_d5.hitch(this,"_onInput",_e1),0);};_d1.forEach(["onkeydown","onkeypress","onpaste","oncut","oninput","oncompositionend"],function(_e2){this.connect(this.textbox,_e2,_df);},this);},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=_d5.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(_e3){return _e3.substring(0,1).toUpperCase()+_e3.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.get("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);}},_isTextSelected:function(){return this.textbox.selectionStart==this.textbox.selectionEnd;},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);if(this._isTextSelected()){_d7.selectInputText(this.textbox);}});}this.inherited(arguments);this._refreshState();},reset:function(){this.textbox.value="";this.inherited(arguments);},_setTextDirAttr:function(_e4){if(!this._created||this.textDir!=_e4){this._set("textDir",_e4);this.applyTextDir(this.focusNode,this.focusNode.value);}}});_d7._setSelectionRange=_d6._setSelectionRange=function(_e5,_e6,_e7){if(_e5.setSelectionRange){_e5.setSelectionRange(_e6,_e7);}};_d7.selectInputText=_d6.selectInputText=function(_e8,_e9,_ea){_e8=dom.byId(_e8);if(isNaN(_e9)){_e9=0;}if(isNaN(_ea)){_ea=_e8.value?_e8.value.length:0;}try{_e8.focus();_d7._setSelectionRange(_e8,_e9,_ea);}catch(e){}};return _d7;});},"dijit/form/SimpleTextarea":function(){define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/_base/sniff","dojo/_base/window","./TextBox"],function(_eb,_ec,has,win,_ed){return _eb("dijit.form.SimpleTextarea",_ed,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_ec.add(this.textbox,"dijitTextAreaCols");}},filter:function(_ee){if(_ee){_ee=_ee.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _ef=parseInt(this.maxLength);var _f0=this.textbox.value.replace(/\r/g,"");var _f1=_f0.length-_ef;if(_f1>0){var _f2=this.textbox;if(_f2.selectionStart){var pos=_f2.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_f0.substring(0,pos-_f1-cr)+_f0.substring(pos-cr);_f2.setSelectionRange(pos-_f1,pos-_f1);}else{if(win.doc.selection){_f2.focus();var _f3=win.doc.selection.createRange();_f3.moveStart("character",-_f1);_f3.text="";_f3.select();}}}}this.inherited(arguments);}});});},"dijit/_editor/plugins/TextColor":function(){define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_f4,_f5,_f6,_f7,_f8,_f9){var _fa=_f6("dijit._editor.plugins.TextColor",_f8,{buttonClass:_f9,useDefaultCommand:false,_initButton:function(){this.inherited(arguments);var _fb=this;this.button.loadDropDown=function(_fc){_f4(["../../ColorPalette"],_f7.hitch(this,function(_fd){this.dropDown=new _fd({value:_fb.value,onChange:function(_fe){_fb.editor.execCommand(_fb.command,_fe);}});_fc();}));};},updateState:function(){var _ff=this.editor;var _100=this.command;if(!_ff||!_ff.isLoaded||!_100.length){return;}if(this.button){var _101=this.get("disabled");this.button.set("disabled",_101);if(_101){return;}var _102;try{_102=_ff.queryCommandValue(_100)||"";}catch(e){_102="";}}if(_102==""){_102="#000000";}if(_102=="transparent"){_102="#ffffff";}if(typeof _102=="string"){if(_102.indexOf("rgb")>-1){_102=_f5.fromRgb(_102).toHex();}}else{_102=((_102&255)<<16)|(_102&65280)|((_102&16711680)>>>16);_102=_102.toString(16);_102="#000000".slice(0,7-_102.length)+_102;}this.value=_102;var _103=this.button.dropDown;if(_103&&_102!==_103.get("value")){_103.set("value",_102,false);}}});_f8.registry["foreColor"]=function(){return new _fa({command:"foreColor"});};_f8.registry["hiliteColor"]=function(){return new _fa({command:"hiliteColor"});};return _fa;});},"esri/dijit/AttributeInspector":function(){define(["dijit","dojo","dojox","dojo/require!dojo/fx,dojox/gfx,dijit/_Widget,dijit/_Templated,dijit/Editor,dijit/_editor/plugins/LinkDialog,dijit/_editor/plugins/TextColor,esri/dijit/editing/AttachmentEditor,esri/dijit/editing/Util,esri/tasks/query,dijit/form/DateTextBox,dijit/form/TextBox,dijit/form/NumberTextBox,dijit/form/FilteringSelect,dijit/form/NumberSpinner,dijit/form/Button,dijit/form/SimpleTextarea,dijit/Tooltip,dojo/data/ItemFileReadStore"],function(_104,dojo,_105){dojo.provide("esri.dijit.AttributeInspector");dojo.require("dojo.fx");dojo.require("dojox.gfx");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dijit.Editor");dojo.require("dijit._editor.plugins.LinkDialog");dojo.require("dijit._editor.plugins.TextColor");dojo.require("esri.dijit.editing.AttachmentEditor");dojo.require("esri.dijit.editing.Util");dojo.require("esri.tasks.query");dojo.require("dijit.form.DateTextBox");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.NumberSpinner");dojo.require("dijit.form.Button");dojo.require("dijit.form.SimpleTextarea");dojo.require("dijit.Tooltip");dojo.require("dojo.data.ItemFileReadStore");(function(){var link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=dojo.moduleUrl("esri","dijit/css/AttributeInspector.css");document.getElementsByTagName("head").item(0).appendChild(link);})();dojo.declare("esri.dijit.AttributeInspector",[_104._Widget,_104._Templated],{widgetsInTemplate:true,templateString:"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n",_navMessage:"( ${idx} ${of} ${numFeatures} )",onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},constructor:function(_106,_107){dojo.mixin(this,esri.bundle.widgets.attributeInspector);_106=_106||{};if(!_106.featureLayer&&!_106.layerInfos){console.error("esri.AttributeInspector: please provide correct parameter in the constructor");}this._userIds={};if(_106.featureLayer&&_106.featureLayer.credential){var _108=_106.featureLayer.id;this._userIds[_108]=_106.featureLayer.credential.userId;}else{if(_106.layerInfos){var _109=_106.layerInfos;dojo.forEach(_109,function(_10a){if(_10a.featureLayer){var _10b=_10a.featureLayer.id;if(_10a.featureLayer.credential){this._userIds[_10b]=_10a.featureLayer.credential.userId;}if(_10a.userId){this._userIds[_10b]=_10a.userId;}}},this);}}this._datePackage=this._getDatePackage(_106);this._layerInfos=_106.layerInfos||[{featureLayer:_106.featureLayer,options:_106.options||[]}];this._aiConnects=[];this._selection=[];this._toolTips=[];this._numFeatures=0;this._featureIdx=0;this._currentLInfo=null;this._currentFeature=null;this._hideNavButtons=_106.hideNavButtons||false;},postCreate:function(){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();},destroy:function(){this._destroyAttributeTable();dojo.forEach(this._aiConnects,dojo.disconnect);delete this._aiConnects;if(this._attachmentEditor){this._attachmentEditor.destroy();delete this._attachmentEditor;}delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments);},refresh:function(){this._updateSelection();},first:function(){this.onFirstFeature();},last:function(){this.onLastFeature();},next:function(){this.onNextFeature();},previous:function(){this.onPreviousFeature();},showFeature:function(_10c,_10d){if(_10d){this._createOnlyFirstTime=true;}this._updateSelection([_10c],_10d);this._updateUI();},onLayerSelectionChange:function(_10e,_10f,_110){this._createOnlyFirstTime=false;this._featureIdx=(_110===esri.layers.FeatureLayer.SELECTION_NEW)?0:this._featureIdx;this._updateSelection();this._updateUI();},onLayerSelectionClear:function(){if(!this._selection||this._selection.length<=0){return;}this._numFeatures=0;this._featureIdx=0;this._selection=[];this._currentFeature=null;this._currentLInfo=null;this._updateUI();},onLayerEditsComplete:function(_111,adds,_112,_113){_113=_113||[];if(_113.length){var _114=this._selection;var _115=_111.featureLayer.objectIdField;dojo.forEach(_113,dojo.hitch(this,function(del){dojo.some(_114,dojo.hitch(this,function(item,idx){if(item.attributes[_115]!==del.objectId){return false;}this._selection.splice(idx,1);return true;}));}));}adds=adds||[];if(adds.length){this._selection=esri.dijit.editing.Util.LayerHelper.findFeatures(adds,_111.featureLayer);this._featureIdx=0;}var _116=this._numFeatures=this._selection?this._selection.length:0;if(adds.length){var _117=_116?this._selection[this._featureIdx]:null;if(_117){var _118=_117.getLayer();var _119=_118.getEditCapabilities();if(!(_119.canCreate&&!_119.canUpdate)){this._showFeature(_117);}}}this._updateUI();},onFieldValueChange:function(_11a,_11b){_11b=(typeof _11b==="undefined")?null:_11b;var _11c=_11a.field;if(_11c.type==="esriFieldTypeDate"){_11b=(_11b&&_11b.getTime)?_11b.getTime():(_11b&&_11b.toGregorian?_11b.toGregorian().getTime():_11b);}if(this._currentFeature.attributes[_11c.name]===_11b){return;}var _11d=this._currentLInfo;var _11e=this._currentFeature;var _11f=_11c.name;if(_11f===_11d.typeIdField){var type=this._findFirst(_11d.types,"id",_11b);var _120=_11d.fieldInfos;dojo.forEach(_120,function(_121){_11c=_121.field;if(!_11c||_11c.name===_11d.typeIdField){return;}var node=_121.dijit;var _122=this._setFieldDomain(node,type,_11c);if(_122&&node){this._setValue(node,_11e.attributes[_11c.name]+"");if(node.isValid()===false){this._setValue(node,null);}}},this);}this.onAttributeChange(_11e,_11f,_11b);},onDeleteBtn:function(evt){this._deleteFeature();},onNextFeature:function(evt){this._onNextFeature(1);},onPreviousFeature:function(evt){this._onNextFeature(-1);},onFirstFeature:function(evt){this._onNextFeature(this._featureIdx*-1);},onLastFeature:function(evt){this._onNextFeature((this._numFeatures-1)-this._featureIdx);},_initLayerInfos:function(){var _123=this._layerInfos;this._editorTrackingInfos={};dojo.forEach(_123,this._initLayerInfo,this);},_initLayerInfo:function(_124){var _125=_124.featureLayer;this._connect(_125,"onSelectionComplete",dojo.hitch(this,"onLayerSelectionChange",_124));this._connect(_125,"onSelectionClear",dojo.hitch(this,"onLayerSelectionClear",_124));this._connect(_125,"onEditsComplete",dojo.hitch(this,"onLayerEditsComplete",_124));_124.showAttachments=_125.hasAttachments?(esri._isDefined(_124.showAttachments)?_124.showAttachments:true):false;_124.hideFields=_124.hideFields||[];_124.htmlFields=_124.htmlFields||[];_124.isEditable=_125.isEditable()?(esri._isDefined(_124.isEditable)?_124.isEditable:true):false;_124.typeIdField=_125.typeIdField;_124.layerId=_125.id;_124.types=_125.types;if(!_124.showGlobalID&&_125.globalIdField){_124.hideFields.push(_125.globalIdField);}if(!_124.showObjectID){_124.hideFields.push(_125.objectIdField);}var _126=this._getFields(_124.featureLayer);if(!_126){return;}var _127=_124.fieldInfos||[];_127=dojo.map(_127,function(_128){return dojo.mixin({},_128);});if(!_127.length){_126=dojo.filter(_126,dojo.hitch(this,function(_129){return !this._isInFields(_129.name,_124.hideFields);}));_124.fieldInfos=dojo.map(_126,dojo.hitch(this,function(_12a){var _12b=(this._isInFields(_12a.name,_124.htmlFields)?esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT:esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTBOX);return {"fieldName":_12a.name,"field":_12a,"stringFieldOption":_12b};}));}else{_124.fieldInfos=dojo.filter(dojo.map(_127,dojo.hitch(this,function(_12c){var _12d=_12c.stringFieldOption||(this._isInFields(_12c.fieldName,_124.htmlFields)?esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT:esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTBOX);return dojo.mixin(_12c,{"field":this._findFirst(_126,"name",_12c.fieldName),"stringFieldOption":_12d});})),"return item.field;");}var _12e=[];if(_125.editFieldsInfo){if(_125.editFieldsInfo.creatorField){_12e.push(_125.editFieldsInfo.creatorField);}if(_125.editFieldsInfo.creationDateField){_12e.push(_125.editFieldsInfo.creationDateField);}if(_125.editFieldsInfo.editorField){_12e.push(_125.editFieldsInfo.editorField);}if(_125.editFieldsInfo.editDateField){_12e.push(_125.editFieldsInfo.editDateField);}}this._editorTrackingInfos[_125.id]=_12e;},_createAttachmentEditor:function(){this._attachmentEditor=null;var _12f=this._layerInfos;var _130=dojo.filter(_12f,"return item.showAttachments");if(!_130||!_130.length){return;}this._attachmentEditor=new esri.dijit.editing.AttachmentEditor({"class":"atiAttachmentEditor"},this.attachmentEditor);this._attachmentEditor.startup();},_setCurrentLInfo:function(_131){var _132=this._currentLInfo?this._currentLInfo.featureLayer:null;var _133=_131.featureLayer;if(_132&&_132.id===_133.id&&!_132.ownershipBasedAccessControlForFeatures){var _134=_133.getEditCapabilities();if(!(_134.canCreate&&!_134.canUpdate)){return;}}this._currentLInfo=_131;this._createTable();},_updateSelection:function(_135,_136){this._selection=_135||[];var _137=this._layerInfos;dojo.forEach(_137,this._getSelection,this);var _138=this._numFeatures=this._selection.length;var _139=_138?this._selection[this._featureIdx]:null;this._showFeature(_139,_136);},_getSelection:function(_13a){var _13b=_13a.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(_13b);},_updateUI:function(){var _13c=this._numFeatures;var _13d=this._currentLInfo;this.layerName.innerHTML=(!_13d||_13c===0)?this.NLS_noFeaturesSelected:(_13d.featureLayer?_13d.featureLayer.name:"");dojo.style(this.attributeTable,"display",_13c?"":"none");dojo.style(this.editButtons,"display",_13c?"":"none");dojo.style(this.navButtons,"display",(!this._hideNavButtons&&(_13c>1)?"":"none"));this.navMessage.innerHTML=esri.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);if(this._attachmentEditor){dojo.style(this._attachmentEditor.domNode,"display",((_13d&&_13d.showAttachments)&&_13c)?"":"none");}var _13e=((_13d&&_13d.showDeleteButton===false)||!this._canDelete)?false:true;dojo.style(this.deleteBtn.domNode,"display",_13e?"":"none");if(this.domNode.parentNode&&this.domNode.parentNode.scrollTop>0){this.domNode.parentNode.scrollTop=0;}},_onNextFeature:function(_13f){this._featureIdx+=_13f;if(this._featureIdx<0){this._featureIdx=this._numFeatures-1;}else{if(this._featureIdx>=this._numFeatures){this._featureIdx=0;}}var _140=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(_140);this._updateUI();this.onNext(_140);},_deleteFeature:function(){this.onDelete(this._currentFeature);},_showFeature:function(_141,_142){if(!_141){return;}this._currentFeature=_141;var _143=_142?_142:_141.getLayer();var _144=_143.getEditCapabilities({feature:_141,userId:this._userIds[_143.id]});this._canUpdate=_144.canUpdate;this._canDelete=_144.canDelete;var _145=this._getLInfoFromFeatureLayer(_143);if(!_145){return;}this._setCurrentLInfo(_145);var _146=_141.attributes;var type=this._findFirst(_145.types,"id",_146[_145.typeIdField]);var node,_147=null;var _148=_145.fieldInfos;dojo.forEach(_148,function(_149){_147=_149.field;node=_149.dijit||null;if(!node){return;}var _14a=this._setFieldDomain(node,type,_147);var _14b=_146[_147.name];_14b=(_14b&&_14a&&_14a.codedValues&&_14a.codedValues.length)?(_14a.codedValues[_14b]?_14a.codedValues[_14b].name:_14b):_14b;if(!esri._isDefined(_14b)){_14b="";}if(node.declaredClass==="dijit.form.DateTextBox"){_14b=(_14b==="")?null:new Date(_14b);}else{if(node.declaredClass==="dijit.form.FilteringSelect"){node._lastValueReported=null;_14b=_146[_147.name]+"";}}try{this._setValue(node,_14b);if(node.declaredClass==="dijit.form.FilteringSelect"&&node.isValid()===false){this._setValue(node,null);}}catch(error){node.set("displayedValue",this.NLS_errorInvalid,false);}},this);if(this._attachmentEditor&&_145.showAttachments){this._attachmentEditor.showAttachments(this._currentFeature);}var _14c=_143.getEditSummary(_141);if(_14c){this.editorTrackingInfoDiv.innerHTML=_14c;esri.show(this.editorTrackingInfoDiv);}else{esri.hide(this.editorTrackingInfoDiv);}},_setFieldDomain:function(node,type,_14d){if(!node){return null;}var _14e=_14d.domain;if(type&&type.domains){if(type.domains[_14d.name]&&type.domains[_14d.name] instanceof esri.layers.InheritedDomain===false){_14e=type.domains[_14d.name];}}if(!_14e){return null;}if(_14e.codedValues&&_14e.codedValues.length>0){node.set("store",this._toStore(dojo.map(_14e.codedValues,"return { id: item.code += '', name: item.name };")));this._setValue(node,_14e.codedValues[0].code);}else{node.constraints={min:esri._isDefined(_14e.minValue)?_14e.minValue:Number.MIN_VALUE,max:esri._isDefined(_14e.maxValue)?_14e.maxValue:Number.MAX_VALUE};this._setValue(node,node.constraints.min);}return _14e;},_setValue:function(node,_14f){if(!node.set){return;}node._onChangeActive=false;node.set("value",_14f,true);node._onChangeActive=true;},_getFields:function(_150){var _151=_150._getOutFields();if(!_151){return null;}var _152=_150.fields;return (_151=="*")?_152:dojo.filter(dojo.map(_151,dojo.hitch(this,"_findFirst",_152,"name")),esri._isDefined);},_isInFields:function(_153,_154){if(!_153||!_154&&!_154.length){return false;}return dojo.some(_154,function(name){return name.toLowerCase()===_153.toLowerCase();});},_findFirst:function(_155,_156,_157){var _158=dojo.filter(_155,function(item){return item.hasOwnProperty(_156)&&item[_156]===_157;});return (_158&&_158.length)?_158[0]:null;},_getLInfoFromFeatureLayer:function(_159){var _15a=_159?_159.id:null;return this._findFirst(this._layerInfos,"layerId",_15a);},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=dojo.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var _15b=dojo.create("tbody",null,this._attributes);var _15c=this._currentFeature;var _15d=this._currentLInfo;var type=this._findFirst(_15d.types,"id",_15c.attributes[_15d.typeIdField]);var _15e=_15d.fieldInfos;dojo.forEach(_15e,dojo.hitch(this,"_createField",type,_15b),this);this._createOnlyFirstTime=false;},_createField:function(type,_15f,_160){var _161=this._currentLInfo;var _162=_160.field;if(this._isInFields(_162.name,_161.hideFields)){return;}if(this._isInFields(_162.name,this._editorTrackingInfos[_161.featureLayer.id])){return;}var node=dojo.create("tr",null,_15f);var td=dojo.create("td",{innerHTML:_160.label||_162.alias||_162.name,"class":"atiLabel"},node);td=dojo.create("td",null,node);var _163=null;var _164=false;if(_160.customField){dojo.place(_160.customField.domNode||_160.customField,dojo.create("div",null,td),"first");_163=_160.customField;}else{if(_161.isEditable===false||_162.editable===false||_160.isEditable===false||_162.type==="esriFieldTypeOID"||_162.type==="esriFieldTypeGlobalID"||(!this._canUpdate&&!this._createOnlyFirstTime)){_164=true;}}if(!_163&&(_161.typeIdField&&_162.name.toLowerCase()==_161.typeIdField.toLowerCase())){_163=this._createTypeField(_162,_160,td);}else{if(!_163){_163=this._createDomainField(_162,_160,type,td);}}if(!_163){switch(_162.type){case "esriFieldTypeString":_163=this._createStringField(_162,_160,td);break;case "esriFieldTypeDate":_163=this._createDateField(_162,_160,td);break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":_163=this._createIntField(_162,_160,td);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":_163=this._createFltField(_162,_160,td);break;default:_163=this._createStringField(_162,_160,td);break;}}if(_160.tooltip&&_160.tooltip.length){this._toolTips.push(new _104.Tooltip({connectId:[_163.id],label:_160.tooltip}));}_163.onChange=dojo.hitch(this,"onFieldValueChange",_160);_163.set("disabled",_164);_160.dijit=_163;},_createTypeField:function(_165,_166,node){return new _104.form.FilteringSelect({"class":"atiField",name:_165.alias||_165.name,store:this._toStore(dojo.map(this._currentLInfo.types,"return { id: item.id, name: item.name };")),searchAttr:"name"},dojo.create("div",null,node));},_createDomainField:function(_167,_168,type,node){var _169=_167.domain;if(type&&type.domains){if(type.domains[_167.name]&&type.domains[_167.name] instanceof esri.layers.InheritedDomain===false){_169=type.domains[_167.name];}}if(!_169){return null;}if(_169.codedValues){return new _104.form.FilteringSelect({"class":"atiField",name:_167.alias||_167.name,store:null,searchAttr:"name",required:_167.nullable||false},dojo.create("div",null,node));}else{return new _104.form.NumberSpinner({"class":"atiField"},dojo.create("div",null,node));}},_createStringField:function(_16a,_16b,node){var _16c={"class":"atiField",trim:true,maxLength:_16a.length};if(_16b.stringFieldOption===esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTAREA){_16c["class"]+=" atiTextAreaField";return new _104.form.SimpleTextarea(_16c,dojo.create("div",null,node));}else{if(_16b.stringFieldOption===esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT){_16c["class"]+=" atiRichTextField";_16c.height="100%";_16c.width="100%";_16c.plugins=_16b.richTextPlugins||["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];return new _104.Editor(_16c,dojo.create("div",null,node));}else{return new _104.form.TextBox(_16c,dojo.create("div",null,node));}}},_createDateField:function(_16d,_16e,node){var _16f={"class":"atiField","trim":true};if(this._datePackage){_16f.datePackage=this._datePackage;}return new _104.form.DateTextBox(_16f,dojo.create("div",null,node));},_createIntField:function(_170,_171,node){return new _104.form.NumberTextBox({"class":"atiField",constraints:{places:0},invalidMessage:this.NLS_validationInt,trim:true},dojo.create("div",null,node));},_createFltField:function(_172,_173,node){return new _104.form.NumberTextBox({"class":"atiField",trim:true,invalidMessage:this.NLS_validationFlt},dojo.create("div",null,node));},_toStore:function(_174){return new dojo.data.ItemFileReadStore({data:{identifier:"id",label:"name",items:_174}});},_connect:function(node,evt,func){this._aiConnects.push(dojo.connect(node,evt,func));},_getDatePackage:function(_175){if(_175.datePackage===null){return null;}else{if(_175.datePackage){return _175.datePackage;}}return null;},_destroyAttributeTable:function(){var _176=this.layerInfos;dojo.forEach(_176,function(_177){var _178=_177.fieldInfos;dojo.forEach(_178,function(_179){var _17a=_179.dijit;if(_17a){_17a._onChangeHandle=null;if(_179.customField){return;}if(_17a.destroyRecursive){_17a.destroyRecursive();}else{if(_17a.destroy){_17a.destroy();}}}_179.dijit=null;},this);},this);var _17b=this._toolTips;dojo.forEach(_17b,"item.destroy(); delete item;");this._toolTips=[];if(this._attributes){dojo.destroy(this._attributes);}}});dojo.mixin(esri.dijit.AttributeInspector,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/_base/event","dojo/touch","./_ListBase"],function(_17c,_17d,_17e,_17f){return _17c("dijit.form._ListMouseMixin",_17f,{postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_17e.press,"_onMouseDown");this.connect(this.domNode,_17e.release,"_onMouseUp");this.connect(this.domNode,"onmouseover","_onMouseOver");this.connect(this.domNode,"onmouseout","_onMouseOut");},_onMouseDown:function(evt){_17d.stop(evt);if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(this._getTarget(evt));},_onMouseUp:function(evt){_17d.stop(evt);this._isDragging=false;var _180=this._getSelectedAttr();var _181=this._getTarget(evt);var _182=this._hoveredNode;if(_180&&_181==_180){this.onClick(_180);}else{if(_182&&_181==_182){this._setSelectedAttr(_182);this.onClick(_182);}}},_onMouseOut:function(){if(this._hoveredNode){this.onUnhover(this._hoveredNode);if(this._getSelectedAttr()==this._hoveredNode){this.onSelect(this._hoveredNode);}this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}var node=this._getTarget(evt);if(!node){return;}if(this._hoveredNode!=node){if(this._hoveredNode){this._onMouseOut({target:this._hoveredNode});}if(node&&node.parentNode==this.containerNode){if(this._isDragging){this._setSelectedAttr(node);}else{this._hoveredNode=node;this.onHover(node);}}}}});});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\"\r\n\trole=\"combobox\"\r\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\r\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\r\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/></div\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\r\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\r\n\t/></div\r\n></div>\r\n","dijit/form/NumberTextBox":function(){define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(_183,lang,_184,_185){var _186=_183("dijit.form.NumberTextBoxMixin",null,{regExpGen:_184.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:_184.format,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},_setConstraintsAttr:function(_187){var _188=typeof _187.places=="number"?_187.places:0;if(_188){_188++;}if(typeof _187.max!="number"){_187.max=9*Math.pow(10,15-_188);}if(typeof _187.min!="number"){_187.min=-9*Math.pow(10,15-_188);}this.inherited(arguments,[_187]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _189=this.format(val,this.constraints);if(_189!==undefined){this.textbox.value=_189;}}this.inherited(arguments);},format:function(_18a,_18b){var _18c=String(_18a);if(typeof _18a!="number"){return _18c;}if(isNaN(_18a)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_18a,_18b))&&_18b.exponent!==false&&/\de[-+]?\d/i.test(_18c)){return _18c;}if(this.editOptions&&this.focused){_18b=lang.mixin({},_18b,this.editOptions);}return this._formatter(_18a,_18b);},_parser:_184.parse,parse:function(_18d,_18e){var v=this._parser(_18d,lang.mixin({},_18e,(this.editOptions&&this.focused)?this.editOptions:{}));if(this.editOptions&&this.focused&&isNaN(v)){v=this._parser(_18d,_18e);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_18f){return (_18f===null||_18f===""||_18f===undefined)?NaN:this.inherited(arguments);},serialize:function(_190,_191){return (typeof _190!="number"||isNaN(_190))?"":this.inherited(arguments);},_setBlurValue:function(){var val=lang.hitch(lang.mixin({},this,{focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_192,_193,_194){if(_192!==undefined&&_194===undefined){_194=String(_192);if(typeof _192=="number"){if(isNaN(_192)){_194="";}else{if(("rangeCheck" in this&&this.rangeCheck(_192,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_194)){_194=undefined;}}}else{if(!_192){_194="";_192=NaN;}else{_192=undefined;}}}this.inherited(arguments,[_192,_193,_194]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+_184._realNumberRegexp(lang.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_195){if(!this.focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});var _196=_183("dijit.form.NumberTextBox",[_185,_186],{baseClass:"dijitTextBox dijitNumberTextBox"});_196.Mixin=_186;return _196;});},"esri/dijit/editing/Util":function(){define(["dijit","dojo","dojox","dojo/require!dojo/DeferredList"],function(_197,dojo,_198){dojo.provide("esri.dijit.editing.Util");dojo.require("dojo.DeferredList");esri.dijit.editing.Util.LayerHelper={findFeatures:function(ids,_199,_19a){var _19b=_199.objectIdField;var _19c=_199.graphics;var _19d=dojo.filter(_19c,function(_19e){return dojo.some(ids,function(id){return _19e.attributes[_19b]===id.objectId;});});if(_19a){_19a(_19d);}else{return _19d;}},getSelection:function(_19f){var _1a0=[];dojo.forEach(_19f,function(_1a1){var _1a2=_1a1.getSelectedFeatures();dojo.forEach(_1a2,function(_1a3){_1a0.push(_1a3);});});return _1a0;}};});},"dijit/Tooltip":function(){require({cache:{"url:dijit/templates/Tooltip.html":"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\r\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" data-dojo-attach-point=\"containerNode\" role='alert'></div\r\n\t><div class=\"dijitTooltipConnector\" data-dojo-attach-point=\"connectorNode\"></div\r\n></div>\r\n"}});define("dijit/Tooltip",["dojo/_base/array","dojo/_base/declare","dojo/_base/fx","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","./_base/manager","./place","./_Widget","./_TemplatedMixin","./BackgroundIframe","dojo/text!./templates/Tooltip.html","."],function(_1a4,_1a5,fx,dom,_1a6,_1a7,_1a8,lang,has,win,_1a9,_1aa,_1ab,_1ac,_1ad,_1ae,_1af){var _1b0=_1a5("dijit._MasterTooltip",[_1ab,_1ac],{duration:_1a9.defaultDuration,templateString:_1ae,postCreate:function(){win.body().appendChild(this.domNode);this.bgIframe=new _1ad(this.domNode);this.fadeIn=fx.fadeIn({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,"_onShow")});this.fadeOut=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:lang.hitch(this,"_onHide")});},show:function(_1b1,_1b2,_1b3,rtl,_1b4){if(this.aroundNode&&this.aroundNode===_1b2&&this.containerNode.innerHTML==_1b1){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_1b1;this.set("textDir",_1b4);this.containerNode.align=rtl?"right":"left";var pos=_1aa.around(this.domNode,_1b2,_1b3&&_1b3.length?_1b3:_1b5.defaultPosition,!rtl,lang.hitch(this,"orient"));var _1b6=pos.aroundNodePos;if(pos.corner.charAt(0)=="M"&&pos.aroundCorner.charAt(0)=="M"){this.connectorNode.style.top=_1b6.y+((_1b6.h-this.connectorNode.offsetHeight)>>1)-pos.y+"px";this.connectorNode.style.left="";}else{if(pos.corner.charAt(1)=="M"&&pos.aroundCorner.charAt(1)=="M"){this.connectorNode.style.left=_1b6.x+((_1b6.w-this.connectorNode.offsetWidth)>>1)-pos.x+"px";}}_1a8.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_1b2;},orient:function(node,_1b7,_1b8,_1b9,_1ba){this.connectorNode.style.top="";var _1bb=_1b9.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_1b7+"-"+_1b8];this.domNode.style.width="auto";var size=_1a7.getContentBox(this.domNode);var _1bc=Math.min((Math.max(_1bb,1)),size.w);var _1bd=_1bc<size.w;this.domNode.style.width=_1bc+"px";if(_1bd){this.containerNode.style.overflow="auto";var _1be=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_1be>_1bc){_1be=_1be+_1a8.get(this.domNode,"paddingLeft")+_1a8.get(this.domNode,"paddingRight");this.domNode.style.width=_1be+"px";}}if(_1b8.charAt(0)=="B"&&_1b7.charAt(0)=="B"){var mb=_1a7.getMarginBox(node);var _1bf=this.connectorNode.offsetHeight;if(mb.h>_1b9.h){var _1c0=_1b9.h-((_1ba.h+_1bf)>>1);this.connectorNode.style.top=_1c0+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_1ba.h/2-_1bf/2,0),mb.h-_1bf)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_1bb);},_onShow:function(){if(has("ie")){this.domNode.style.filter="";}},hide:function(_1c1){if(this._onDeck&&this._onDeck[1]==_1c1){this._onDeck=null;}else{if(this.aroundNode===_1c1){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}},_setAutoTextDir:function(node){this.applyTextDir(node,has("ie")?node.outerText:node.textContent);_1a4.forEach(node.children,function(_1c2){this._setAutoTextDir(_1c2);},this);},_setTextDirAttr:function(_1c3){this._set("textDir",typeof _1c3!="undefined"?_1c3:"");if(_1c3=="auto"){this._setAutoTextDir(this.containerNode);}else{this.containerNode.dir=this.textDir;}}});_1af.showTooltip=function(_1c4,_1c5,_1c6,rtl,_1c7){if(_1c6){_1c6=_1a4.map(_1c6,function(val){return {after:"after-centered",before:"before-centered"}[val]||val;});}if(!_1b5._masterTT){_1af._masterTT=_1b5._masterTT=new _1b0();}return _1b5._masterTT.show(_1c4,_1c5,_1c6,rtl,_1c7);};_1af.hideTooltip=function(_1c8){return _1b5._masterTT&&_1b5._masterTT.hide(_1c8);};var _1b5=_1a5("dijit.Tooltip",_1ab,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_1c9){_1a4.forEach(this._connections||[],function(_1ca){_1a4.forEach(_1ca,lang.hitch(this,"disconnect"));},this);this._connectIds=_1a4.filter(lang.isArrayLike(_1c9)?_1c9:(_1c9?[_1c9]:[]),function(id){return dom.byId(id);});this._connections=_1a4.map(this._connectIds,function(id){var node=dom.byId(id);return [this.connect(node,"onmouseenter","_onHover"),this.connect(node,"onmouseleave","_onUnHover"),this.connect(node,"onfocus","_onHover"),this.connect(node,"onblur","_onUnHover")];},this);this._set("connectId",_1c9);},addTarget:function(node){var id=node.id||node;if(_1a4.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=_1a4.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);_1a6.add(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;_1a4.forEach(lang.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onHover:function(e){if(!this._showTimer){var _1cb=e.target;this._showTimer=setTimeout(lang.hitch(this,function(){this.open(_1cb);}),this.showDelay);}},_onUnHover:function(){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_1cc){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}_1b5.show(this.label||this.domNode.innerHTML,_1cc,this.position,!this.isLeftToRight(),this.textDir);this._connectNode=_1cc;this.onShow(_1cc,this.position);},close:function(){if(this._connectNode){_1b5.hide(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});_1b5._MasterTooltip=_1b0;_1b5.show=_1af.showTooltip;_1b5.hide=_1af.hideTooltip;_1b5.defaultPosition=["after-centered","before-centered"];return _1b5;});},"dijit/form/RangeBoundTextBox":function(){define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(_1cd,i18n,_1ce){return _1cd("dijit.form.RangeBoundTextBox",_1ce,{rangeMessage:"",rangeCheck:function(_1cf,_1d0){return ("min" in _1d0?(this.compare(_1cf,_1d0.min)>=0):true)&&("max" in _1d0?(this.compare(_1cf,_1d0.max)<=0):true);},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");var _1d1=false;var _1d2=false;if("min" in this.constraints){var min=this.constraints.min;min=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min);_1d1=(typeof min=="number")&&min<0;}if("max" in this.constraints){var max=this.constraints.max;max=this.compare(val,((typeof max!="number")||max>0)?max:0);_1d2=(typeof max=="number")&&max>0;}return _1d1||_1d2;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_1d3){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_1d3));},getErrorMessage:function(_1d4){var v=this.get("value");if(v!==null&&v!==""&&v!==undefined&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_1d4)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},_setConstraintsAttr:function(_1d5){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){this.focusNode.setAttribute("aria-valuemin",this.constraints.min);}else{this.focusNode.removeAttribute("aria-valuemin");}if(this.constraints.max!==undefined){this.focusNode.setAttribute("aria-valuemax",this.constraints.max);}else{this.focusNode.removeAttribute("aria-valuemax");}}},_setValueAttr:function(_1d6,_1d7){this.focusNode.setAttribute("aria-valuenow",_1d6);this.inherited(arguments);},applyTextDir:function(){}});});},"dijit/_editor/RichText":function(){define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/ready","dojo/_base/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/_base/window","../_Widget","../_CssStateMixin","./selection","./range","./html","../focus",".."],function(_1d8,_1d9,_1da,_1db,dom,_1dc,_1dd,_1de,_1df,_1e0,_1e1,_1e2,keys,lang,on,_1e3,_1e4,has,_1e5,_1e6,_1e7,win,_1e8,_1e9,_1ea,_1eb,_1ec,_1ed,_1ee){var _1ef=_1da("dijit._editor.RichText",[_1e8,_1e9],{constructor:function(_1f0){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};if(_1f0&&lang.isString(_1f0.value)){this.value=_1f0.value;}this.onLoadDeferred=new _1db();},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"===this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}this.contentPreFilters=[lang.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);if(has("mozilla")){this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);}if(has("webkit")){this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);}if(has("ie")){this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);this.contentDomPostFilters=[lang.hitch(this,this._stripBreakerNodes)].concat(this.contentDomPostFilters);}this.inherited(arguments);_1e5.publish(_1ee._scopeName+"._editor.RichText::init",this);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=lang.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _1f1={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!has("ie")){_1f1.Z=exec("redo");}var key;for(key in _1f1){this.addKeyHandler(key,true,false,_1f1[key]);}},events:["onKeyPress","onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(_1ef._editorCommandsLocalized){this._local2NativeFormatNames=_1ef._local2NativeFormatNames;this._native2LocalFormatNames=_1ef._native2LocalFormatNames;return;}_1ef._editorCommandsLocalized=true;_1ef._local2NativeFormatNames={};_1ef._native2LocalFormatNames={};this._local2NativeFormatNames=_1ef._local2NativeFormatNames;this._native2LocalFormatNames=_1ef._native2LocalFormatNames;var _1f2=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _1f3="",_1f4,i=0;while((_1f4=_1f2[i++])){if(_1f4.charAt(1)!=="l"){_1f3+="<"+_1f4+"><span>content</span></"+_1f4+"><br/>";}else{_1f3+="<"+_1f4+"><li>content</li></"+_1f4+"><br/>";}}var _1f5={position:"absolute",top:"0px",zIndex:10,opacity:0.01};var div=_1de.create("div",{style:_1f5,innerHTML:_1f3});win.body().appendChild(div);var _1f6=lang.hitch(this,function(){var node=div.firstChild;while(node){try{_1ea.selectElement(node.firstChild);var _1f7=node.tagName.toLowerCase();this._local2NativeFormatNames[_1f7]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_1f7]]=_1f7;node=node.nextSibling.nextSibling;}catch(e){}}div.parentNode.removeChild(div);div.innerHTML="";});setTimeout(_1f6,0);},open:function(_1f8){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _1db();}if(!this.isClosed){this.close();}_1e5.publish(_1ee._scopeName+"._editor.RichText::open",this);if(arguments.length===1&&_1f8.nodeName){this.domNode=_1f8;}var dn=this.domNode;var html;if(lang.isString(this.value)){html=this.value;delete this.value;dn.innerHTML="";}else{if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=ta.value;dn=this.domNode=win.doc.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_1de.place(dn,ta,"before");var _1f9=lang.hitch(this,function(){_1e0.set(ta,{display:"block",position:"absolute",top:"-1000px"});if(has("ie")){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(has("ie")){setTimeout(_1f9,10);}else{_1f9();}if(ta.form){var _1fa=ta.value;this.reset=function(){var _1fb=this.getValue();if(_1fb!==_1fa){this.replaceValue(_1fa);}};on(ta.form,"submit",lang.hitch(this,function(){_1dc.set(ta,"disabled",this.disabled);ta.value=this.getValue();}));}}else{html=_1ec.getChildrenHtml(dn);dn.innerHTML="";}}this.value=html;if(dn.nodeName&&dn.nodeName==="LI"){dn.innerHTML=" <br>";}this.header=dn.ownerDocument.createElement("div");dn.appendChild(this.header);this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);this.footer=dn.ownerDocument.createElement("div");dn.appendChild(this.footer);if(!this.name){this.name=this.id+"_AUTOGEN";}if(this.name!==""&&(!_1d9["useXDomain"]||_1d9["allowXdRichTextSave"])){var _1fc=dom.byId(_1ee._scopeName+"._editor.RichText.value");if(_1fc&&_1fc.value!==""){var _1fd=_1fc.value.split(this._SEPARATOR),i=0,dat;while((dat=_1fd[i++])){var data=dat.split(this._NAME_CONTENT_SEP);if(data[0]===this.name){html=data[1];_1fd=_1fd.splice(i,1);_1fc.value=_1fd.join(this._SEPARATOR);break;}}}if(!_1ef._globalSaveHandler){_1ef._globalSaveHandler={};_1e6.addOnUnload(function(){var id;for(id in _1ef._globalSaveHandler){var f=_1ef._globalSaveHandler[id];if(lang.isFunction(f)){f();}}});}_1ef._globalSaveHandler[this.id]=lang.hitch(this,"_saveContent");}this.isClosed=false;var ifr=(this.editorObject=this.iframe=win.doc.createElement("iframe"));ifr.id=this.id+"_iframe";this._iframeSrc=this._getIframeDocTxt();ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(has("ie")>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=lang.hitch(this,function(w){this.window=w;this.document=this.window.document;if(has("ie")){this._localizeEditorCommands();}this.onLoad(html);});var _1fe="parent."+_1ee._scopeName+".byId(\""+this.id+"\")._iframeSrc";var s="javascript:(function(){try{return "+_1fe+"}catch(e){document.open();document.domain=\""+document.domain+"\";document.write("+_1fe+");document.close();}})()";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(has("safari")<=4){var src=ifr.getAttribute("src");if(!src||src.indexOf("javascript")===-1){setTimeout(function(){ifr.setAttribute("src",s);},0);}}if(dn.nodeName==="LI"){dn.lastChild.style.marginTop="-1.2em";}_1dd.add(this.domNode,this.baseClass);},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var _1ff=_1e0.getComputedStyle(this.domNode);var html="";var _200=true;if(has("ie")||has("webkit")||(!this.height&&!has("mozilla"))){html="<div id='dijitEditorBody'></div>";_200=false;}else{if(has("mozilla")){this._cursorToStart=true;html="&#160;";}}var font=[_1ff.fontWeight,_1ff.fontSize,_1ff.fontFamily].join(" ");var _201=_1ff.lineHeight;if(_201.indexOf("px")>=0){_201=parseFloat(_201)/parseFloat(_1ff.fontSize);}else{if(_201.indexOf("em")>=0){_201=parseFloat(_201);}else{_201="normal";}}var _202="";var self=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_203){_203=_203.replace(/^;/ig,"")+";";var s=_203.split(":")[0];if(s){s=lang.trim(s);s=s.toLowerCase();var i;var sC="";for(i=0;i<s.length;i++){var c=s.charAt(i);switch(c){case "-":i++;c=s.charAt(i).toUpperCase();default:sC+=c;}}_1e0.set(self.domNode,sC,"");}_202+=_203+";";});var _204=_1e3("label[for=\""+this.id+"\"]");return [this.isLeftToRight()?"<html>\n<head>\n":"<html dir='rtl'>\n<head>\n",(has("mozilla")&&_204.length?"<title>"+_204[0].innerHTML+"</title>\n":""),"<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n",((has("webkit"))?"\t\twidth: 100%;\n":""),((has("webkit"))?"\t\theight: 100%;\n":""),"\t}\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",font,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tmin-height:",this.minHeight,";\n","\t\tline-height:",_201,";\n","\t}\n","\tp{ margin: 1em 0; }\n",(!_200&&!this.height?"\tbody,html {overflow-y: hidden;}\n":""),"\t#dijitEditorBody{overflow-x: auto; overflow-y:"+(this.height?"auto;":"hidden;")+" outline: 0px;}\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(!has("ie")?"\tli{ min-height:1.2em; }\n":""),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body ",(_200?"id='dijitEditorBody' ":""),"onload='frameElement._loadFunc(window,document)' style='"+_202+"'>",html,"</body>\n</html>"].join("");},_applyEditingAreaStyleSheets:function(){var _205=[];if(this.styleSheets){_205=this.styleSheets.split(";");this.styleSheets="";}_205=_205.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_205[i++])){var _206=(new _1e7(win.global.location,url)).toString();this.editingAreaStyleSheets.push(_206);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_206+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _1e7(win.global.location,url)).toString();}if(_1d8.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);this.onLoadDeferred.addCallback(lang.hitch(this,function(){if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _207=this.document.createElement("link");_207.rel="stylesheet";_207.type="text/css";_207.href=url;head.appendChild(_207);}}));},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _1e7(win.global.location,url)).toString();}var _208=_1d8.indexOf(this.editingAreaStyleSheets,url);if(_208===-1){return;}delete this.editingAreaStyleSheets[_208];win.withGlobal(this.window,"query",dojo,["link:[href=\""+url+"\"]"]).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_209){_209=!!_209;this._set("disabled",_209);if(!this.isLoaded){return;}if(has("ie")||has("webkit")||has("opera")){var _20a=has("ie")&&(this.isLoaded||!this.focusOnLoad);if(_20a){this.editNode.unselectable="on";}this.editNode.contentEditable=!_209;if(_20a){var _20b=this;setTimeout(function(){if(_20b.editNode){_20b.editNode.unselectable="off";}},0);}}else{try{this.document.designMode=(_209?"off":"on");}catch(e){return;}if(!_209&&this._mozSettingProps){var ps=this._mozSettingProps;var n;for(n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e2){}}}}}this._disabledOK=true;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;this._iframeRegHandle=_1ed.registerIframe(this.iframe);}if(!has("ie")&&!has("webkit")&&(this.height||has("mozilla"))){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _20c=this;if(has("ie")){this.tabStop=_1de.create("div",{tabIndex:-1},this.editingArea);this.iframe.onfocus=function(){_20c.editNode.setActive();};}}this.focusNode=this.editNode;var _20d=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_1d8.forEach(_20d,function(item){this.connect(ap,item.toLowerCase(),item);},this);this.connect(ap,"onmouseup","onClick");if(has("ie")){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}else{this.connect(this.document,"onmousedown",function(){delete this._cursorToStart;});}if(has("webkit")){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");this.connect(this.document,"onmousedown",function(e){var t=e.target;if(t&&(t===this.document.body||t===this.document)){setTimeout(lang.hitch(this,"placeCursorAtEnd"),0);}});}if(has("ie")){try{this.document.execCommand("RespectVisibilityInDesign",true,null);}catch(e){}}this.isLoaded=true;this.set("disabled",this.disabled);var _20e=lang.hitch(this,function(){this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.callback(true);}this.onDisplayChanged();if(this.focusOnLoad){_1e4(lang.hitch(this,function(){setTimeout(lang.hitch(this,"focus"),this.updateInterval);}));}this.value=this.getValue(true);});if(this.setValueDeferred){this.setValueDeferred.addCallback(_20e);}else{_20e();}},onKeyDown:function(e){if(e.keyCode===keys.TAB&&this.isTabIndent){_1e1.stop(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(has("ie")){if(e.keyCode==keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===keys.BACKSPACE&&this.document.selection.type==="Control"){_1e1.stop(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}if(has("ff")){if(e.keyCode===keys.PAGE_UP||e.keyCode===keys.PAGE_DOWN){if(this.editNode.clientHeight>=this.editNode.scrollHeight){e.preventDefault();}}}return true;},onKeyUp:function(){},setDisabled:function(_20f){_1e2.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.set("disabled",_20f);},_setValueAttr:function(_210){this.setValue(_210);},_setDisableSpellCheckAttr:function(_211){if(this.document){_1dc.set(this.document.body,"spellcheck",!_211);}else{this.onLoadDeferred.addCallback(lang.hitch(this,function(){_1dc.set(this.document.body,"spellcheck",!_211);}));}this._set("disableSpellCheck",_211);},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode,_212=this._keyHandlers[c],args=arguments;if(_212&&!e.altKey){_1d8.some(_212,function(h){if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){if(!h.handler.apply(this,args)){e.preventDefault();}return true;}},this);}if(!this._onKeyHitch){this._onKeyHitch=lang.hitch(this,"onKeyPressed");}setTimeout(this._onKeyHitch,1);return true;},addKeyHandler:function(key,ctrl,_213,_214){if(!lang.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_213||false,ctrl:ctrl||false,handler:_214});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(){if(!this.focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _215=this.getValue(true);if(_215!==this.value){this.onChange(_215);}this._set("value",_215);},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.set("disabled",false);}this.inherited(arguments);}},blur:function(){if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(win.doc.body.focus){win.doc.body.focus();}}},focus:function(){if(!this.isLoaded){this.focusOnLoad=true;return;}if(this._cursorToStart){delete this._cursorToStart;if(this.editNode.childNodes){this.placeCursorAtStart();return;}}if(!has("ie")){_1ed.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){if(this._updateTimer){clearTimeout(this._updateTimer);}if(!this._updateHandler){this._updateHandler=lang.hitch(this,"onNormalizedDisplayChanged");}this._updateTimer=setTimeout(this._updateHandler,this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(){},_normalizeCommand:function(cmd,_216){var _217=cmd.toLowerCase();if(_217==="formatblock"){if(has("safari")&&_216===undefined){_217="heading";}}else{if(_217==="hilitecolor"&&!has("mozilla")){_217="backcolor";}}return _217;},_qcaCache:{},queryCommandAvailable:function(_218){var ca=this._qcaCache[_218];if(ca!==undefined){return ca;}return (this._qcaCache[_218]=this._queryCommandAvailable(_218));},_queryCommandAvailable:function(_219){var ie=1;var _21a=1<<1;var _21b=1<<2;var _21c=1<<3;function _21d(_21e){return {ie:Boolean(_21e&ie),mozilla:Boolean(_21e&_21a),webkit:Boolean(_21e&_21b),opera:Boolean(_21e&_21c)};};var _21f=null;switch(_219.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_21f=_21d(_21a|ie|_21b|_21c);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_21f=_21d(_21a|ie|_21c|_21b);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_21f=_21d(ie);break;case "cut":case "copy":case "paste":_21f=_21d(ie|_21a|_21b);break;case "inserttable":_21f=_21d(_21a|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_21f=_21d(ie|_21a);break;default:return false;}return (has("ie")&&_21f.ie)||(has("mozilla")&&_21f.mozilla)||(has("webkit")&&_21f.webkit)||(has("opera")&&_21f.opera);},execCommand:function(_220,_221){var _222;this.focus();_220=this._normalizeCommand(_220,_221);if(_221!==undefined){if(_220==="heading"){throw new Error("unimplemented");}else{if((_220==="formatblock")&&has("ie")){_221="<"+_221+">";}}}var _223="_"+_220+"Impl";if(this[_223]){_222=this[_223](_221);}else{_221=arguments.length>1?_221:null;if(_221||_220!=="createlink"){_222=this.document.execCommand(_220,false,_221);}}this.onDisplayChanged();return _222;},queryCommandEnabled:function(_224){if(this.disabled||!this._disabledOK){return false;}_224=this._normalizeCommand(_224);var _225="_"+_224+"EnabledImpl";if(this[_225]){return this[_225](_224);}else{return this._browserQueryCommandEnabled(_224);}},queryCommandState:function(_226){if(this.disabled||!this._disabledOK){return false;}_226=this._normalizeCommand(_226);try{return this.document.queryCommandState(_226);}catch(e){return false;}},queryCommandValue:function(_227){if(this.disabled||!this._disabledOK){return false;}var r;_227=this._normalizeCommand(_227);if(has("ie")&&_227==="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_227)];}else{if(has("mozilla")&&_227==="hilitecolor"){var _228;try{_228=this.document.queryCommandValue("styleWithCSS");}catch(e){_228=false;}this.document.execCommand("styleWithCSS",false,true);r=this.document.queryCommandValue(_227);this.document.execCommand("styleWithCSS",false,_228);}else{r=this.document.queryCommandValue(_227);}}return r;},_sCall:function(name,args){return win.withGlobal(this.window,name,_1ea,args);},placeCursorAtStart:function(){this.focus();var _229=false;if(has("mozilla")){var _22a=this.editNode.firstChild;while(_22a){if(_22a.nodeType===3){if(_22a.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_229=true;this._sCall("selectElement",[_22a]);break;}}else{if(_22a.nodeType===1){_229=true;var tg=_22a.tagName?_22a.tagName.toLowerCase():"";if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){this._sCall("selectElement",[_22a]);}else{this._sCall("selectElementChildren",[_22a]);}break;}}_22a=_22a.nextSibling;}}else{_229=true;this._sCall("selectElementChildren",[this.editNode]);}if(_229){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _22b=false;if(has("mozilla")){var last=this.editNode.lastChild;while(last){if(last.nodeType===3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_22b=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType===1){_22b=true;if(last.lastChild){this._sCall("selectElement",[last.lastChild]);}else{this._sCall("selectElement",[last]);}break;}}last=last.previousSibling;}}else{_22b=true;this._sCall("selectElementChildren",[this.editNode]);}if(_22b){this._sCall("collapse",[false]);}},getValue:function(_22c){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_22c);},_getValueAttr:function(){return this.getValue(true);},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.addCallback(lang.hitch(this,function(){this.setValue(html);}));return;}this._cursorToStart=true;if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;if(html&&has("mozilla")&&html.toLowerCase()==="<p></p>"){html="<p>&#160;</p>";}if(!html&&has("webkit")){html="&#160;";}node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();this._set("value",this.getValue(true));},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!has("mozilla")){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(!html){this._cursorToStart=true;html="&#160;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}this._set("value",this.getValue(true));},_preFilterContent:function(html){var ec=html;_1d8.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_1d8.forEach(this.contentDomPreFilters,function(ef){if(ef&&lang.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_22d){var ec;if(!lang.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_22d){dom=lang.clone(dom);}_1d8.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_1ec.getChildrenHtml(dom);}else{ec=dom;}if(!lang.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_1d8.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(){var _22e=dom.byId(_1ee._scopeName+"._editor.RichText.value");if(_22e){if(_22e.value){_22e.value+=this._SEPARATOR;}_22e.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);}},escapeXml:function(str,_22f){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_22f){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){_1e2.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return _1ec.getNodeHtml(node);},getNodeChildrenHtml:function(dom){_1e2.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return _1ec.getChildrenHtml(dom);},close:function(save){if(this.isClosed){return;}if(!arguments.length){save=true;}if(save){this._set("value",this.getValue(true));}if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(has("ie")){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this._iframeRegHandle){this._iframeRegHandle.remove();delete this._iframeRegHandle;}if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(has("ie")){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=this.value;_1de.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=this.value;}delete this.iframe;_1dd.remove(this.domNode,this.baseClass);this.isClosed=true;this.isLoaded=false;delete this.editNode;delete this.focusNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;},destroy:function(){if(!this.isClosed){this.close(false);}if(this._updateTimer){clearTimeout(this._updateTimer);}this.inherited(arguments);if(_1ef._globalSaveHandler){delete _1ef._globalSaveHandler[this.id];}},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");},_removeWebkitBogus:function(html){html=html.replace(/\sclass="webkit-block-placeholder"/gi,"");html=html.replace(/\sclass="apple-style-span"/gi,"");html=html.replace(/<meta charset=\"utf-8\" \/>/gi,"");return html;},_normalizeFontStyle:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");},_browserQueryCommandEnabled:function(_230){if(!_230){return false;}var elem=has("ie")?this.document.selection.createRange():this.document;try{return elem.queryCommandEnabled(_230);}catch(e){return false;}},_createlinkEnabledImpl:function(){var _231=true;if(has("opera")){var sel=this.window.getSelection();if(sel.isCollapsed){_231=true;}else{_231=this.document.queryCommandEnabled("createlink");}}else{_231=this._browserQueryCommandEnabled("createlink");}return _231;},_unlinkEnabledImpl:function(){var _232=true;if(has("mozilla")||has("webkit")){_232=this._sCall("hasAncestorElement",["a"]);}else{_232=this._browserQueryCommandEnabled("unlink");}return _232;},_inserttableEnabledImpl:function(){var _233=true;if(has("mozilla")||has("webkit")){_233=true;}else{_233=this._browserQueryCommandEnabled("inserttable");}return _233;},_cutEnabledImpl:function(){var _234=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_234=!!sel;}else{_234=this._browserQueryCommandEnabled("cut");}return _234;},_copyEnabledImpl:function(){var _235=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_235=!!sel;}else{_235=this._browserQueryCommandEnabled("copy");}return _235;},_pasteEnabledImpl:function(){var _236=true;if(has("webkit")){return true;}else{_236=this._browserQueryCommandEnabled("paste");}return _236;},_inserthorizontalruleImpl:function(_237){if(has("ie")){return this._inserthtmlImpl("<hr>");}return this.document.execCommand("inserthorizontalrule",false,_237);},_unlinkImpl:function(_238){if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);return this.document.execCommand("unlink",false,null);}return this.document.execCommand("unlink",false,_238);},_hilitecolorImpl:function(_239){var _23a;var _23b=this._handleTextColorOrProperties("hilitecolor",_239);if(!_23b){if(has("mozilla")){this.document.execCommand("styleWithCSS",false,true);console.log("Executing color command.");_23a=this.document.execCommand("hilitecolor",false,_239);this.document.execCommand("styleWithCSS",false,false);}else{_23a=this.document.execCommand("hilitecolor",false,_239);}}return _23a;},_backcolorImpl:function(_23c){if(has("ie")){_23c=_23c?_23c:null;}var _23d=this._handleTextColorOrProperties("backcolor",_23c);if(!_23d){_23d=this.document.execCommand("backcolor",false,_23c);}return _23d;},_forecolorImpl:function(_23e){if(has("ie")){_23e=_23e?_23e:null;}var _23f=false;_23f=this._handleTextColorOrProperties("forecolor",_23e);if(!_23f){_23f=this.document.execCommand("forecolor",false,_23e);}return _23f;},_inserthtmlImpl:function(_240){_240=this._preFilterContent(_240);var rv=true;if(has("ie")){var _241=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()==="CONTROL"){var n=_241.item(0);while(_241.length){_241.remove(_241.item(0));}n.outerHTML=_240;}else{_241.pasteHTML(_240);}_241.select();}else{if(has("mozilla")&&!_240.length){this._sCall("remove");}else{rv=this.document.execCommand("inserthtml",false,_240);}}return rv;},_boldImpl:function(_242){var _243=false;if(has("ie")){this._adaptIESelection();_243=this._adaptIEFormatAreaAndExec("bold");}if(!_243){_243=this.document.execCommand("bold",false,_242);}return _243;},_italicImpl:function(_244){var _245=false;if(has("ie")){this._adaptIESelection();_245=this._adaptIEFormatAreaAndExec("italic");}if(!_245){_245=this.document.execCommand("italic",false,_244);}return _245;},_underlineImpl:function(_246){var _247=false;if(has("ie")){this._adaptIESelection();_247=this._adaptIEFormatAreaAndExec("underline");}if(!_247){_247=this.document.execCommand("underline",false,_246);}return _247;},_strikethroughImpl:function(_248){var _249=false;if(has("ie")){this._adaptIESelection();_249=this._adaptIEFormatAreaAndExec("strikethrough");}if(!_249){_249=this.document.execCommand("strikethrough",false,_248);}return _249;},_superscriptImpl:function(_24a){var _24b=false;if(has("ie")){this._adaptIESelection();_24b=this._adaptIEFormatAreaAndExec("superscript");}if(!_24b){_24b=this.document.execCommand("superscript",false,_24a);}return _24b;},_subscriptImpl:function(_24c){var _24d=false;if(has("ie")){this._adaptIESelection();_24d=this._adaptIEFormatAreaAndExec("subscript");}if(!_24d){_24d=this.document.execCommand("subscript",false,_24c);}return _24d;},_fontnameImpl:function(_24e){var _24f;if(has("ie")){_24f=this._handleTextColorOrProperties("fontname",_24e);}if(!_24f){_24f=this.document.execCommand("fontname",false,_24e);}return _24f;},_fontsizeImpl:function(_250){var _251;if(has("ie")){_251=this._handleTextColorOrProperties("fontsize",_250);}if(!_251){_251=this.document.execCommand("fontsize",false,_250);}return _251;},_insertorderedlistImpl:function(_252){var _253=false;if(has("ie")){_253=this._adaptIEList("insertorderedlist",_252);}if(!_253){_253=this.document.execCommand("insertorderedlist",false,_252);}return _253;},_insertunorderedlistImpl:function(_254){var _255=false;if(has("ie")){_255=this._adaptIEList("insertunorderedlist",_254);}if(!_255){_255=this.document.execCommand("insertunorderedlist",false,_254);}return _255;},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header);},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer);},_getNodeChildrenHeight:function(node){var h=0;if(node&&node.childNodes){var i;for(i=0;i<node.childNodes.length;i++){var size=_1df.position(node.childNodes[i]);h+=size.h;}}return h;},_isNodeEmpty:function(node,_256){if(node.nodeType===1){if(node.childNodes.length>0){return this._isNodeEmpty(node.childNodes[0],_256);}return true;}else{if(node.nodeType===3){return (node.nodeValue.substring(_256)==="");}}return false;},_removeStartingRangeFromRange:function(node,_257){if(node.nextSibling){_257.setStart(node.nextSibling,0);}else{var _258=node.parentNode;while(_258&&_258.nextSibling==null){_258=_258.parentNode;}if(_258){_257.setStart(_258.nextSibling,0);}}return _257;},_adaptIESelection:function(){var _259=_1eb.getSelection(this.window);if(_259&&_259.rangeCount&&!_259.isCollapsed){var _25a=_259.getRangeAt(0);var _25b=_25a.startContainer;var _25c=_25a.startOffset;while(_25b.nodeType===3&&_25c>=_25b.length&&_25b.nextSibling){_25c=_25c-_25b.length;_25b=_25b.nextSibling;}var _25d=null;while(this._isNodeEmpty(_25b,_25c)&&_25b!==_25d){_25d=_25b;_25a=this._removeStartingRangeFromRange(_25b,_25a);_25b=_25a.startContainer;_25c=0;}_259.removeAllRanges();_259.addRange(_25a);}},_adaptIEFormatAreaAndExec:function(_25e){var _25f=_1eb.getSelection(this.window);var doc=this.document;var rs,ret,_260,txt,_261,_262,_263,_264;if(_25e&&_25f&&_25f.isCollapsed){var _265=this.queryCommandValue(_25e);if(_265){var _266=this._tagNamesForCommand(_25e);_260=_25f.getRangeAt(0);var fs=_260.startContainer;if(fs.nodeType===3){var _267=_260.endOffset;if(fs.length<_267){ret=this._adjustNodeAndOffset(rs,_267);fs=ret.node;_267=ret.offset;}}var _268;while(fs&&fs!==this.editNode){var _269=fs.tagName?fs.tagName.toLowerCase():"";if(_1d8.indexOf(_266,_269)>-1){_268=fs;break;}fs=fs.parentNode;}if(_268){rs=_260.startContainer;var _26a=doc.createElement(_268.tagName);_1de.place(_26a,_268,"after");if(rs&&rs.nodeType===3){var _26b,_26c;var _26d=_260.endOffset;if(rs.length<_26d){ret=this._adjustNodeAndOffset(rs,_26d);rs=ret.node;_26d=ret.offset;}txt=rs.nodeValue;_261=doc.createTextNode(txt.substring(0,_26d));var _26e=txt.substring(_26d,txt.length);if(_26e){_262=doc.createTextNode(_26e);}_1de.place(_261,rs,"before");if(_262){_263=doc.createElement("span");_263.className="ieFormatBreakerSpan";_1de.place(_263,rs,"after");_1de.place(_262,_263,"after");_262=_263;}_1de.destroy(rs);var _26f=_261.parentNode;var _270=[];var _271;while(_26f!==_268){var tg=_26f.tagName;_271={tagName:tg};_270.push(_271);var _272=doc.createElement(tg);if(_26f.style){if(_272.style){if(_26f.style.cssText){_272.style.cssText=_26f.style.cssText;_271.cssText=_26f.style.cssText;}}}if(_26f.tagName==="FONT"){if(_26f.color){_272.color=_26f.color;_271.color=_26f.color;}if(_26f.face){_272.face=_26f.face;_271.face=_26f.face;}if(_26f.size){_272.size=_26f.size;_271.size=_26f.size;}}if(_26f.className){_272.className=_26f.className;_271.className=_26f.className;}if(_262){_26b=_262;while(_26b){_26c=_26b.nextSibling;_272.appendChild(_26b);_26b=_26c;}}if(_272.tagName==_26f.tagName){_263=doc.createElement("span");_263.className="ieFormatBreakerSpan";_1de.place(_263,_26f,"after");_1de.place(_272,_263,"after");}else{_1de.place(_272,_26f,"after");}_261=_26f;_262=_272;_26f=_26f.parentNode;}if(_262){_26b=_262;if(_26b.nodeType===1||(_26b.nodeType===3&&_26b.nodeValue)){_26a.innerHTML="";}while(_26b){_26c=_26b.nextSibling;_26a.appendChild(_26b);_26b=_26c;}}if(_270.length){_271=_270.pop();var _273=doc.createElement(_271.tagName);if(_271.cssText&&_273.style){_273.style.cssText=_271.cssText;}if(_271.className){_273.className=_271.className;}if(_271.tagName==="FONT"){if(_271.color){_273.color=_271.color;}if(_271.face){_273.face=_271.face;}if(_271.size){_273.size=_271.size;}}_1de.place(_273,_26a,"before");while(_270.length){_271=_270.pop();var _274=doc.createElement(_271.tagName);if(_271.cssText&&_274.style){_274.style.cssText=_271.cssText;}if(_271.className){_274.className=_271.className;}if(_271.tagName==="FONT"){if(_271.color){_274.color=_271.color;}if(_271.face){_274.face=_271.face;}if(_271.size){_274.size=_271.size;}}_273.appendChild(_274);_273=_274;}_264=doc.createTextNode(".");_263.appendChild(_264);_273.appendChild(_264);win.withGlobal(this.window,lang.hitch(this,function(){var _275=_1eb.create();_275.setStart(_264,0);_275.setEnd(_264,_264.length);_25f.removeAllRanges();_25f.addRange(_275);_1ea.collapse(false);_264.parentNode.innerHTML="";}));}else{_263=doc.createElement("span");_263.className="ieFormatBreakerSpan";_264=doc.createTextNode(".");_263.appendChild(_264);_1de.place(_263,_26a,"before");win.withGlobal(this.window,lang.hitch(this,function(){var _276=_1eb.create();_276.setStart(_264,0);_276.setEnd(_264,_264.length);_25f.removeAllRanges();_25f.addRange(_276);_1ea.collapse(false);_264.parentNode.innerHTML="";}));}if(!_26a.firstChild){_1de.destroy(_26a);}return true;}}return false;}else{_260=_25f.getRangeAt(0);rs=_260.startContainer;if(rs&&rs.nodeType===3){win.withGlobal(this.window,lang.hitch(this,function(){var _277=_260.startOffset;if(rs.length<_277){ret=this._adjustNodeAndOffset(rs,_277);rs=ret.node;_277=ret.offset;}txt=rs.nodeValue;_261=doc.createTextNode(txt.substring(0,_277));var _278=txt.substring(_277);if(_278!==""){_262=doc.createTextNode(txt.substring(_277));}_263=doc.createElement("span");_264=doc.createTextNode(".");_263.appendChild(_264);if(_261.length){_1de.place(_261,rs,"after");}else{_261=rs;}_1de.place(_263,_261,"after");if(_262){_1de.place(_262,_263,"after");}_1de.destroy(rs);var _279=_1eb.create();_279.setStart(_264,0);_279.setEnd(_264,_264.length);_25f.removeAllRanges();_25f.addRange(_279);doc.execCommand(_25e);_1de.place(_263.firstChild,_263,"before");_1de.destroy(_263);_279.setStart(_264,0);_279.setEnd(_264,_264.length);_25f.removeAllRanges();_25f.addRange(_279);_1ea.collapse(false);_264.parentNode.innerHTML="";}));return true;}}}else{return false;}},_adaptIEList:function(_27a){var _27b=_1eb.getSelection(this.window);if(_27b.isCollapsed){if(_27b.rangeCount&&!this.queryCommandValue(_27a)){var _27c=_27b.getRangeAt(0);var sc=_27c.startContainer;if(sc&&sc.nodeType==3){if(!_27c.startOffset){win.withGlobal(this.window,lang.hitch(this,function(){var _27d="ul";if(_27a==="insertorderedlist"){_27d="ol";}var list=_1de.create(_27d);var li=_1de.create("li",null,list);_1de.place(list,sc,"before");li.appendChild(sc);_1de.create("br",null,list,"after");var _27e=_1eb.create();_27e.setStart(sc,0);_27e.setEnd(sc,sc.length);_27b.removeAllRanges();_27b.addRange(_27e);_1ea.collapse(true);}));return true;}}}}return false;},_handleTextColorOrProperties:function(_27f,_280){var _281=_1eb.getSelection(this.window);var doc=this.document;var rs,ret,_282,txt,_283,_284,_285,_286;_280=_280||null;if(_27f&&_281&&_281.isCollapsed){if(_281.rangeCount){_282=_281.getRangeAt(0);rs=_282.startContainer;if(rs&&rs.nodeType===3){win.withGlobal(this.window,lang.hitch(this,function(){var _287=_282.startOffset;if(rs.length<_287){ret=this._adjustNodeAndOffset(rs,_287);rs=ret.node;_287=ret.offset;}txt=rs.nodeValue;_283=doc.createTextNode(txt.substring(0,_287));var _288=txt.substring(_287);if(_288!==""){_284=doc.createTextNode(txt.substring(_287));}_285=_1de.create("span");_286=doc.createTextNode(".");_285.appendChild(_286);var _289=_1de.create("span");_285.appendChild(_289);if(_283.length){_1de.place(_283,rs,"after");}else{_283=rs;}_1de.place(_285,_283,"after");if(_284){_1de.place(_284,_285,"after");}_1de.destroy(rs);var _28a=_1eb.create();_28a.setStart(_286,0);_28a.setEnd(_286,_286.length);_281.removeAllRanges();_281.addRange(_28a);if(has("webkit")){var _28b="color";if(_27f==="hilitecolor"||_27f==="backcolor"){_28b="backgroundColor";}_1e0.set(_285,_28b,_280);_1ea.remove();_1de.destroy(_289);_285.innerHTML="&#160;";_1ea.selectElement(_285);this.focus();}else{this.execCommand(_27f,_280);_1de.place(_285.firstChild,_285,"before");_1de.destroy(_285);_28a.setStart(_286,0);_28a.setEnd(_286,_286.length);_281.removeAllRanges();_281.addRange(_28a);_1ea.collapse(false);_286.parentNode.removeChild(_286);}}));return true;}}}return false;},_adjustNodeAndOffset:function(node,_28c){while(node.length<_28c&&node.nextSibling&&node.nextSibling.nodeType===3){_28c=_28c-node.length;node=node.nextSibling;}return {"node":node,"offset":_28c};},_tagNamesForCommand:function(_28d){if(_28d==="bold"){return ["b","strong"];}else{if(_28d==="italic"){return ["i","em"];}else{if(_28d==="strikethrough"){return ["s","strike"];}else{if(_28d==="superscript"){return ["sup"];}else{if(_28d==="subscript"){return ["sub"];}else{if(_28d==="underline"){return ["u"];}}}}}}return [];},_stripBreakerNodes:function(node){win.withGlobal(this.window,lang.hitch(this,function(){var _28e=_1e3(".ieFormatBreakerSpan",node);var i;for(i=0;i<_28e.length;i++){var b=_28e[i];while(b.firstChild){_1de.place(b.firstChild,b,"before");}_1de.destroy(b);}}));return node;}});return _1ef;});},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_28f){return function(_290,_291){switch(typeof _290){default:throw new Error("Can not query with a "+typeof _290);case "object":case "undefined":var _292=_290;_290=function(_293){for(var key in _292){var _294=_292[key];if(_294&&_294.test){if(!_294.test(_293[key])){return false;}}else{if(_294!=_293[key]){return false;}}}return true;};break;case "string":if(!this[_290]){throw new Error("No filter function "+_290+" was found in store");}_290=this[_290];case "function":}function _295(_296){var _297=_28f.filter(_296,_290);if(_291&&_291.sort){_297.sort(function(a,b){for(var sort,i=0;sort=_291.sort[i];i++){var _298=a[sort.attribute];var _299=b[sort.attribute];if(_298!=_299){return !!sort.descending==_298>_299?-1:1;}}return 0;});}if(_291&&(_291.start||_291.count)){var _29a=_297.length;_297=_297.slice(_291.start||0,(_291.start||0)+(_291.count||Infinity));_297.total=_29a;}return _297;};_295.matches=_290;return _295;};});},"esri/dijit/editing/AttachmentEditor":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(_29b,dojo,_29c){dojo.provide("esri.dijit.editing.AttachmentEditor");dojo.require("dijit._Widget");dojo.require("dijit._Templated");(function(){var css=[dojo.moduleUrl("esri.dijit.editing","css/attachment.css")];var head=document.getElementsByTagName("head").item(0),link,i,il=css.length;for(i=0;i<il;i++){link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=css[i];head.appendChild(link);}}());dojo.declare("esri.dijit.editing.AttachmentEditor",[_29b._Widget,_29b._Templated],{widgetsInTemplate:true,templateString:"<div class=\"attachmentEditor\">\r\n    <br />\r\n    <div>\r\n        <b>${NLS_attachments}</b>\r\n        <hr />\r\n        <br /> \r\n        <span dojoAttachPoint='_attachmentList' style='word-wrap: break-word;'></span>\r\n        <br><br>\r\n        <form dojoAttachPoint='_uploadForm'> ${NLS_add}:&nbsp;&nbsp;<input type='file' name='attachment' dojoAttachPoint='_uploadField' /> </form>\r\n    </div>\r\n</div>",basePath:dojo.moduleUrl("esri.dijit.editing"),_listHtml:"<span id='node_${oid}_${attid}'><a href='${href}' target='_blank'>${name}</a>",_deleteBtnHtml:"(<span style='cursor:pointer;color:red;font-weight:bold;' class='deleteAttachment' id='${attid}');'>X</span>)",_endHtml:"<br/></span>",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(_29d,_29e){dojo.mixin(this,esri.bundle.widgets.attachmentEditor);},startup:function(){this.inherited(arguments);this._uploadField_connect=dojo.connect(this._uploadField,"onchange",this,"_addAttachment");},destroy:function(){dojo.forEach(this._aeConnects,dojo.disconnect);dojo.disconnect(this._uploadField_connect);this.inherited(arguments);},showAttachments:function(_29f,_2a0){var list=this._attachmentList;list.innerHTML=this.NLS_none;this._uploadField.value="";if(!_29f){return;}this._featureLayer=_29f.getLayer()||_2a0;if(!this._featureLayer){return;}this._currentLayerId=this._featureLayer.id;if(!this._layerEditingCapChecked[this._currentLayerId]){this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities();this._layerEditingCapChecked[this._currentLayerId]=true;}this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:_29f}).canUpdate;this._oid=_29f.attributes[this._featureLayer.objectIdField];this._getAttachments(_29f);},_getAttachments:function(_2a1){if(!this._featureLayer||!this._featureLayer.queryAttachmentInfos){return;}this._featureLayer.queryAttachmentInfos(this._oid,dojo.hitch(this,"_onQueryAttachmentInfosComplete"));},_addAttachment:function(){if(!this._featureLayer||!this._featureLayer.addAttachment){return;}this._featureLayer.addAttachment(this._oid,this._uploadForm,dojo.hitch(this,"_onAddAttachmentComplete"));},_deleteAttachment:function(oid,_2a2){this._featureLayer.deleteAttachments(oid,[_2a2],dojo.hitch(this,"_onDeleteAttachmentComplete"));},_onQueryAttachmentInfosComplete:function(_2a3){var _2a4=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";if((!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate)||(!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate)){_2a4=this._listHtml+this._endHtml;this._uploadForm.style.display="none";}else{if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_2a4=this._listHtml+this._endHtml;}}var list=this._attachmentList,_2a5=dojo.map(_2a3,dojo.hitch(this,function(info){return esri.substitute({href:info.url,name:info.name,oid:info.objectId,attid:info.id},_2a4);}));list.innerHTML=_2a5.join("")||this.NLS_none;this._updateConnects();},_onAddAttachmentComplete:function(_2a6){var _2a7=this._uploadField;var _2a8=_2a7.value;var pos=_2a8.lastIndexOf("\\");if(pos>-1){_2a8=_2a8.substring(pos+1,_2a8.length);}_2a8=_2a8.replace(/\ /g,"_");var list=this._attachmentList,_2a9=dojo.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var _2aa=this._listHtml+this._deleteBtnHtml+this._endHtml;if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_2aa=this._listHtml+this._endHtml;}var link=esri.substitute({href:this._featureLayer._url.path+"/"+_2a6.objectId+"/attachments/"+_2a6.attachmentId+(_2a9?("?"+_2a9):""),name:_2a8,oid:_2a6.objectId,attid:_2a6.attachmentId},_2aa);list.innerHTML=list.innerHTML==this.NLS_none?link:(list.innerHTML+link);this._updateConnects();_2a7.value="";},_onDeleteAttachmentComplete:function(_2ab){var _2ac=dojo.every(_2ab,function(_2ad){return _2ad.success;});if(_2ac){dojo.byId("node_"+_2ab[0].objectId+"_"+_2ab[0].attachmentId).innerHTML="";}},_updateConnects:function(){dojo.forEach(this._aeConnects,dojo.disconnect);dojo.query(".deleteAttachment").forEach(function(item){this._aeConnects.push(dojo.connect(item,"onclick",dojo.hitch(this,"_deleteAttachment",this._oid,item.id)));},this);}});});},"dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_2ae,dom,_2af,_2b0){return _2ae("dijit.ToolbarSeparator",[_2af,_2b0],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/sniff","dojo/_base/window"],function(lang,_2b1,_2b2,_2b3,_2b4,_2b5,_2b6,_2b7,has,win){return _2b4("dijit.layout._LayoutWidget",[_2b1,_2b2,_2b3],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_2b5.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _2b8=this.getParent&&this.getParent();if(!(_2b8&&_2b8.isLayoutContainer)){this.resize();this.connect(win.global,"onresize",function(){this.resize();});}},resize:function(_2b9,_2ba){var node=this.domNode;if(_2b9){_2b6.setMarginBox(node,_2b9);}var mb=_2ba||{};lang.mixin(mb,_2b9||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_2b6.getMarginBox(node),mb);}var cs=_2b7.getComputedStyle(node);var me=_2b6.getMarginExtents(node,cs);var be=_2b6.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_2b6.getPadExtents(node,cs);this._contentBox={l:_2b7.toPixelValue(node,cs.paddingLeft),t:_2b7.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_2bb){var cls=this.baseClass+"-child "+(_2bb.baseClass?this.baseClass+"-"+_2bb.baseClass:"");_2b5.add(_2bb.domNode,cls);},addChild:function(_2bc,_2bd){this.inherited(arguments);if(this._started){this._setupChild(_2bc);}},removeChild:function(_2be){var cls=this.baseClass+"-child"+(_2be.baseClass?" "+this.baseClass+"-"+_2be.baseClass:"");_2b5.remove(_2be.domNode,cls);this.inherited(arguments);}});});},"dijit/form/_Spinner":function(){require({cache:{"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\" role=\"presentation\"\r\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\r\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\r\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\r\n\t\t\t><div class=\"dijitArrowButtonInner\"\r\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/></div\r\n\t\t></div\r\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\r\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\r\n\t\t\t><div class=\"dijitArrowButtonInner\"\r\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/></div\r\n\t\t></div\r\n\t></div\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\r\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\r\n\t/></div\r\n></div>\r\n"}});define("dijit/form/_Spinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/_base/sniff","dijit/typematic","./RangeBoundTextBox","dojo/text!./templates/Spinner.html","./_TextBoxMixin"],function(_2bf,_2c0,keys,lang,has,_2c1,_2c2,_2c3,_2c4){return _2bf("dijit.form._Spinner",_2c2,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:_2c3,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{"upArrowNode":"dijitUpArrowButton","downArrowNode":"dijitDownArrowButton"},adjust:function(val){return val;},_arrowPressed:function(_2c5,_2c6,_2c7){if(this.disabled||this.readOnly){return;}this._setValueAttr(this.adjust(this.get("value"),_2c6*_2c7),false);_2c4.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(){this._wheelTimer=null;},_typematicCallback:function(_2c8,node,evt){var inc=this.smallDelta;if(node==this.textbox){var key=evt.charOrCode;inc=(key==keys.PAGE_UP||key==keys.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==keys.UP_ARROW||key==keys.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_2c8==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){_2c0.stop(evt);var _2c9=evt.wheelDelta/120;if(Math.floor(_2c9)!=_2c9){_2c9=evt.wheelDelta>0?1:-1;}var _2ca=evt.detail?(evt.detail*-1):_2c9;if(_2ca!==0){var node=this[(_2ca>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_2ca,this.smallDelta);if(!this._wheelTimer){clearTimeout(this._wheelTimer);}this._wheelTimer=setTimeout(lang.hitch(this,"_arrowReleased",node),50);}},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,!has("mozilla")?"onmousewheel":"DOMMouseScroll","_mouseWheeled");this._connects.push(_2c1.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));this._connects.push(_2c1.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));this._connects.push(_2c1.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));this._connects.push(_2c1.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));}});});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_2cb,_2cc,_2cd){return _2cb("dojo.store.Memory",null,{constructor:function(_2ce){for(var i in _2ce){this[i]=_2ce[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_2cd,get:function(id){return this.data[this.index[id]];},getIdentity:function(_2cf){return _2cf[this.idProperty];},put:function(_2d0,_2d1){var data=this.data,_2d2=this.index,_2d3=this.idProperty;var id=(_2d1&&"id" in _2d1)?_2d1.id:_2d3 in _2d0?_2d0[_2d3]:Math.random();if(id in _2d2){if(_2d1&&_2d1.overwrite===false){throw new Error("Object already exists");}data[_2d2[id]]=_2d0;}else{_2d2[id]=data.push(_2d0)-1;}return id;},add:function(_2d4,_2d5){(_2d5=_2d5||{}).overwrite=false;return this.put(_2d4,_2d5);},remove:function(id){var _2d6=this.index;var data=this.data;if(id in _2d6){data.splice(_2d6[id],1);this.setData(data);return true;}},query:function(_2d7,_2d8){return _2cc(this.queryEngine(_2d7,_2d8)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"url:dijit/templates/Tooltip.html":"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\r\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" data-dojo-attach-point=\"containerNode\" role='alert'></div\r\n\t><div class=\"dijitTooltipConnector\" data-dojo-attach-point=\"connectorNode\"></div\r\n></div>\r\n","dijit/Editor":function(){define("dijit/Editor",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/_base/sniff","dojo/string","dojo/topic","dojo/_base/window","./_base/focus","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText",".","dojo/i18n!./_editor/nls/commands"],function(_2d9,_2da,_2db,i18n,_2dc,_2dd,_2de,_2df,_2e0,keys,lang,has,_2e1,_2e2,win,_2e3,_2e4,_2e5,_2e6,_2e7,_2e8,_2e9,_2ea,html,_2eb,_2ec,_2ed){var _2ee=_2da("dijit.Editor",_2ec,{plugins:null,extraPlugins:null,constructor:function(){if(!lang.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_2ea];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(has("ie")){this.events.push("onBeforeDeactivate");this.events.push("onBeforeActivate");}},postMixInProperties:function(){this.setValueDeferred=new _2db();this.inherited(arguments);},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(lang.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new _2e5({dir:this.dir,lang:this.lang});this.header.appendChild(this.toolbar.domNode);}_2d9.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.callback(true);_2dd.add(this.iframe.parentNode,"dijitEditorIFrameContainer");_2dd.add(this.iframe,"dijitEditorIFrame");_2dc.set(this.iframe,"allowTransparency",true);if(has("webkit")){_2df.set(this.domNode,"KhtmlUserSelect","none");}this.toolbar.startup();this.onNormalizedDisplayChanged();},destroy:function(){_2d9.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_2ef,_2f0){var args=lang.isString(_2ef)?{name:_2ef}:lang.isFunction(_2ef)?{ctor:_2ef}:_2ef;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};if(args.name){if(_2e9.registry[args.name]){o.plugin=_2e9.registry[args.name](args);}else{_2e2.publish(_2ed._scopeName+".Editor.getPlugin",o);}}if(!o.plugin){var pc=args.ctor||lang.getObject(args.name);if(pc){o.plugin=new pc(args);}}if(!o.plugin){console.warn("Cannot find plugin",_2ef);return;}_2ef=o.plugin;}if(arguments.length>1){this._plugins[_2f0]=_2ef;}else{this._plugins.push(_2ef);}_2ef.setEditor(this);if(lang.isFunction(_2ef.setToolbar)){_2ef.setToolbar(this.toolbar);}},resize:function(size){if(size){_2e7.prototype.resize.apply(this,arguments);}},layout:function(){var _2f1=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_2de.getPadBorderExtents(this.iframe.parentNode).h+_2de.getMarginExtents(this.iframe.parentNode).h));this.editingArea.style.height=_2f1+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){var _2f2;var b=this.document.body;var _2f3=b.clientWidth;var _2f4=b.clientHeight;var _2f5=b.clientLeft;var _2f6=b.offsetWidth;var _2f7=b.offsetHeight;var _2f8=b.offsetLeft;if(/^rtl$/i.test(b.dir||"")){if(_2f3<_2f6&&e.x>_2f3&&e.x<_2f6){_2f2=true;}}else{if(e.x<_2f5&&e.x>_2f8){_2f2=true;}}if(!_2f2){if(_2f4<_2f7&&e.y>_2f4&&e.y<_2f7){_2f2=true;}}if(!_2f2){delete this._cursorToStart;delete this._savedSelection;if(e.target.tagName=="BODY"){setTimeout(lang.hitch(this,"placeCursorAtEnd"),0);}this.inherited(arguments);}},onBeforeActivate:function(){this._restoreSelection();},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}if(e.target.tagName!="BODY"){this._saveSelection();}},customUndo:true,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){clearTimeout(this._editTimer);}this._editTimer=setTimeout(lang.hitch(this,this.endEditing),this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}var r=this.inherited(arguments);if(this.customUndo){this._endEditing();}return r;}},_pasteImpl:function(){return this._clipboardCommand("paste");},_cutImpl:function(){return this._clipboardCommand("cut");},_copyImpl:function(){return this._clipboardCommand("copy");},_clipboardCommand:function(cmd){var r;try{r=this.document.execCommand(cmd,false,null);if(has("webkit")&&!r){throw {code:1011};}}catch(e){if(e.code==1011){var sub=_2e1.substitute,_2f9={cut:"X",copy:"C",paste:"V"};alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[has("mac")?"appleKey":"ctrlKey"],[_2f9[cmd]])]));}r=false;}return r;},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited(arguments);}},_moveToBookmark:function(b){var _2fa=b.mark;var mark=b.mark;var col=b.isCollapsed;var r,_2fb,_2fc,sel;if(mark){if(has("ie")<9){if(lang.isArray(mark)){_2fa=[];_2d9.forEach(mark,function(n){_2fa.push(_2eb.getNode(n,this.editNode));},this);win.withGlobal(this.window,"moveToBookmark",_2ed,[{mark:_2fa,isCollapsed:col}]);}else{if(mark.startContainer&&mark.endContainer){sel=_2eb.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_2eb.create(this.window);_2fb=_2eb.getNode(mark.startContainer,this.editNode);_2fc=_2eb.getNode(mark.endContainer,this.editNode);if(_2fb&&_2fc){r.setStart(_2fb,mark.startOffset);r.setEnd(_2fc,mark.endOffset);sel.addRange(r);}}}}}else{sel=_2eb.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_2eb.create(this.window);_2fb=_2eb.getNode(mark.startContainer,this.editNode);_2fc=_2eb.getNode(mark.endContainer,this.editNode);if(_2fb&&_2fc){r.setStart(_2fb,mark.startOffset);r.setEnd(_2fc,mark.endOffset);sel.addRange(r);}}}}},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._steps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();delete this._undoRedoActive;ret=true;}delete this._undoRedoActive;}return ret;},redo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();ret=true;}delete this._undoRedoActive;}return ret;},endEditing:function(_2fd){if(this._editTimer){clearTimeout(this._editTimer);}if(this._inEditing){this._endEditing(_2fd);this._inEditing=false;}},_getBookmark:function(){var b=win.withGlobal(this.window,_2e3.getBookmark);var tmp=[];if(b&&b.mark){var mark=b.mark;if(has("ie")<9){var sel=_2eb.getSelection(this.window);if(!lang.isArray(mark)){if(sel){var _2fe;if(sel.rangeCount){_2fe=sel.getRangeAt(0);}if(_2fe){b.mark=_2fe.cloneRange();}else{b.mark=win.withGlobal(this.window,_2e3.getBookmark);}}}else{_2d9.forEach(b.mark,function(n){tmp.push(_2eb.getIndex(n,this.editNode).o);},this);b.mark=tmp;}}try{if(b.mark&&b.mark.startContainer){tmp=_2eb.getIndex(b.mark.startContainer,this.editNode).o;b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_2eb.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};}}catch(e){b.mark=null;}}return b;},_beginEditing:function(){if(this._steps.length===0){this._steps.push({"text":html.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});}},_endEditing:function(){var v=html.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!has("ie")&&!this.iframe&&e.keyCode==keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){_2e0.stop(e);this.undo();return;}else{if(k==89||k==121){_2e0.stop(e);this.redo();return;}}}this.inherited(arguments);switch(k){case keys.ENTER:case keys.BACKSPACE:case keys.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");setTimeout(lang.hitch(this,this.endEditing),1);}else{this.beginEditing("paste");setTimeout(lang.hitch(this,this.endEditing),1);}break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<keys.F1||e.keyCode>keys.F15)){this.beginEditing();break;}case keys.ALT:this.endEditing();break;case keys.UP_ARROW:case keys.DOWN_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:case keys.HOME:case keys.END:case keys.PAGE_UP:case keys.PAGE_DOWN:this.endEditing(true);break;case keys.CTRL:case keys.SHIFT:case keys.TAB:break;}},_onBlur:function(){this.inherited(arguments);this.endEditing(true);},_saveSelection:function(){try{this._savedSelection=this._getBookmark();}catch(e){}},_restoreSelection:function(){if(this._savedSelection){delete this._cursorToStart;if(win.withGlobal(this.window,"isCollapsed",_2ed)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},onClick:function(){this.endEditing(true);this.inherited(arguments);},replaceValue:function(html){if(!this.customUndo){this.inherited(arguments);}else{if(this.isClosed){this.setValue(html);}else{this.beginEditing();if(!html){html="&#160;";}this.setValue(html);this.endEditing();}}},_setDisabledAttr:function(_2ff){var _300=lang.hitch(this,function(){if((!this.disabled&&_2ff)||(!this._buttonEnabledPlugins&&_2ff)){_2d9.forEach(this._plugins,function(p){p.set("disabled",true);});}else{if(this.disabled&&!_2ff){_2d9.forEach(this._plugins,function(p){p.set("disabled",false);});}}});this.setValueDeferred.addCallback(_300);this.inherited(arguments);},_setStateClass:function(){try{this.inherited(arguments);if(this.document&&this.document.body){_2df.set(this.document.body,"color",_2df.get(this.iframe,"color"));}}catch(e){}}});function _301(args){return new _2e9({command:args.name});};function _302(args){return new _2e9({buttonClass:_2e8,command:args.name});};lang.mixin(_2e9.registry,{"undo":_301,"redo":_301,"cut":_301,"copy":_301,"paste":_301,"insertOrderedList":_301,"insertUnorderedList":_301,"indent":_301,"outdent":_301,"justifyCenter":_301,"justifyFull":_301,"justifyLeft":_301,"justifyRight":_301,"delete":_301,"selectAll":_301,"removeFormat":_301,"unlink":_301,"insertHorizontalRule":_301,"bold":_302,"italic":_302,"underline":_302,"strikethrough":_302,"subscript":_302,"superscript":_302,"|":function(){return new _2e9({button:new _2e6(),setEditor:function(_303){this.editor=_303;}});}});return _2ee;});},"dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/_base/kernel","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_304,_305,_306,keys,_307,_308,_309,_30a){if(!_306.isAsync){_307(0,function(){var _30b=["dijit/ToolbarSeparator"];_304(_30b);});}return _305("dijit.Toolbar",[_308,_30a,_309],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"dijit/_editor/plugins/LinkDialog":function(){define("dijit/_editor/plugins/LinkDialog",["require","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/_base/sniff","dojo/string","dojo/_base/window","../../_Widget","../_Plugin","../../form/DropDownButton","../range","../selection"],function(_30c,_30d,_30e,keys,lang,has,_30f,win,_310,_311,_312,_313,_314){var _315=_30d("dijit._editor.plugins.LinkDialog",_311,{buttonClass:_312,useDefaultCommand:false,urlRegExp:"((https?|ftps?|file)\\://|./|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",emailRegExp:"<?(mailto\\:)([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+"+"@"+"((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*>?",htmlTemplate:"<a href=\"${urlInput}\" _djrealurl=\"${urlInput}\""+" target=\"${targetSelect}\""+">${textInput}</a>",tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,linkDialogTemplate:["<table><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' "+"id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_targetSelect'>${target}</label>","</td><td>","<select id='${id}_targetSelect' name='targetSelect' data-dojo-type='dijit.form.Select'>","<option selected='selected' value='_self'>${currentWindow}</option>","<option value='_blank'>${newWindow}</option>","<option value='_top'>${topWindow}</option>","<option value='_parent'>${parentWindow}</option>","</select>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),_initButton:function(){this.inherited(arguments);this.button.loadDropDown=lang.hitch(this,"_loadDropDown");this._connectTagEvents();},_loadDropDown:function(_316){_30c(["dojo/i18n","../../TooltipDialog","../../registry","../../form/Button","../../form/Select","../../form/ValidationTextBox","dojo/i18n!../../nls/common","dojo/i18n!../nls/LinkDialog"],lang.hitch(this,function(i18n,_317,_318){var _319=this;this.tag=this.command=="insertImage"?"img":"a";var _31a=lang.delegate(i18n.getLocalization("dijit","common",this.lang),i18n.getLocalization("dijit._editor","LinkDialog",this.lang));var _31b=(this.dropDown=this.button.dropDown=new _317({title:_31a[this.command+"Title"],execute:lang.hitch(this,"setValue"),onOpen:function(){_319._onOpenDialog();_317.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(lang.hitch(_319,"_onCloseDialog"),0);}}));_31a.urlRegExp=this.urlRegExp;_31a.id=_318.getUniqueId(this.editor.id);this._uniqueId=_31a.id;this._setContent(_31b.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_30f.substitute(this.linkDialogTemplate,_31a));_31b.startup();this._urlInput=_318.byId(this._uniqueId+"_urlInput");this._textInput=_318.byId(this._uniqueId+"_textInput");this._setButton=_318.byId(this._uniqueId+"_setButton");this.connect(_318.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel();});if(this._urlInput){this.connect(this._urlInput,"onChange","_checkAndFixInput");}if(this._textInput){this.connect(this._textInput,"onChange","_checkAndFixInput");}this._urlRegExp=new RegExp("^"+this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=lang.hitch(this,function(){var _31c=this._urlInput.get("value");return this._urlRegExp.test(_31c)||this._emailRegExp.test(_31c);});this.connect(_31b.domNode,"onkeypress",function(e){if(e&&e.charOrCode==keys.ENTER&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){if(!this._setButton.get("disabled")){_31b.onExecute();_31b.execute(_31b.get("value"));}}});_316();}));},_checkAndFixInput:function(){var self=this;var url=this._urlInput.get("value");var _31d=function(url){var _31e=false;var _31f=false;if(url&&url.length>1){url=lang.trim(url);if(url.indexOf("mailto:")!==0){if(url.indexOf("/")>0){if(url.indexOf("://")===-1){if(url.charAt(0)!=="/"&&url.indexOf("./")!==0){if(self._hostRxp.test(url)){_31e=true;}}}}else{if(self._userAtRxp.test(url)){_31f=true;}}}}if(_31e){self._urlInput.set("value","http://"+url);}if(_31f){self._urlInput.set("value","mailto:"+url);}self._setButton.set("disabled",!self._isValid());};if(this._delayedCheck){clearTimeout(this._delayedCheck);this._delayedCheck=null;}this._delayedCheck=setTimeout(function(){_31d(url);},250);},_connectTagEvents:function(){this.editor.onLoadDeferred.addCallback(lang.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);}));},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid();},_setContent:function(_320){this.dropDown.set({parserScope:"dojo",content:_320});},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}return args;},setValue:function(args){this._onCloseDialog();if(has("ie")<9){var sel=_313.getSelection(this.editor.window);var _321=sel.getRangeAt(0);var a=_321.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=win.withGlobal(this.editor.window,"getSelectedElement",_314,[this.tag]);}if(a&&(a.nodeName&&a.nodeName.toLowerCase()===this.tag)){if(this.editor.queryCommandEnabled("unlink")){win.withGlobal(this.editor.window,"selectElementChildren",_314,[a]);this.editor.execCommand("unlink");}}}args=this._checkValues(args);this.editor.execCommand("inserthtml",_30f.substitute(this.htmlTemplate,args));},_onCloseDialog:function(){this.editor.focus();},_getCurrentValues:function(a){var url,text,_322;if(a&&a.tagName.toLowerCase()===this.tag){url=a.getAttribute("_djrealurl")||a.getAttribute("href");_322=a.getAttribute("target")||"_self";text=a.textContent||a.innerText;win.withGlobal(this.editor.window,"selectElement",_314,[a,true]);}else{text=win.withGlobal(this.editor.window,_314.getSelectedText);}return {urlInput:url||"",textInput:text||"",targetSelect:_322||""};},_onOpenDialog:function(){var a;if(has("ie")<9){var sel=_313.getSelection(this.editor.window);var _323=sel.getRangeAt(0);a=_323.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=win.withGlobal(this.editor.window,"getSelectedElement",_314,[this.tag]);}}else{a=win.withGlobal(this.editor.window,"getAncestorElement",_314,[this.tag]);}this.dropDown.reset();this._setButton.set("disabled",true);this.dropDown.set("value",this._getCurrentValues(a));},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_30e.get(t,"href")){var _324=this.editor;win.withGlobal(_324.window,"selectElement",_314,[t]);_324.onDisplayChanged();if(_324._updateTimer){clearTimeout(_324._updateTimer);delete _324._updateTimer;}_324.onNormalizedDisplayChanged();var _325=this.button;setTimeout(function(){_325.set("disabled",false);_325.loadAndOpenDropDown().then(function(){if(_325.dropDown.focus){_325.dropDown.focus();}});},10);}}}});var _326=_30d("dijit._editor.plugins.ImgLinkDialog",[_315],{linkDialogTemplate:["<table><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' "+"required='true' id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='false' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","</td><td>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),htmlTemplate:"<img src=\"${urlInput}\" _djrealurl=\"${urlInput}\" alt=\"${textInput}\" />",tag:"img",_getCurrentValues:function(img){var url,text;if(img&&img.tagName.toLowerCase()===this.tag){url=img.getAttribute("_djrealurl")||img.getAttribute("src");text=img.getAttribute("alt");win.withGlobal(this.editor.window,"selectElement",_314,[img,true]);}else{text=win.withGlobal(this.editor.window,_314.getSelectedText);}return {urlInput:url||"",textInput:text||""};},_isValid:function(){return this._urlInput.isValid();},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.addCallback(lang.hitch(this,function(){this.connect(this.editor.editNode,"onmousedown",this._selectTag);}));},_selectTag:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag){win.withGlobal(this.editor.window,"selectElement",_314,[t]);}}},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}if(args&&args.textInput){args.textInput=args.textInput.replace(/"/g,"&quot;");}return args;},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_30e.get(t,"src")){var _327=this.editor;win.withGlobal(_327.window,"selectElement",_314,[t]);_327.onDisplayChanged();if(_327._updateTimer){clearTimeout(_327._updateTimer);delete _327._updateTimer;}_327.onNormalizedDisplayChanged();var _328=this.button;setTimeout(function(){_328.set("disabled",false);_328.loadAndOpenDropDown().then(function(){if(_328.dropDown.focus){_328.dropDown.focus();}});},10);}}}});_311.registry["createLink"]=function(){return new _315({command:"createLink"});};_311.registry["insertImage"]=function(){return new _326({command:"insertImage"});};_315.ImgLinkDialog=_326;return _315;});},"dojo/data/util/simpleFetch":function(){define(["dojo/_base/lang","dojo/_base/window","./sorter"],function(lang,_329,_32a){var _32b=lang.getObject("dojo.data.util.simpleFetch",true);_32b.fetch=function(_32c){_32c=_32c||{};if(!_32c.store){_32c.store=this;}var self=this;var _32d=function(_32e,_32f){if(_32f.onError){var _330=_32f.scope||_329.global;_32f.onError.call(_330,_32e,_32f);}};var _331=function(_332,_333){var _334=_333.abort||null;var _335=false;var _336=_333.start?_333.start:0;var _337=(_333.count&&(_333.count!==Infinity))?(_336+_333.count):_332.length;_333.abort=function(){_335=true;if(_334){_334.call(_333);}};var _338=_333.scope||_329.global;if(!_333.store){_333.store=self;}if(_333.onBegin){_333.onBegin.call(_338,_332.length,_333);}if(_333.sort){_332.sort(_32a.createSortFunction(_333.sort,self));}if(_333.onItem){for(var i=_336;(i<_332.length)&&(i<_337);++i){var item=_332[i];if(!_335){_333.onItem.call(_338,item,_333);}}}if(_333.onComplete&&!_335){var _339=null;if(!_333.onItem){_339=_332.slice(_336,_337);}_333.onComplete.call(_338,_339,_333);}};this._fetchItems(_32c,_331,_32d);return _32c;};return _32b;});},"url:dijit/form/templates/ValidationTextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\" role=\"presentation\"\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\r\n\t\t\t${!nameAttrSetting} type='${type}'\r\n\t/></div\r\n></div>\r\n","url:dijit/form/templates/TextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\" id=\"widget_${id}\" role=\"presentation\"\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\r\n\t\t\t${!nameAttrSetting} type='${type}'\r\n\t/></div\r\n></div>\r\n","dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_33a,_33b,_33c,_33d,keys,_33e,_33f,_340,lang){return _33e("dijit._KeyNavContainer",[_33c,_33b],{tabIndex:"0",connectKeyNavHandlers:function(_341,_342){var _343=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_33d.forEach(_341,function(code){_343[code]=prev;});_33d.forEach(_342,function(code){_343[code]=next;});_343[keys.HOME]=lang.hitch(this,"focusFirstChild");_343[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_33a.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_33d.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_344,_345){this.inherited(arguments);this._startupChild(_344);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_346,last){if(!_346){return;}if(this.focusedChild&&_346!==this.focusedChild){this._onChildBlur(this.focusedChild);}_346.set("tabIndex",this.tabIndex);_346.focus(last?"end":"start");this._set("focusedChild",_346);},_startupChild:function(_347){_347.set("tabIndex","-1");this.connect(_347,"_onFocus",function(){_347.set("tabIndex",this.tabIndex);});this.connect(_347,"_onBlur",function(){_347.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_340.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_340.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_33f.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_348,dir){if(_348){_348=this._getSiblingOfChild(_348,dir);}var _349=this.getChildren();for(var i=0;i<_349.length;i++){if(!_348){_348=_349[(dir>0)?0:(_349.length-1)];}if(_348.isFocusable()){return _348;}_348=this._getSiblingOfChild(_348,dir);}return null;}});});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_34a,_34b){return _34a("dijit._Contained",null,{_getSibling:function(_34c){var node=this.domNode;do{node=node[_34c+"Sibling"];}while(node&&node.nodeType!=1);return node&&_34b.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_34d,dom,lang,_34e,_34f,_350){function _351(_352){return {id:_352.value,value:_352.value,name:lang.trim(_352.innerText||_352.textContent||"")};};return _34d("dijit.form.DataList",_34f,{constructor:function(_353,_354){this.domNode=dom.byId(_354);lang.mixin(this,_353);if(this.id){_350.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_34e("option",this.domNode).map(_351)}]);},destroy:function(){_350.remove(this.id);},fetchSelectedItem:function(){var _355=_34e("> option[selected]",this.domNode)[0]||_34e("> option",this.domNode)[0];return _355&&_351(_355);}});});},"dijit/_editor/_Plugin":function(){define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../form/Button"],function(_356,_357,lang,_358){var _359=_357("dijit._editor._Plugin",null,{constructor:function(args){this.params=args||{};lang.mixin(this,this.params);this._connects=[];this._attrPairNames={};},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_358,disabled:false,getLabel:function(key){return this.editor.commands[key];},_initButton:function(){if(this.command.length){var _35a=this.getLabel(this.command),_35b=this.editor,_35c=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){var _35d=lang.mixin({label:_35a,dir:_35b.dir,lang:_35b.lang,showLabel:false,iconClass:_35c,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});this.button=new this.buttonClass(_35d);}}if(this.get("disabled")&&this.button){this.button.set("disabled",this.get("disabled"));}},destroy:function(){var h;while(h=this._connects.pop()){h.remove();}if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(_356.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_35e,_35f;if(!e||!e.isLoaded||!c.length){return;}var _360=this.get("disabled");if(this.button){try{_35f=!_360&&e.queryCommandEnabled(c);if(this.enabled!==_35f){this.enabled=_35f;this.button.set("disabled",!_35f);}if(typeof this.button.checked=="boolean"){_35e=e.queryCommandState(c);if(this.checked!==_35e){this.checked=_35e;this.button.set("checked",e.queryCommandState(c));}}}catch(e){console.log(e);}}},setEditor:function(_361){this.editor=_361;this._initButton();if(this.button&&this.useDefaultCommand){if(this.editor.queryCommandAvailable(this.command)){this.connect(this.button,"onClick",lang.hitch(this.editor,"execCommand",this.command,this.commandArg));}else{this.button.domNode.style.display="none";}}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_362){if(this.button){_362.addChild(this.button);}},set:function(name,_363){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _364=this._getAttrNames(name);if(this[_364.s]){var _365=this[_364.s].apply(this,Array.prototype.slice.call(arguments,1));}else{this._set(name,_363);}return _365||this;},get:function(name){var _366=this._getAttrNames(name);return this[_366.g]?this[_366.g]():this[name];},_setDisabledAttr:function(_367){this.disabled=_367;this.updateState();},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_368){this[name]=_368;}});_359.registry={};return _359;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","../_base/window","./util/filter","./util/simpleFetch","../date/stamp"],function(_369,lang,_36a,_36b,xhr,_36c,_36d,_36e,_36f,_370){var _371=_36a("dojo.data.ItemFileReadStore",[_36c],{constructor:function(_372){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_372.url;this._ccUrl=_372.url;this.url=_372.url;this._jsonData=_372.data;this.data=null;this._datatypeMap=_372.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_373){return _370.fromISOString(_373);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_372.urlPreventCache!==undefined){this.urlPreventCache=_372.urlPreventCache?true:false;}if(_372.hierarchical!==undefined){this.hierarchical=_372.hierarchical?true:false;}if(_372.clearOnClose){this.clearOnClose=true;}if("failOk" in _372){this.failOk=_372.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_374){if(typeof _374!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_375,_376){var _377=this.getValues(item,_375);return (_377.length>0)?_377[0]:_376;},getValues:function(item,_378){this._assertIsItem(item);this._assertIsAttribute(_378);return (item[_378]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _379=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_379.push(key);}}return _379;},hasAttribute:function(item,_37a){this._assertIsItem(item);this._assertIsAttribute(_37a);return (_37a in item);},containsValue:function(item,_37b,_37c){var _37d=undefined;if(typeof _37c==="string"){_37d=_36e.patternToRegExp(_37c,false);}return this._containsValue(item,_37b,_37c,_37d);},_containsValue:function(item,_37e,_37f,_380){return _36b.some(this.getValues(item,_37e),function(_381){if(_381!==null&&!lang.isObject(_381)&&_380){if(_381.toString().match(_380)){return true;}}else{if(_37f===_381){return true;}}});},isItem:function(_382){if(_382&&_382[this._storeRefPropName]===this){if(this._arrayOfAllItems[_382[this._itemNumPropName]]===_382){return true;}}return false;},isItemLoaded:function(_383){return this.isItem(_383);},loadItem:function(_384){this._assertIsItem(_384.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_385,_386,_387){var self=this,_388=function(_389,_38a){var _38b=[],i,key;if(_389.query){var _38c,_38d=_389.queryOptions?_389.queryOptions.ignoreCase:false;var _38e={};for(key in _389.query){_38c=_389.query[key];if(typeof _38c==="string"){_38e[key]=_36e.patternToRegExp(_38c,_38d);}else{if(_38c instanceof RegExp){_38e[key]=_38c;}}}for(i=0;i<_38a.length;++i){var _38f=true;var _390=_38a[i];if(_390===null){_38f=false;}else{for(key in _389.query){_38c=_389.query[key];if(!self._containsValue(_390,key,_38c,_38e[key])){_38f=false;}}}if(_38f){_38b.push(_390);}}_386(_38b,_389);}else{for(i=0;i<_38a.length;++i){var item=_38a[i];if(item!==null){_38b.push(item);}}_386(_38b,_389);}};if(this._loadFinished){_388(_385,this._getItemsArray(_385.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){_369.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_385,filter:_388});}else{this._loadInProgress=true;var _391={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _392=xhr.get(_391);_392.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_388(_385,self._getItemsArray(_385.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_387(e,_385);}});_392.addErrback(function(_393){self._loadInProgress=false;_387(_393,_385);});var _394=null;if(_385.abort){_394=_385.abort;}_385.abort=function(){var df=_392;if(df&&df.fired===-1){df.cancel();df=null;}if(_394){_394.call(_385);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_388(_385,this._getItemsArray(_385.queryOptions));}catch(e){_387(e,_385);}}else{_387(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_385);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _395=this._queuedFetches[i],_396=_395.args,_397=_395.filter;if(_397){_397(_396,this._getItemsArray(_396.queryOptions));}else{this.fetchItemByIdentity(_396);}}this._queuedFetches=[];}},_getItemsArray:function(_398){if(_398&&_398.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_399){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug("dojo.data.ItemFileReadStore: WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_39a){var _39b=false,self=this;function _39c(_39d){return (_39d!==null)&&(typeof _39d==="object")&&(!lang.isArray(_39d)||_39b)&&(!lang.isFunction(_39d))&&(_39d.constructor==Object||lang.isArray(_39d))&&(typeof _39d._reference==="undefined")&&(typeof _39d._type==="undefined")&&(typeof _39d._value==="undefined")&&self.hierarchical;};function _39e(_39f){self._arrayOfAllItems.push(_39f);for(var _3a0 in _39f){var _3a1=_39f[_3a0];if(_3a1){if(lang.isArray(_3a1)){var _3a2=_3a1;for(var k=0;k<_3a2.length;++k){var _3a3=_3a2[k];if(_39c(_3a3)){_39e(_3a3);}}}else{if(_39c(_3a1)){_39e(_3a1);}}}}};this._labelAttr=_39a.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_39a.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_39b=true;}_39e(item);item[this._rootItemPropName]=true;}var _3a4={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _3a5=item[key];if(_3a5!==null){if(!lang.isArray(_3a5)){item[key]=[_3a5];}}else{item[key]=[null];}}_3a4[key]=key;}}while(_3a4[this._storeRefPropName]){this._storeRefPropName+="_";}while(_3a4[this._itemNumPropName]){this._itemNumPropName+="_";}while(_3a4[this._reverseRefMap]){this._reverseRefMap+="_";}var _3a6;var _3a7=_39a.identifier;if(_3a7){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_3a7;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_3a6=item[_3a7];var _3a8=_3a6[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_3a8)){this._itemsByIdentity[_3a8]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_3a7+"].  Value collided: ["+_3a8+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_3a7+"].  Value collided: ["+_3a8+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_3a6=item[key];for(var j=0;j<_3a6.length;++j){_3a5=_3a6[j];if(_3a5!==null&&typeof _3a5=="object"){if(("_type" in _3a5)&&("_value" in _3a5)){var type=_3a5._type;var _3a9=this._datatypeMap[type];if(!_3a9){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_3a9)){_3a6[j]=new _3a9(_3a5._value);}else{if(lang.isFunction(_3a9.deserialize)){_3a6[j]=_3a9.deserialize(_3a5._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_3a5._reference){var _3aa=_3a5._reference;if(!lang.isObject(_3aa)){_3a6[j]=this._getItemByIdentity(_3aa);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _3ab=this._arrayOfAllItems[k],_3ac=true;for(var _3ad in _3aa){if(_3ab[_3ad]!=_3aa[_3ad]){_3ac=false;}}if(_3ac){_3a6[j]=_3ab;}}}if(this.referenceIntegrity){var _3ae=_3a6[j];if(this.isItem(_3ae)){this._addReferenceToMap(_3ae,item,key);}}}else{if(this.isItem(_3a5)){if(this.referenceIntegrity){this._addReferenceToMap(_3a5,item,key);}}}}}}}},_addReferenceToMap:function(_3af,_3b0,_3b1){},getIdentity:function(item){var _3b2=this._features["dojo.data.api.Identity"];if(_3b2===Number){return item[this._itemNumPropName];}else{var _3b3=item[_3b2];if(_3b3){return _3b3[0];}}return null;},fetchItemByIdentity:function(_3b4){var item,_3b5;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_369.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_3b4});}else{this._loadInProgress=true;var _3b6={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _3b7=xhr.get(_3b6);_3b7.addCallback(function(data){var _3b8=_3b4.scope?_3b4.scope:_36d.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_3b4.identity);if(_3b4.onItem){_3b4.onItem.call(_3b8,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_3b4.onError){_3b4.onError.call(_3b8,error);}}});_3b7.addErrback(function(_3b9){self._loadInProgress=false;if(_3b4.onError){var _3ba=_3b4.scope?_3b4.scope:_36d.global;_3b4.onError.call(_3ba,_3b9);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_3b4.identity);if(_3b4.onItem){_3b5=_3b4.scope?_3b4.scope:_36d.global;_3b4.onItem.call(_3b5,item);}}}}else{item=this._getItemByIdentity(_3b4.identity);if(_3b4.onItem){_3b5=_3b4.scope?_3b4.scope:_36d.global;_3b4.onItem.call(_3b5,item);}}},_getItemByIdentity:function(_3bb){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_3bb)){item=this._itemsByIdentity[_3bb];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_3bb)){item=this._arrayOfAllItems[_3bb];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _3bc=this._features["dojo.data.api.Identity"];if(_3bc===Number){return null;}else{return [_3bc];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_369.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _3bd={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _3be=xhr.get(_3bd);_3be.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_3be.addErrback(function(_3bf){throw _3bf;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_371,_36f);return _371;});},"dijit/form/ValidationTextBox":function(){require({cache:{"url:dijit/form/templates/ValidationTextBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\" role=\"presentation\"\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class=\"dijitReset dijitInputInner\" data-dojo-attach-point='textbox,focusNode' autocomplete=\"off\"\r\n\t\t\t${!nameAttrSetting} type='${type}'\r\n\t/></div\r\n></div>\r\n"}});define("dijit/form/ValidationTextBox",["dojo/_base/declare","dojo/i18n","./TextBox","../Tooltip","dojo/text!./templates/ValidationTextBox.html","dojo/i18n!./nls/validate"],function(_3c0,i18n,_3c1,_3c2,_3c3){return _3c0("dijit.form.ValidationTextBox",_3c1,{templateString:_3c3,baseClass:"dijitTextBox dijitValidationTextBox",required:false,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},regExp:".*",regExpGen:function(){return this.regExp;},state:"",tooltipPosition:[],_setValueAttr:function(){this.inherited(arguments);this.validate(this.focused);},validator:function(_3c4,_3c5){return (new RegExp("^(?:"+this.regExpGen(_3c5)+")"+(this.required?"":"?")+"$")).test(_3c4)&&(!this.required||!this._isEmpty(_3c4))&&(this._isEmpty(_3c4)||this.parse(_3c4,_3c5)!==undefined);},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0;},isValid:function(){return this.validator(this.textbox.value,this.constraints);},_isEmpty:function(_3c6){return (this.trim?/^\s*$/:/^$/).test(_3c6);},getErrorMessage:function(){return (this.required&&this._isEmpty(this.textbox.value))?this.missingMessage:this.invalidMessage;},getPromptMessage:function(){return this.promptMessage;},_maskValidSubsetError:true,validate:function(_3c7){var _3c8="";var _3c9=this.disabled||this.isValid(_3c7);if(_3c9){this._maskValidSubsetError=true;}var _3ca=this._isEmpty(this.textbox.value);var _3cb=!_3c9&&_3c7&&this._isValidSubset();this._set("state",_3c9?"":(((((!this._hasBeenBlurred||_3c7)&&_3ca)||_3cb)&&this._maskValidSubsetError)?"Incomplete":"Error"));this.focusNode.setAttribute("aria-invalid",_3c9?"false":"true");if(this.state=="Error"){this._maskValidSubsetError=_3c7&&_3cb;_3c8=this.getErrorMessage(_3c7);}else{if(this.state=="Incomplete"){_3c8=this.getPromptMessage(_3c7);this._maskValidSubsetError=!this._hasBeenBlurred||_3c7;}else{if(_3ca){_3c8=this.getPromptMessage(_3c7);}}}this.set("message",_3c8);return _3c9;},displayMessage:function(_3cc){if(_3cc&&this.focused){_3c2.show(_3cc,this.domNode,this.tooltipPosition,!this.isLeftToRight());}else{_3c2.hide(this.domNode);}},_refreshState:function(){this.validate(this.focused);this.inherited(arguments);},constructor:function(){this.constraints={};},_setConstraintsAttr:function(_3cd){if(!_3cd.locale&&this.lang){_3cd.locale=this.lang;}this._set("constraints",_3cd);this._computePartialRE();},_computePartialRE:function(){var p=this.regExpGen(this.constraints);this.regExp=p;var _3ce="";if(p!=".*"){this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){switch(re.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":_3ce+=re;break;case ")":_3ce+="|$)";break;default:_3ce+="(?:"+re+"|$)";break;}});}try{"".search(_3ce);}catch(e){_3ce=this.regExp;console.warn("RegExp error in "+this.declaredClass+": "+this.regExp);}this._partialre="^(?:"+_3ce+")$";},postMixInProperties:function(){this.inherited(arguments);this.messages=i18n.getLocalization("dijit.form","validate",this.lang);if(this.invalidMessage=="$_unset_$"){this.invalidMessage=this.messages.invalidMessage;}if(!this.invalidMessage){this.invalidMessage=this.promptMessage;}if(this.missingMessage=="$_unset_$"){this.missingMessage=this.messages.missingMessage;}if(!this.missingMessage){this.missingMessage=this.invalidMessage;}this._setConstraintsAttr(this.constraints);},_setDisabledAttr:function(_3cf){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(_3d0){this._set("required",_3d0);this.focusNode.setAttribute("aria-required",_3d0);this._refreshState();},_setMessageAttr:function(_3d1){this._set("message",_3d1);this.displayMessage(_3d1);},reset:function(){this._maskValidSubsetError=true;this.inherited(arguments);},_onBlur:function(){this.displayMessage("");this.inherited(arguments);}});});},"dojo/data/util/filter":function(){define(["dojo/_base/lang"],function(lang){var _3d2=lang.getObject("dojo.data.util.filter",true);_3d2.patternToRegExp=function(_3d3,_3d4){var rxp="^";var c=null;for(var i=0;i<_3d3.length;i++){c=_3d3.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_3d3.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_3d4){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _3d2;});},"dijit/form/FilteringSelect":function(){define("dijit/form/FilteringSelect",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","./MappedTextBox","./ComboBoxMixin"],function(_3d5,_3d6,_3d7,lang,_3d8,_3d9){return _3d6("dijit.form.FilteringSelect",[_3d8,_3d9],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_3da,_3db,_3dc,_3dd){if((_3db&&_3db[this.searchAttr]!==this._lastQuery)||(!_3db&&_3da.length&&this.store.getIdentity(_3da[0])!=this._lastQuery)){return;}if(!_3da.length){this.set("value","",_3dd||(_3dd===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_3da[0],_3dd);}},_openResultList:function(_3de,_3df,_3e0){if(_3df[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(_3e1,_3e2,_3e3,item){if(!this._onChangeActive){_3e2=null;}if(item===undefined){if(_3e1===null||_3e1===""){_3e1="";if(!lang.isString(_3e3)){this._setDisplayedValueAttr(_3e3||"",_3e2);return;}}var self=this;this._lastQuery=_3e1;_3d7.when(this.store.get(_3e1),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_3e2);});}else{this.valueNode.value=_3e1;this.inherited(arguments);}},_setItemAttr:function(item,_3e4,_3e5){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(_3e6,_3e7){if(_3e6==null){_3e6="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_3e7=false;}if(this.store){this.closeDropDown();var _3e8=lang.clone(this.query);var qs=this._getDisplayQueryString(_3e6),q;if(this.store._oldAPI){q=qs;}else{q=_3d5.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_3e8[this.searchAttr]=q;this.textbox.value=_3e6;this._lastDisplayedValue=_3e6;this._set("displayedValue",_3e6);var _3e9=this;var _3ea={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_3ea,this.fetchProperties);this._fetchHandle=this.store.query(_3e8,_3ea);_3d7.when(this._fetchHandle,function(_3eb){_3e9._fetchHandle=null;_3e9._callbackSetLabel(_3eb||[],_3e8,_3ea,_3e7);},function(err){_3e9._fetchHandle=null;if(!_3e9._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dojo/data/util/sorter":function(){define(["dojo/_base/lang"],function(lang){var _3ec=lang.getObject("dojo.data.util.sorter",true);_3ec.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_3ec.createSortFunction=function(_3ed,_3ee){var _3ef=[];function _3f0(attr,dir,comp,s){return function(_3f1,_3f2){var a=s.getValue(_3f1,attr);var b=s.getValue(_3f2,attr);return dir*comp(a,b);};};var _3f3;var map=_3ee.comparatorMap;var bc=_3ec.basicComparator;for(var i=0;i<_3ed.length;i++){_3f3=_3ed[i];var attr=_3f3.attribute;if(attr){var dir=(_3f3.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_3ef.push(_3f0(attr,dir,comp,_3ee));}}return function(rowA,rowB){var i=0;while(i<_3ef.length){var ret=_3ef[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _3ec;});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_3f4,_3f5){var _3f6=lang.getObject("dojo.colors",true);var _3f7=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_3f4.fromRgb=function(_3f8,obj){var m=_3f8.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_3f5.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _3f4.fromArray(a,obj);}return _3f4.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_3f7(m1,m2,H+1/3)*256,_3f7(m1,m2,H)*256,_3f7(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _3f4.fromArray(a,obj);}}return null;};var _3f9=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_3f4.prototype.sanitize=function(){var t=this;t.r=Math.round(_3f9(t.r,0,255));t.g=Math.round(_3f9(t.g,0,255));t.b=Math.round(_3f9(t.b,0,255));t.a=_3f9(t.a,0,1);return this;};_3f6.makeGrey=_3f4.makeGrey=function(g,a){return _3f4.fromArray([g,g,g,a]);};lang.mixin(_3f4.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _3f4;});},"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\" role=\"presentation\"\r\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\r\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\r\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\r\n\t\t\t><div class=\"dijitArrowButtonInner\"\r\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/></div\r\n\t\t></div\r\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\r\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\r\n\t\t\t><div class=\"dijitArrowButtonInner\"\r\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/></div\r\n\t\t></div\r\n\t></div\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\r\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\r\n\t/></div\r\n></div>\r\n","dijit/_editor/range":function(){define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window",".."],function(_3fa,_3fb,lang,win,_3fc){_3fc.range={};_3fc.range.getIndex=function(node,_3fd){var ret=[],retR=[];var _3fe=node;var _3ff,n;while(node!=_3fd){var i=0;_3ff=node.parentNode;while((n=_3ff.childNodes[i++])){if(n===node){--i;break;}}ret.unshift(i);retR.unshift(i-_3ff.childNodes.length);node=_3ff;}if(ret.length>0&&_3fe.nodeType==3){n=_3fe.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=_3fe.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};_3fc.range.getNode=function(_400,_401){if(!lang.isArray(_400)||_400.length==0){return _401;}var node=_401;_3fa.every(_400,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;return false;}return true;});return node;};_3fc.range.getCommonAncestor=function(n1,n2,root){root=root||n1.ownerDocument.body;var _402=function(n){var as=[];while(n){as.unshift(n);if(n!==root){n=n.parentNode;}else{break;}}return as;};var n1as=_402(n1);var n2as=_402(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};_3fc.range.getAncestor=function(node,_403,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(_403.test(name)){return node;}node=node.parentNode;}return null;};_3fc.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;_3fc.range.getBlockAncestor=function(node,_404,root){root=root||node.ownerDocument.body;_404=_404||_3fc.range.BlockTagNames;var _405=null,_406;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!_405&&_404.test(name)){_405=node;}if(!_406&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_406=node;}node=node.parentNode;}return {blockNode:_405,blockContainer:_406||node.ownerDocument.body};};_3fc.range.atBeginningOfContainer=function(_407,node,_408){var _409=false;var _40a=(_408==0);if(!_40a&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(0,_408))){_40a=true;}}if(_40a){var _40b=node;_409=true;while(_40b&&_40b!==_407){if(_40b.previousSibling){_409=false;break;}_40b=_40b.parentNode;}}return _409;};_3fc.range.atEndOfContainer=function(_40c,node,_40d){var _40e=false;var _40f=(_40d==(node.length||node.childNodes.length));if(!_40f&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(_40d))){_40f=true;}}if(_40f){var _410=node;_40e=true;while(_410&&_410!==_40c){if(_410.nextSibling){_40e=false;break;}_410=_410.parentNode;}}return _40e;};_3fc.range.adjacentNoneTextNode=function(_411,next){var node=_411;var len=(0-_411.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};_3fc.range._w3c=Boolean(window["getSelection"]);_3fc.range.create=function(_412){if(_3fc.range._w3c){return (_412||win.global).document.createRange();}else{return new _3fc.range.W3CRange;}};_3fc.range.getSelection=function(win,_413){if(_3fc.range._w3c){return win.getSelection();}else{var s=new _3fc.range.ie.selection(win);if(!_413){s._getCurrentSelection();}return s;}};if(!_3fc.range._w3c){_3fc.range.ie={cachedSelection:{},selection:function(win){this._ranges=[];this.addRange=function(r,_414){this._ranges.push(r);if(!_414){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _415=function(){var r=win.document.selection.createRange();var type=win.document.selection.type.toUpperCase();if(type=="CONTROL"){return new _3fc.range.W3CRange(_3fc.range.ie.decomposeControlRange(r));}else{return new _3fc.range.W3CRange(_3fc.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_415();if(r){this.addRange(r,true);this.isCollapsed=r.collapsed;}else{this.isCollapsed=true;}};},decomposeControlRange:function(_416){var _417=_416.item(0),_418=_416.item(_416.length-1);var _419=_417.parentNode,_41a=_418.parentNode;var _41b=_3fc.range.getIndex(_417,_419).o[0];var _41c=_3fc.range.getIndex(_418,_41a).o[0]+1;return [_419,_41b,_41a,_41c];},getEndPoint:function(_41d,end){var _41e=_41d.duplicate();_41e.collapse(!end);var _41f="EndTo"+(end?"End":"Start");var _420=_41e.parentElement();var _421,_422,_423;if(_420.childNodes.length>0){_3fa.every(_420.childNodes,function(node,i){var _424;if(node.nodeType!=3){_41e.moveToElementText(node);if(_41e.compareEndPoints(_41f,_41d)>0){if(_423&&_423.nodeType==3){_421=_423;_424=true;}else{_421=_420;_422=i;return false;}}else{if(i==_420.childNodes.length-1){_421=_420;_422=_420.childNodes.length;return false;}}}else{if(i==_420.childNodes.length-1){_421=node;_424=true;}}if(_424&&_421){var _425=_3fc.range.adjacentNoneTextNode(_421)[0];if(_425){_421=_425.nextSibling;}else{_421=_420.firstChild;}var _426=_3fc.range.adjacentNoneTextNode(_421);_425=_426[0];var _427=_426[1];if(_425){_41e.moveToElementText(_425);_41e.collapse(false);}else{_41e.moveToElementText(_420);}_41e.setEndPoint(_41f,_41d);_422=_41e.text.length-_427;return false;}_423=node;return true;});}else{_421=_420;_422=0;}if(!end&&_421.nodeType==1&&_422==_421.childNodes.length){var _428=_421.nextSibling;if(_428&&_428.nodeType==3){_421=_428;_422=0;}}return [_421,_422];},setEndPoint:function(_429,_42a,_42b){var _42c=_429.duplicate(),node,len;if(_42a.nodeType!=3){if(_42b>0){node=_42a.childNodes[_42b-1];if(node){if(node.nodeType==3){_42a=node;_42b=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_42a=node.nextSibling;_42b=0;}else{_42c.moveToElementText(node.nextSibling?node:_42a);var _42d=node.parentNode;var _42e=_42d.insertBefore(node.ownerDocument.createTextNode(" "),node.nextSibling);_42c.collapse(false);_42d.removeChild(_42e);}}}}else{_42c.moveToElementText(_42a);_42c.collapse(true);}}if(_42a.nodeType==3){var _42f=_3fc.range.adjacentNoneTextNode(_42a);var _430=_42f[0];len=_42f[1];if(_430){_42c.moveToElementText(_430);_42c.collapse(false);if(_430.contentEditable!="inherit"){len++;}}else{_42c.moveToElementText(_42a.parentNode);_42c.collapse(true);}_42b+=len;if(_42b>0){if(_42c.move("character",_42b)!=_42b){console.error("Error when moving!");}}}return _42c;},decomposeTextRange:function(_431){var _432=_3fc.range.ie.getEndPoint(_431);var _433=_432[0],_434=_432[1];var _435=_432[0],_436=_432[1];if(_431.htmlText.length){if(_431.htmlText==_431.text){_436=_434+_431.text.length;}else{_432=_3fc.range.ie.getEndPoint(_431,true);_435=_432[0],_436=_432[1];}}return [_433,_434,_435,_436];},setRange:function(_437,_438,_439,_43a,_43b,_43c){var _43d=_3fc.range.ie.setEndPoint(_437,_438,_439);_437.setEndPoint("StartToStart",_43d);if(!_43c){var end=_3fc.range.ie.setEndPoint(_437,_43a,_43b);}_437.setEndPoint("EndToEnd",end||_43d);return _437;}};_3fb("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=_3fc.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_43e){_43e=parseInt(_43e);if(this.startContainer===node&&this.startOffset==_43e){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_43e;if(!this.endContainer){this.setEnd(node,_43e);}else{this._updateInternal();}},setEnd:function(node,_43f){_43f=parseInt(_43f);if(this.endContainer===node&&this.endOffset==_43f){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_43f;if(!this.startContainer){this.setStart(node,_43f);}else{this._updateInternal();}},setStartAfter:function(node,_440){this._setPoint("setStart",node,_440,1);},setStartBefore:function(node,_441){this._setPoint("setStart",node,_441,0);},setEndAfter:function(node,_442){this._setPoint("setEnd",node,_442,1);},setEndBefore:function(node,_443){this._setPoint("setEnd",node,_443,0);},_setPoint:function(what,node,_444,ext){var _445=_3fc.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,_445.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();_3fc.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var s=this.startContainer,r=this._getIERange();if(s.nodeType===3&&!this.startOffset){this.setStartBefore(s);}r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new _3fc.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}return _3fc.range;});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(_446,lang,_447){var util=lang.getObject("dojo.store.util",true);util.QueryResults=function(_448){if(!_448){return _448;}if(_448.then){_448=lang.delegate(_448);}function _449(_44a){if(!_448[_44a]){_448[_44a]=function(){var args=arguments;return _447.when(_448,function(_44b){Array.prototype.unshift.call(args,_44b);return util.QueryResults(_446[_44a].apply(_446,args));});};}};_449("forEach");_449("filter");_449("map");if(!_448.total){_448.total=_447.when(_448,function(_44c){return _44c.length;});}return _448;};return util.QueryResults;});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/window"],function(_44d,_44e){return _44d("dijit.form._ListBase",null,{selected:null,_getTarget:function(evt){var tgt=evt.target;var _44f=this.containerNode;if(tgt==_44f||tgt==this.domNode){return null;}while(tgt&&tgt.parentNode!=_44f){tgt=tgt.parentNode;}return tgt;},selectFirstNode:function(){var _450=this.containerNode.firstChild;while(_450&&_450.style.display=="none"){_450=_450.nextSibling;}this._setSelectedAttr(_450);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _451=this._getSelectedAttr();if(!_451){this.selectFirstNode();}else{var next=_451.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _452=this._getSelectedAttr();if(!_452){this.selectLastNode();}else{var prev=_452.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _453=this._getSelectedAttr();if(_453){this.onDeselect(_453);this.selected=null;}if(node&&node.parentNode==this.containerNode){this.selected=node;_44e.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}},_getSelectedAttr:function(){var v=this.selected;return (v&&v.parentNode==this.containerNode)?v:(this.selected=null);}});});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_454,_455){dojo.DeferredList=function(list,_456,_457,_458,_459){var _45a=[];_454.call(this);var self=this;if(list.length===0&&!_456){this.resolve([0,[]]);}var _45b=0;_455.forEach(list,function(item,i){item.then(function(_45c){if(_456){self.resolve([i,_45c]);}else{_45d(true,_45c);}},function(_45e){if(_457){self.reject(_45e);}else{_45d(false,_45e);}if(_458){return null;}throw _45e;});function _45d(_45f,_460){_45a[i]=[_45f,_460];_45b++;if(_45b===list.length){self.resolve(_45a);}};});};dojo.DeferredList.prototype=new _454();dojo.DeferredList.prototype.gatherResults=function(_461){var d=new dojo.DeferredList(_461,false,true,false);d.addCallback(function(_462){var ret=[];_455.forEach(_462,function(_463){ret.push(_463[1]);});return ret;});return d;};return dojo.DeferredList;});},"dijit/CalendarLite":function(){require({cache:{"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\r\n\t<thead>\r\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\r\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\r\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\r\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\r\n\t\t\t</th>\r\n\t\t\t<th class='dijitReset' colspan=\"5\">\r\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\r\n\t\t\t\t</div>\r\n\t\t\t</th>\r\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\r\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\r\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\r\n\t\t\t</th>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t${!dayCellsHtml}\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\r\n\t\t\t${!dateRowsHtml}\r\n\t</tbody>\r\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\r\n\t\t<tr>\r\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\r\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\r\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\r\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\r\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\r\n\t\t\t\t</div>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</tfoot>\r\n</table>\r\n"}});define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/dom","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/_base/sniff","dojo/string","dojo/_base/window","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html"],function(_464,_465,_466,date,_467,dom,_468,_469,lang,has,_46a,win,_46b,_46c,_46d){var _46e=_465("dijit.CalendarLite",[_46b,_46c],{templateString:_46d,dowTemplateString:"<th class=\"dijitReset dijitCalendarDayLabelTemplate\" role=\"columnheader\"><span class=\"dijitCalendarDayLabel\">${d}</span></th>",dateTemplateString:"<td class=\"dijitReset\" role=\"gridcell\" data-dojo-attach-point=\"dateCells\"><span class=\"dijitCalendarDateLabel\" data-dojo-attach-point=\"dateLabels\"></span></td>",weekTemplateString:"<tr class=\"dijitReset dijitCalendarWeekTemplate\" role=\"row\">${d}${d}${d}${d}${d}${d}${d}</tr>",value:new Date(""),datePackage:date,dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",_isValidDate:function(_46f){return _46f&&!isNaN(_46f)&&typeof _46f=="object"&&_46f.toString()!=this.constructor.prototype.value.toString();},_getValueAttr:function(){if(this.value&&!isNaN(this.value)){var _470=new this.dateClassObj(this.value);_470.setHours(0,0,0,0);if(_470.getDate()<this.value.getDate()){_470=this.dateFuncObj.add(_470,"hour",1);}return _470;}else{return null;}},_setValueAttr:function(_471,_472){if(_471){_471=new this.dateClassObj(_471);}if(this._isValidDate(_471)){if(!this._isValidDate(this.value)||this.dateFuncObj.compare(_471,this.value)){_471.setHours(1,0,0,0);if(!this.isDisabledDate(_471,this.lang)){this._set("value",_471);this.set("currentFocus",_471);if(_472||typeof _472=="undefined"){this.onChange(this.get("value"));}}}}else{this._set("value",null);this.set("currentFocus",this.currentFocus);}},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(win.doc.createTextNode(text));},_populateGrid:function(){var _473=new this.dateClassObj(this.currentFocus);_473.setDate(1);var _474=_473.getDay(),_475=this.dateFuncObj.getDaysInMonth(_473),_476=this.dateFuncObj.getDaysInMonth(this.dateFuncObj.add(_473,"month",-1)),_477=new this.dateClassObj(),_478=_466.getFirstDayOfWeek(this.lang);if(_478>_474){_478-=7;}this._date2cell={};_464.forEach(this.dateCells,function(_479,idx){var i=idx+_478;var date=new this.dateClassObj(_473),_47a,_47b="dijitCalendar",adj=0;if(i<_474){_47a=_476-_474+i+1;adj=-1;_47b+="Previous";}else{if(i>=(_474+_475)){_47a=i-_474-_475+1;adj=1;_47b+="Next";}else{_47a=i-_474+1;_47b+="Current";}}if(adj){date=this.dateFuncObj.add(date,"month",adj);}date.setDate(_47a);if(!this.dateFuncObj.compare(date,_477,"date")){_47b="dijitCalendarCurrentDate "+_47b;}if(this._isSelectedDate(date,this.lang)){_47b="dijitCalendarSelectedDate "+_47b;_479.setAttribute("aria-selected",true);}else{_479.setAttribute("aria-selected",false);}if(this.isDisabledDate(date,this.lang)){_47b="dijitCalendarDisabledDate "+_47b;_479.setAttribute("aria-disabled",true);}else{_47b="dijitCalendarEnabledDate "+_47b;_479.removeAttribute("aria-disabled");}var _47c=this.getClassForDate(date,this.lang);if(_47c){_47b=_47c+" "+_47b;}_479.className=_47b+"Month dijitCalendarDateTemplate";var _47d=date.valueOf();this._date2cell[_47d]=_479;_479.dijitDateValue=_47d;this._setText(this.dateLabels[idx],date.getDateLocalized?date.getDateLocalized(this.lang):date.getDate());},this);this.monthWidget.set("month",_473);var y=_473.getFullYear()-1;var d=new this.dateClassObj();_464.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(args){this.datePackage=args.datePackage||this.datePackage;this.dateFuncObj=typeof this.datePackage=="string"?lang.getObject(this.datePackage,false):this.datePackage;this.dateClassObj=this.dateFuncObj.Date||Date;this.dateLocaleModule=lang.getObject("locale",false,this.dateFuncObj);},_createMonthWidget:function(){return _46e._MonthWidget({id:this.id+"_mw",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){var d=this.dowTemplateString,_47e=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),_47f=_466.getFirstDayOfWeek(this.lang);this.dayCellsHtml=_46a.substitute([d,d,d,d,d,d,d].join(""),{d:""},function(){return _47e[_47f++%7];});var r=_46a.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[r,r,r,r,r,r].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);dom.setSelectable(this.domNode,false);var _480=new this.dateClassObj(this.currentFocus);this._supportingWidgets.push(this.monthWidget=this._createMonthWidget());this.set("currentFocus",_480,false);var _481=lang.hitch(this,function(_482,part,_483){this.connect(this[_482],"onclick",function(){this._setCurrentFocusAttr(this.dateFuncObj.add(this.currentFocus,part,_483));});});_481("incrementMonth","month",1);_481("decrementMonth","month",-1);_481("nextYearLabelNode","year",1);_481("previousYearLabelNode","year",-1);},_setCurrentFocusAttr:function(date,_484){var _485=this.currentFocus,_486=_485&&this._date2cell?this._date2cell[_485.valueOf()]:null;date=new this.dateClassObj(date);date.setHours(1,0,0,0);this._set("currentFocus",date);this._populateGrid();var _487=this._date2cell[date.valueOf()];_487.setAttribute("tabIndex",this.tabIndex);if(this.focused||_484){_487.focus();}if(_486&&_486!=_487){if(has("webkit")){_486.setAttribute("tabIndex","-1");}else{_486.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onDayClick:function(evt){_469.stop(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!_468.contains(node,"dijitCalendarDisabledDate")){this.set("value",node.dijitDateValue);}},onChange:function(){},_isSelectedDate:function(_488){return this._isValidDate(this.value)&&!this.dateFuncObj.compare(_488,this.value,"date");},isDisabledDate:function(){},getClassForDate:function(){}});_46e._MonthWidget=_465("dijit.CalendarLite._MonthWidget",_46b,{_setMonthAttr:function(_489){var _48a=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_489),_48b=(has("ie")==6?"":"<div class='dijitSpacer'>"+_464.map(_48a,function(s){return "<div>"+s+"</div>";}).join("")+"</div>");this.domNode.innerHTML=_48b+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_48a[_489.getMonth()]+"</div>";}});return _46e;});},"dojo/io/iframe":function(){define(["../main","require"],function(dojo,_48c){dojo.getObject("io",true,dojo);dojo.io.iframe={create:function(_48d,_48e,uri){if(window[_48d]){return window[_48d];}if(window.frames[_48d]){return window.frames[_48d];}var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||_48c.toUrl("../resources/blank.html"));}var _48f=dojo.place("<iframe id=\""+_48d+"\" name=\""+_48d+"\" src=\""+turi+"\" onload=\""+_48e+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",dojo.body());window[_48d]=_48f;return _48f;},setSrc:function(_490,src,_491){try{if(!_491){if(dojo.isWebKit){_490.location=src;}else{frames[_490.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit){idoc=_490.contentWindow.document;}else{idoc=_490.contentWindow;}if(!idoc){_490.location=src;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_492){return _492.contentDocument||(((_492.name)&&(_492.document)&&(dojo.doc.getElementsByTagName("iframe")[_492.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_492.name].contentWindow.document)))||((_492.name)&&(dojo.doc.frames[_492.name])&&(dojo.doc.frames[_492.name].document))||null;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _493=null;try{var _494=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _495=_494.handleAs;_493=ifd;if(_495!="html"){if(_495=="xml"){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _496=(dii._frame.contentWindow.document).documentElement.innerText;_496=_496.replace(/>\s+</g,"><");_496=dojo.trim(_496);var _497={responseText:_496};_493=dojo._contentHandlers["xml"](_497);}}else{_493=ifd.getElementsByTagName("textarea")[0].value;if(_495=="json"){_493=dojo.fromJson(_493);}else{if(_495=="javascript"){_493=dojo.eval(_493);}}}}}catch(e){_493=e;}finally{_494._callNext();}return _493;},function(_498,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _498;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _499=dfd.ioArgs;var args=_499.args;_499._contentToClean=[];var fn=dojo.byId(args["form"]);var _49a=args["content"]||{};if(fn){if(_49a){var _49b=function(name,_49c){dojo.create("input",{type:"hidden",name:name,value:_49c},fn);_499._contentToClean.push(name);};for(var x in _49a){var val=_49a[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_49b(x,val[i]);}}else{if(!fn[x]){_49b(x,val);}else{fn[x].value=val;}}}}var _49d=fn.getAttributeNode("action");var _49e=fn.getAttributeNode("method");var _49f=fn.getAttributeNode("target");if(args["url"]){_499._originalAction=_49d?_49d.value:null;if(_49d){_49d.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_49e||!_49e.value){if(_49e){_49e.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_499._originalTarget=_49f?_49f.value:null;if(_49f){_49f.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _4a0=args.url+(args.url.indexOf("?")>-1?"&":"?")+_499.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_4a0,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _4a1=dfd.ioArgs;var args=_4a1.args;var _4a2=dojo.byId(args.form);if(_4a2){var _4a3=_4a1._contentToClean;for(var i=0;i<_4a3.length;i++){var key=_4a3[i];for(var j=0;j<_4a2.childNodes.length;j++){var _4a4=_4a2.childNodes[j];if(_4a4.name==key){dojo.destroy(_4a4);break;}}}if(_4a1["_originalAction"]){_4a2.setAttribute("action",_4a1._originalAction);}if(_4a1["_originalTarget"]){_4a2.setAttribute("target",_4a1._originalTarget);_4a2.target=_4a1._originalTarget;}}_4a1._finished=true;}};return dojo.io.iframe;});},"dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_4a5,_4a6,_4a7,_4a8,keys,_4a9,_4aa,_4ab,_4ac){return _4a5("dijit.form._ComboBoxMenu",[_4a9,_4aa,_4ac,_4ab],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_4a6.add(this.previousButton,"dijitMenuItemRtl");_4a6.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){return _4a7.create("div",{"class":"dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl"),role:"option"});},onHover:function(node){_4a6.add(node,"dijitMenuItemHover");},onUnhover:function(node){_4a6.remove(node,"dijitMenuItemHover");},onSelect:function(node){_4a6.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_4a6.remove(node,"dijitMenuItemSelected");},_page:function(up){var _4ad=0;var _4ae=this.domNode.scrollTop;var _4af=_4a8.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_4ad<_4af){var _4b0=this.getHighlightedOption();if(up){if(!_4b0.previousSibling||_4b0.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_4b0.nextSibling||_4b0.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _4b1=this.domNode.scrollTop;_4ad+=(_4b1-_4ae)*(up?-1:1);_4ae=_4b1;}},handleKey:function(evt){switch(evt.charOrCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"dijit/form/_DateTimeTextBox":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\r\n\tid=\"widget_${id}\"\r\n\trole=\"combobox\"\r\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\r\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\r\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/></div\r\n\t><div class='dijitReset dijitValidationContainer'\r\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\r\n\t/></div\r\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\r\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\r\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\r\n\t/></div\r\n></div>\r\n"}});define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(date,_4b2,_4b3,_4b4,lang,_4b5,_4b6,_4b7){new Date("X");var _4b8=_4b4("dijit.form._DateTimeTextBox",[_4b5,_4b6],{templateString:_4b7,hasDownArrow:true,openOnClick:true,regExpGen:_4b2.regexp,datePackage:date,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},compare:function(val1,val2){var _4b9=this._isInvalidDate(val1);var _4ba=this._isInvalidDate(val2);return _4b9?(_4ba?0:-1):(_4ba?1:date.compare(val1,val2,this._selector));},forceWidth:true,format:function(_4bb,_4bc){if(!_4bb){return "";}return this.dateLocaleModule.format(_4bb,_4bc);},"parse":function(_4bd,_4be){return this.dateLocaleModule.parse(_4bd,_4be)||(this._isEmpty(_4bd)?null:undefined);},serialize:function(val,_4bf){if(val.toGregorian){val=val.toGregorian();}return _4b3.toISOString(val,_4bf);},dropDownDefaultValue:new Date(),value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(args){this.datePackage=args.datePackage||this.datePackage;this.dateFuncObj=typeof this.datePackage=="string"?lang.getObject(this.datePackage,false):this.datePackage;this.dateClassObj=this.dateFuncObj.Date||Date;this.dateLocaleModule=lang.getObject("locale",false,this.dateFuncObj);this.regExpGen=this.dateLocaleModule.regexp;this._invalidDate=this.constructor.prototype.value.toString();},buildRendering:function(){this.inherited(arguments);if(!this.hasDownArrow){this._buttonNode.style.display="none";}if(this.openOnClick||!this.hasDownArrow){this._buttonNode=this.domNode;this.baseClass+=" dijitComboBoxOpenOnClick";}},_setConstraintsAttr:function(_4c0){_4c0.selector=this._selector;_4c0.fullYear=true;var _4c1=_4b3.fromISOString;if(typeof _4c0.min=="string"){_4c0.min=_4c1(_4c0.min);}if(typeof _4c0.max=="string"){_4c0.max=_4c1(_4c0.max);}this.inherited(arguments);},_isInvalidDate:function(_4c2){return !_4c2||isNaN(_4c2)||typeof _4c2!="object"||_4c2.toString()==this._invalidDate;},_setValueAttr:function(_4c3,_4c4,_4c5){if(_4c3!==undefined){if(typeof _4c3=="string"){_4c3=_4b3.fromISOString(_4c3);}if(this._isInvalidDate(_4c3)){_4c3=null;}if(_4c3 instanceof Date&&!(this.dateClassObj instanceof Date)){_4c3=new this.dateClassObj(_4c3);}}this.inherited(arguments);if(this.value instanceof Date){this.filterString="";}if(this.dropDown){this.dropDown.set("value",_4c3,false);}},_set:function(attr,_4c6){if(attr=="value"&&this.value instanceof Date&&this.compare(_4c6,this.value)==0){return;}this.inherited(arguments);},_setDropDownDefaultValueAttr:function(val){if(this._isInvalidDate(val)){val=new this.dateClassObj();}this.dropDownDefaultValue=val;},openDropDown:function(_4c7){if(this.dropDown){this.dropDown.destroy();}var _4c8=lang.isString(this.popupClass)?lang.getObject(this.popupClass,false):this.popupClass,_4c9=this,_4ca=this.get("value");this.dropDown=new _4c8({onChange:function(_4cb){_4c9.set("value",_4cb,true);},id:this.id+"_popup",dir:_4c9.dir,lang:_4c9.lang,value:_4ca,currentFocus:!this._isInvalidDate(_4ca)?_4ca:this.dropDownDefaultValue,constraints:_4c9.constraints,filterString:_4c9.filterString,datePackage:_4c9.datePackage,isDisabledDate:function(date){return !_4c9.rangeCheck(date,_4c9.constraints);}});this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(_4cc,_4cd){this._setValueAttr(this.parse(_4cc,this.constraints),_4cd,_4cc);}});return _4b8;});},"dijit/Calendar":function(){define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/_base/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton","./hccss"],function(_4ce,date,_4cf,_4d0,_4d1,_4d2,_4d3,_4d4,keys,lang,has,_4d5,_4d6,_4d7,_4d8,_4d9){var _4da=_4d0("dijit.Calendar",[_4d5,_4d6,_4d7],{cssStateNodes:{"decrementMonth":"dijitCalendarArrow","incrementMonth":"dijitCalendarArrow","previousYearLabelNode":"dijitCalendarPreviousYear","nextYearLabelNode":"dijitCalendarNextYear"},setValue:function(_4db){_4d4.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",_4db);},_createMonthWidget:function(){return new _4da._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:lang.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){this.inherited(arguments);this.connect(this.domNode,"onkeypress","_onKeyPress");this.connect(this.dateRowsNode,"onmouseover","_onDayMouseOver");this.connect(this.dateRowsNode,"onmouseout","_onDayMouseOut");this.connect(this.dateRowsNode,"onmousedown","_onDayMouseDown");this.connect(this.dateRowsNode,"onmouseup","_onDayMouseUp");},_onMonthSelect:function(_4dc){this._setCurrentFocusAttr(this.dateFuncObj.add(this.currentFocus,"month",_4dc-this.currentFocus.getMonth()));},_onDayMouseOver:function(evt){var node=_4d2.contains(evt.target,"dijitCalendarDateLabel")?evt.target.parentNode:evt.target;if(node&&((node.dijitDateValue&&!_4d2.contains(node,"dijitCalendarDisabledDate"))||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){_4d2.add(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}if(evt.relatedTarget&&evt.relatedTarget.parentNode==this._currentNode){return;}var cls="dijitCalendarHoveredDate";if(_4d2.contains(this._currentNode,"dijitCalendarActiveDate")){cls+=" dijitCalendarActiveDate";}_4d2.remove(this._currentNode,cls);this._currentNode=null;},_onDayMouseDown:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue&&!_4d2.contains(node,"dijitCalendarDisabledDate")){_4d2.add(node,"dijitCalendarActiveDate");this._currentNode=node;}},_onDayMouseUp:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue){_4d2.remove(node,"dijitCalendarActiveDate");}},handleKey:function(evt){var _4dd=-1,_4de,_4df=this.currentFocus;switch(evt.charOrCode){case keys.RIGHT_ARROW:_4dd=1;case keys.LEFT_ARROW:_4de="day";if(!this.isLeftToRight()){_4dd*=-1;}break;case keys.DOWN_ARROW:_4dd=1;case keys.UP_ARROW:_4de="week";break;case keys.PAGE_DOWN:_4dd=1;case keys.PAGE_UP:_4de=evt.ctrlKey||evt.altKey?"year":"month";break;case keys.END:_4df=this.dateFuncObj.add(_4df,"month",1);_4de="day";case keys.HOME:_4df=new this.dateClassObj(_4df);_4df.setDate(1);break;case keys.ENTER:case " ":this.set("value",this.currentFocus);break;default:return true;}if(_4de){_4df=this.dateFuncObj.add(_4df,_4de,_4dd);}this._setCurrentFocusAttr(_4df);return false;},_onKeyPress:function(evt){if(!this.handleKey(evt)){_4d3.stop(evt);}},onValueSelected:function(){},onChange:function(_4e0){this.onValueSelected(_4e0);},getClassForDate:function(){}});_4da._MonthDropDownButton=_4d0("dijit.Calendar._MonthDropDownButton",_4d9,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new _4da._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect});},_setMonthAttr:function(_4e1){var _4e2=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_4e1);this.dropDown.set("months",_4e2);this.containerNode.innerHTML=(has("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_4e2[_4e1.getMonth()]+"</div>";}});_4da._MonthDropDown=_4d0("dijit.Calendar._MonthDropDown",[_4d6,_4d8],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' "+"data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(_4e3){this.domNode.innerHTML=_4ce.map(_4e3,function(_4e4,idx){return _4e4?"<div class='dijitCalendarMonthLabel' month='"+idx+"'>"+_4e4+"</div>":"";}).join("");},_onClick:function(evt){this.onChange(_4d1.get(evt.target,"month"));},onChange:function(){},_onMenuHover:function(evt){_4d2.toggle(evt.target,"dijitCalendarMonthLabelHover",evt.type=="mouseover");}});return _4da;});},"dijit/_editor/selection":function(){define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window",".."],function(dom,lang,has,win,_4e5){lang.getObject("_editor.selection",true,_4e5);lang.mixin(_4e5._editor.selection,{getType:function(){if(has("ie")<9){return win.doc.selection.type.toLowerCase();}else{var _4e6="text";var oSel;try{oSel=win.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _4e7=oSel.getRangeAt(0);if((_4e7.startContainer==_4e7.endContainer)&&((_4e7.endOffset-_4e7.startOffset)==1)&&(_4e7.startContainer.nodeType!=3)){_4e6="control";}}return _4e6;}},getSelectedText:function(){if(has("ie")<9){if(_4e5._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().text;}else{var _4e8=win.global.getSelection();if(_4e8){return _4e8.toString();}}return "";},getSelectedHtml:function(){if(has("ie")<9){if(_4e5._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().htmlText;}else{var _4e9=win.global.getSelection();if(_4e9&&_4e9.rangeCount){var i;var html="";for(i=0;i<_4e9.rangeCount;i++){var frag=_4e9.getRangeAt(i).cloneContents();var div=win.doc.createElement("div");div.appendChild(frag);html+=div.innerHTML;}return html;}return null;}},getSelectedElement:function(){if(_4e5._editor.selection.getType()=="control"){if(has("ie")<9){var _4ea=win.doc.selection.createRange();if(_4ea&&_4ea.item){return win.doc.selection.createRange().item(0);}}else{var _4eb=win.global.getSelection();return _4eb.anchorNode.childNodes[_4eb.anchorOffset];}}return null;},getParentElement:function(){if(_4e5._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(has("ie")<9){var r=win.doc.selection.createRange();r.collapse(true);return r.parentElement();}else{var _4ec=win.global.getSelection();if(_4ec){var node=_4ec.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}}return null;},hasAncestorElement:function(_4ed){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_4ee){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _4ef=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _4f0=String(tags[i]).toLowerCase();if(_4ef==_4f0){return _4f0;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_4f1){if(window.getSelection){var _4f2=win.global.getSelection();if(_4f2.removeAllRanges){if(_4f1){_4f2.collapseToStart();}else{_4f2.collapseToEnd();}}else{_4f2.collapse(_4f1);}}else{if(has("ie")){var _4f3=win.doc.selection.createRange();_4f3.collapse(_4f1);_4f3.select();}}},remove:function(){var sel=win.doc.selection;if(has("ie")<9){if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}else{sel=win.global.getSelection();sel.deleteFromDocument();return sel;}},selectElementChildren:function(_4f4,_4f5){var _4f6=win.global;var doc=win.doc;var _4f7;_4f4=dom.byId(_4f4);if(doc.selection&&has("ie")<9&&win.body().createTextRange){_4f7=_4f4.ownerDocument.body.createTextRange();_4f7.moveToElementText(_4f4);if(!_4f5){try{_4f7.select();}catch(e){}}}else{if(_4f6.getSelection){var _4f8=win.global.getSelection();if(has("opera")){if(_4f8.rangeCount){_4f7=_4f8.getRangeAt(0);}else{_4f7=doc.createRange();}_4f7.setStart(_4f4,0);_4f7.setEnd(_4f4,(_4f4.nodeType==3)?_4f4.length:_4f4.childNodes.length);_4f8.addRange(_4f7);}else{_4f8.selectAllChildren(_4f4);}}}},selectElement:function(_4f9,_4fa){var _4fb;var doc=win.doc;var _4fc=win.global;_4f9=dom.byId(_4f9);if(has("ie")<9&&win.body().createTextRange){try{var tg=_4f9.tagName?_4f9.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){_4fb=win.body().createControlRange();}else{_4fb=win.body().createRange();}_4fb.addElement(_4f9);if(!_4fa){_4fb.select();}}catch(e){this.selectElementChildren(_4f9,_4fa);}}else{if(_4fc.getSelection){var _4fd=_4fc.getSelection();_4fb=doc.createRange();if(_4fd.removeAllRanges){if(has("opera")){if(_4fd.getRangeAt(0)){_4fb=_4fd.getRangeAt(0);}}_4fb.selectNode(_4f9);_4fd.removeAllRanges();_4fd.addRange(_4fb);}}}},inSelection:function(node){if(node){var _4fe;var doc=win.doc;var _4ff;if(win.global.getSelection){var sel=win.global.getSelection();if(sel&&sel.rangeCount>0){_4ff=sel.getRangeAt(0);}if(_4ff&&_4ff.compareBoundaryPoints&&doc.createRange){try{_4fe=doc.createRange();_4fe.setStart(node,0);if(_4ff.compareBoundaryPoints(_4ff.START_TO_END,_4fe)===1){return true;}}catch(e){}}}else{if(doc.selection){_4ff=doc.selection.createRange();try{_4fe=node.ownerDocument.body.createControlRange();if(_4fe){_4fe.addElement(node);}}catch(e1){try{_4fe=node.ownerDocument.body.createTextRange();_4fe.moveToElementText(node);}catch(e2){}}if(_4ff&&_4fe){if(_4ff.compareEndPoints("EndToStart",_4fe)===1){return true;}}}}}return false;}});return _4e5._editor.selection;});},"dijit/form/nls/ComboBox":function(){define("dijit/form/nls/ComboBox",{root:({previousMessage:"Previous choices",nextMessage:"More choices"}),"zh":true,"zh-tw":true,"tr":true,"th":true,"sv":true,"sl":true,"sk":true,"ru":true,"ro":true,"pt":true,"pt-pt":true,"pl":true,"nl":true,"nb":true,"ko":true,"kk":true,"ja":true,"it":true,"hu":true,"hr":true,"he":true,"fr":true,"fi":true,"es":true,"el":true,"de":true,"da":true,"cs":true,"ca":true,"az":true,"ar":true});},"esri/layers/FeatureLayer":function(){define(["dijit","dojo","dojox","dojo/require!esri/layers/graphics,esri/tasks/query,dojo/io/iframe,esri/layers/agscommon,dojo/date/locale"],function(_500,dojo,_501){dojo.provide("esri.layers.FeatureLayer");dojo.require("esri.layers.graphics");dojo.require("esri.tasks.query");dojo.require("dojo.io.iframe");dojo.require("esri.layers.agscommon");dojo.require("dojo.date.locale");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_502){this._outFields=_502&&_502.outFields;this._loadCallback=_502&&_502.loadCallback;var _503=_502&&_502._usePatch;this._usePatch=(_503===null||_503===undefined)?true:_503;this._trackIdField=_502&&_502.trackIdField;this.objectIdField=_502&&_502.objectIdField;this._maxOffset=_502&&_502.maxAllowableOffset;this._optEditable=_502&&_502.editable;this._optAutoGen=_502&&_502.autoGeneralize;this.editSummaryCallback=_502&&_502.editSummaryCallback;this.userId=_502&&_502.userId;this.userIsAdmin=_502&&_502.userIsAdmin;this.useMapTime=(_502&&_502.hasOwnProperty("useMapTime"))?(!!_502.useMapTime):true;this.source=_502&&_502.source;this.gdbVersion=_502&&_502.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(esri._isDefined(_502&&_502.mode)?_502.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_502&&_502.tileWidth)||512;this._tileHeight=(_502&&_502.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);var _504=_502&&_502.latticeTiling;this.latticeTiling=_504;break;case ctor.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);this._editable=false;if(dojo.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new esri.tasks.QueryTask(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _505=this._url.path;this._fserver=false;if(_505.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _506=_502&&_502.resourceInfo;if(_506){this._initLayer(_506);}else{if(this.source){var _507={source:this.source.toJson()};this._url.query=dojo.mixin(this._url.query,{layer:dojo.toJson(_507)});}if(this.gdbVersion){this._url.query=dojo.mixin(this._url.query,{gdbVersion:this.gdbVersion});}esri.request({url:_505,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_508,io){if(_508||io){this._json=_508;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_508&&_508._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_508.featureSet;this._nextId=_508.nextObjectId;_508=_508.layerDefinition;}if(_508.hasOwnProperty("capabilities")){var _509=(this.capabilities=_508.capabilities);if(_509&&_509.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_508.geometryType==="esriGeometryPolyline")||(_508.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=esri._isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _50a=_508.effectiveMinScale||_508.minScale,_50b=_508.effectiveMaxScale||_508.maxScale;if(!this._hasMin&&_50a){this.setMinScale(_50a);}if(!this._hasMax&&_50b){this.setMaxScale(_50b);}this.layerId=_508.id;this.name=_508.name;this.description=_508.description;this.copyright=_508.copyrightText;this.type=_508.type;this.geometryType=_508.geometryType;this.displayField=_508.displayField;this.defaultDefinitionExpression=_508.definitionExpression;this.fullExtent=new esri.geometry.Extent(_508.extent);this.defaultVisibility=_508.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_508.indexedFields;this.maxRecordCount=_508.maxRecordCount;this.canModifyLayer=_508.canModifyLayer;this.supportsStatistics=_508.supportsStatistics;this.supportsAdvancedQueries=_508.supportsAdvancedQueries;this.hasLabels=_508.hasLabels;this.canScaleSymbols=_508.canScaleSymbols;this.supportsRollbackOnFailure=_508.supportsRollbackOnFailure;this.syncCanReturnChanges=_508.syncCanReturnChanges;this.isDataVersioned=_508.isDataVersioned;this.editFieldsInfo=_508.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_508.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_508.relationships;this.allowGeometryUpdates=esri._isDefined(_508.allowGeometryUpdates)?_508.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _50c=(this.fields=[]),_50d=_508.fields,i;for(i=0;i<_50d.length;i++){_50c.push(new esri.layers.Field(_50d[i]));}if(!this.objectIdField){this.objectIdField=_508.objectIdField;if(!this.objectIdField){_50d=_508.fields;for(i=0;i<_50d.length;i++){var _50e=_50d[i];if(_50e.type==="esriFieldTypeOID"){this.objectIdField=_50e.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _50f=this.objectIdField,_510=-1;if(this._collection&&_50f){var fset=this._featureSet,_511=fset&&fset.features,il=_511?_511.length:0,oid,attr;for(i=0;i<il;i++){attr=_511[i].attributes;oid=attr&&attr[_50f];if(oid>_510){_510=oid;}}}this._nextId=(_510+1);}this.globalIdField=_508.globalIdField;var _512=(this.typeIdField=_508.typeIdField),_513;if(_512){_513=!this._getField(_512)&&this._getField(_512,true);if(_513){this.typeIdField=_513.name;}}this.visibilityField=_508.visibilityField;var _514=_508.defaultSymbol;if(_514){this.defaultSymbol=esri.symbol.fromJson(_514);}var _515=this.types=[],_516=_508.types,_517,_518,_519,_51a=this.editFieldsInfo,_51b=_51a&&_51a.creatorField,_51c=_51a&&_51a.editorField,fix=(_51b||_51c),_51d=[];if(_516){for(i=0;i<_516.length;i++){_517=new esri.layers.FeatureType(_516[i]);_518=_517.templates;if(fix&&_518&&_518.length){_51d=_51d.concat(_518);}_515.push(_517);}}var _51e=_508.templates,_51f,_520=this.templates=[];if(_51e){for(i=0;i<_51e.length;i++){_51f=new esri.layers.FeatureTemplate(_51e[i]);if(fix){_51d.push(_51f);}_520.push(_51f);}}for(i=0;i<_51d.length;i++){_519=dojo.getObject("prototype.attributes",false,_51d[i]);if(_519){if(_51b){delete _519[_51b];}if(_51c){delete _519[_51c];}}}var _521=_508.timeInfo;if(_521){this.timeInfo=new esri.layers.TimeInfo(_521);this._startTimeField=_521.startTimeField;this._endTimeField=_521.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_521.trackIdField=this._trackIdField;}else{this._trackIdField=_521.trackIdField;}}this.hasAttachments=(!this._collection&&_508.hasAttachments)?true:false;this.htmlPopupType=_508.htmlPopupType;var _522=_508.drawingInfo,_523;if(!this.renderer){if(_522&&_522.renderer){_523=_522.renderer;this.setRenderer(esri.renderer.fromJson(_523));if(_523.type==="classBreaks"){this.renderer._setMaxInclusiveness(true);}if(!this._collection){var _524=_523.type,_525=[];_523=this.renderer;switch(_524){case "simple":_525.push(_523.symbol);break;case "uniqueValue":case "classBreaks":_525.push(_523.defaultSymbol);_525=_525.concat(dojo.map(_523.infos,function(info){return info.symbol;}));break;}_525=dojo.filter(_525,esri._isDefined);var _526=this._url.path+"/images/",_527=this._getToken();dojo.forEach(_525,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_526+url;}if(_527&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_527);}}});}}else{if(_514){_516=this.types;if(_516.length>0){_523=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_516,function(type){_523.addValue(type.id,type.symbol);});}else{_523=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_523);}else{if(!this._isTable){var _528;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_528=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_528=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_528=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_528?new esri.renderer.SimpleRenderer(_528):null);}}}}var _529=(_522&&_522.transparency)||0;if(!esri._isDefined(this.opacity)&&_529>0){this.opacity=1-(_529/100);}this.version=_508.currentVersion;if(!this.version){var ver;if("capabilities" in _508||"drawingInfo" in _508||"hasAttachments" in _508||"htmlPopupType" in _508||"relationships" in _508||"timeInfo" in _508||"typeIdField" in _508||"types" in _508){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();if(this._collection){this._fireUpdateStart();var _52a=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_52a));this._fcAdded=true;}this.onLoad(this);var _52b=this._loadCallback;if(_52b){delete this._loadCallback;_52b(this);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _52c=this.renderer;if(_52c){this._ager=(_52c.declaredClass.indexOf("TemporalRenderer")!==-1&&_52c.observationAger&&_52c.observationRenderer);var _52d=dojo.filter([_52c,_52c.observationRenderer,_52c.latestObservationRenderer,_52c.trackRenderer],esri._isDefined);var _52e=[];dojo.forEach(_52d,function(rnd){_52e.push(rnd.attributeField);_52e.push(rnd.attributeField2);_52e.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_52e,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map,_52f){this._map=map;this._toggleTime(true);var div=this.inherited("_setMap",arguments);this.clearSelection();var _530=this.renderer;if(this.timeInfo){if(this._trackIdField||(_530&&(_530.latestObservationRenderer||_530.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._updateMaxOffset);this._updateMaxOffset();var mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map,_531){var mode=this._mode;if(mode){mode.destroy();this._mode=null;}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_532){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_532;return this;}var _533=this._editable;this._editable=_532;this._updateCaps();if(_533!==_532){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_534){var _535={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _535;}var _536=_534&&_534.feature,_537=_534&&_534.userId,caps=dojo.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),dojo.trim),_538=dojo.indexOf(caps,"editing")>-1,_539=_538&&(dojo.indexOf(caps,"create")>-1),_53a=_538&&(dojo.indexOf(caps,"update")>-1),_53b=_538&&(dojo.indexOf(caps,"delete")>-1),_53c=this.ownershipBasedAccessControlForFeatures,_53d=this.editFieldsInfo,_53e=_53d&&_53d.creatorField,_53f=_53d&&_53d.realm,_540=_536&&_536.attributes,_541=(_540&&_53e)?_540[_53e]:undefined,_542,_543=!!this.userIsAdmin,_544=!_53c||_543||!!(_53c.allowOthersToUpdate||_53c.allowUpdateToOthers),_545=!_53c||_543||!!(_53c.allowOthersToDelete||_53c.allowDeleteToOthers);if(_543||(_538&&!(_539||_53a||_53b))){_539=_53a=_53b=true;}_542={"canCreate":_539,"canUpdate":_53a,"canDelete":_53b};if(_541===null){_542.canUpdate=_53a&&_544;_542.canDelete=_53b&&_545;}else{if(_541===""){return _542;}else{if(_541){_537=_537||this.getUserId();if(_537&&_53f){_537=_537+"@"+_53f;}if(_537.toLowerCase()===_541.toLowerCase()){return _542;}else{_542.canUpdate=_53a&&_544;_542.canDelete=_53b&&_545;}}}}return _542;},getUserId:function(){var _546;if(this.loaded){_546=(this.credential&&this.credential.userId)||this.userId||"";}return _546;},setUserIsAdmin:function(_547){this.userIsAdmin=_547;},setEditSummaryCallback:function(_548){this.editSummaryCallback=_548;},getEditSummary:function(_549,_54a,_54b){_54b=esri._isDefined(_54b)?_54b:(new Date()).getTime();var _54c="",info=this.getEditInfo(_549,_54a,_54b),_54d=(_54a&&_54a.callback)||this.editSummaryCallback;if(_54d){info=_54d(_549,info)||"";}if(dojo.isString(info)){_54c=info;}else{if(info){var _54e=info.action,_54f=info.userId,_550=info.timeValue,_551=0;if(_54e){_551++;}if(_54f){_551++;}if(esri._isDefined(_550)){_551++;}if(_551>1){_54c=(_54e==="edit"?"edit":"create")+(_54f?"User":"")+(esri._isDefined(_550)?info.displayPattern:"");}}_54c=_54c&&esri.substitute(info,esri.bundle.layers.FeatureLayer[_54c]);}return _54c;},getEditInfo:function(_552,_553,_554){if(!this.loaded){return;}_554=esri._isDefined(_554)?_554:(new Date()).getTime();var _555=(_553&&_553.action)||"last",_556=this.editFieldsInfo,_557=_556&&_556.creatorField,_558=_556&&_556.creationDateField,_559=_556&&_556.editorField,_55a=_556&&_556.editDateField,_55b=_556&&_556.realm,_55c=_552&&_552.attributes,_55d=(_55c&&_557)?_55c[_557]:undefined,_55e=(_55c&&_558)?_55c[_558]:null,_55f=(_55c&&_559)?_55c[_559]:undefined,_560=(_55c&&_55a)?_55c[_55a]:null,_561=this._getEditData(_55d,_55e,_554),_562=this._getEditData(_55f,_560,_554),_563;switch(_555){case "creation":_563=_561;break;case "edit":_563=_562;break;case "last":_563=_562||_561;break;}if(_563){_563.action=(_563===_562)?"edit":"creation";}return _563;},_getEditData:function(_564,_565,_566){var data,_567,_568,_569=60000,_56a=3600000,_56b=2*_56a,_56c=24*_56a,_56d=7*_56c;if(esri._isDefined(_565)){_567=_566-_565;if(_567<0){_568="Full";}else{if(_567<_569){_568="Seconds";}else{if(_567<(2*_569)){_568="Minute";}else{if(_567<_56a){_568="Minutes";}else{if(_567<_56b){_568="Hour";}else{if(_567<_56c){_568="Hours";}else{if(_567<_56d){_568="WeekDay";}else{_568="Full";}}}}}}}}if((_564!==undefined)||_568){data=data||{};data.userId=_564;if(_568){var _56e=dojo.date.locale.format,_56f=new Date(_565);data.minutes=Math.floor(_567/_569);data.hours=Math.floor(_567/_56a);data.weekDay=_56e(_56f,{datePattern:"EEEE",selector:"date"});data.formattedDate=_56e(_56f,{selector:"date"});data.formattedTime=_56e(_56f,{selector:"time"});data.displayPattern=_568;data.timeValue=_565;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_570){if(!this.isEditable()){this._maxOffset=_570;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_571){if(!this.loaded){this._optAutoGen=_571;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_571;if(_571){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_572){if(!this._collection&&(_572!==this.gdbVersion)&&(_572||this.gdbVersion)){this.gdbVersion=_572;this._task.gdbVersion=_572;this._url.query=dojo.mixin(this._url.query,{gdbVersion:_572});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_573){if(this._isSnapshot){this._timeDefn=_573;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_574,_575){this._timeOffset=_574;this._timeOffsetUnits=_575;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_576,_577,_578,_579){_577=_577||this.constructor.SELECTION_NEW;var _57a=this._getShallowClone(_576),map=this._map,_57b,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_57a.outFields=this._getOutFields();_57a.returnGeometry=true;if(map){_57a.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_57a)){_57b={features:[]};this._selectHandler(_57b,_577,_578,_579,dfd);return dfd;}var _57c=this._canDoClientSideQuery(_57a);if(_57c){_57b={features:this._doQuery(_57a,_57c)};this._selectHandler(_57b,_577,_578,_579,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_579,dfd,true);return dfd;}var self=this;if(this._ts){_57a._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_57a);temp.addCallbacks(function(_57d){self._selectHandler(_57d,_577,_578,_579,dfd);},function(err){self._resolve([err],null,_579,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _57e=this._selectedFeatures,_57f=[],item;for(item in _57e){if(_57e.hasOwnProperty(item)){_57f.push(_57e[item]);}}return _57f;},clearSelection:function(_580){var _581=this._selectedFeatures,mode=this._mode,item;for(item in _581){if(_581.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_580){this.onSelectionClear();}return this;},setSelectionSymbol:function(_582){this._selectionSymbol=_582;if(_582){var _583=this._selectedFeatures,item;for(item in _583){if(_583.hasOwnProperty(item)){_583[item].setSymbol(_582);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_584,_585,_586,_587,_588){var _589=_588.assembly,dfd=_588.dfd;this._applyNormalized(adds,_589&&_589[0]);this._applyNormalized(_584,_589&&_589[1]);this.onBeforeApplyEdits(adds,_584,_585);var i,_58a={},_58b=this.objectIdField,_58c={f:"json"},_58d=false;if(this._collection){var _58e={};_58e.addResults=adds?dojo.map(adds,function(){_58d=true;return {objectId:this._nextId++,success:true};},this):null;_58e.updateResults=_584?dojo.map(_584,function(_58f){_58d=true;var oid=_58f.attributes[_58b];_58a[oid]=_58f;return {objectId:oid,success:true};},this):null;_58e.deleteResults=_585?dojo.map(_585,function(_590){_58d=true;return {objectId:_590.attributes[_58b],success:true};},this):null;if(_58d){this._editHandler(_58e,adds,_58a,_586,_587,dfd);}return;}if(adds&&adds.length>0){_58c.adds=this._convertFeaturesToJson(adds,0,1);_58d=true;}if(_584&&_584.length>0){for(i=0;i<_584.length;i++){var _591=_584[i];_58a[_591.attributes[_58b]]=_591;}_58c.updates=this._convertFeaturesToJson(_584,0,0,1);_58d=true;}if(_585&&_585.length>0){var ids=[];for(i=0;i<_585.length;i++){ids.push(_585[i].attributes[_58b]);}_58c.deletes=ids.join(",");_58d=true;}if(_58d){var self=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_58c,this._url.query),callbackParamName:"callback",load:function(_592){self._editHandler(_592,adds,_58a,_586,_587,dfd);},error:function(err){self._resolve([err],null,_587,dfd,true);}},{usePost:true});}},queryFeatures:function(_593,_594,_595){return this._query("execute","onQueryFeaturesComplete",_593,_594,_595);},queryRelatedFeatures:function(_596,_597,_598){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_596,_597,_598);},queryIds:function(_599,_59a,_59b){return this._query("executeForIds","onQueryIdsComplete",_599,_59a,_59b);},queryCount:function(_59c,_59d,_59e){return this._query("executeForCount","onQueryCountComplete",_59c,_59d,_59e);},queryAttachmentInfos:function(_59f,_5a0,_5a1){var url=this._url.path+"/"+_59f+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_5a2){var _5a3=_5a2.attachmentInfos,_5a4;dojo.forEach(_5a3,function(info){_5a4=dojo.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_5a4?("?"+_5a4):"");info.objectId=_59f;});self._resolve([_5a3],"onQueryAttachmentInfosComplete",_5a0,dfd);},error:function(err){self._resolve([err],null,_5a1,dfd,true);}});return dfd;},addAttachment:function(_5a5,_5a6,_5a7,_5a8){return this._sendAttachment("add",_5a5,_5a6,_5a7,_5a8);},updateAttachment:function(_5a9,_5aa,_5ab,_5ac,_5ad){_5ab.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_5aa}));return this._sendAttachment("update",_5a9,_5ab,_5ac,_5ad);},deleteAttachments:function(_5ae,_5af,_5b0,_5b1){var url=this._url.path+"/"+_5ae+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_5b2={f:"json",attachmentIds:_5af.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_5b2,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_5b3){var _5b4=_5b3.deleteAttachmentResults;_5b4=dojo.map(_5b4,function(_5b5){var res=new esri.layers.FeatureEditResult(_5b5);res.attachmentId=res.objectId;res.objectId=_5ae;return res;});self._resolve([_5b4],"onDeleteAttachmentsComplete",_5b0,dfd);}),error:function(err){self._resolve([err],null,_5b1,dfd,true);}},{usePost:true});return dfd;},addType:function(_5b6){var _5b7=this.types;if(_5b7){var _5b8=dojo.some(_5b7,function(type){if(type.id==_5b6.id){return true;}return false;});if(_5b8){return false;}else{_5b7.push(_5b6);}}else{this.types=[_5b6];}this._typesDirty=true;return true;},deleteType:function(_5b9){if(!this._collection){return;}var _5ba=this.types;if(_5ba){var _5bb=-1;dojo.some(_5ba,function(type,_5bc){if(type.id==_5b9){_5bb=_5bc;return true;}return false;});if(_5bb>-1){this._typesDirty=true;return _5ba.splice(_5bb,1)[0];}}},toJson:function(){var _5bd=this._json,json=dojo.isString(_5bd)?dojo.fromJson(_5bd):dojo.clone(_5bd);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _5be=json.layerDefinition,_5bf=this._collection;if(_5bf&&this._typesDirty){_5be.types=dojo.map(this.types||[],function(type){return type.toJson();});var _5c0=this.renderer,_5c1=_5be.drawingInfo;if(_5c1&&_5c0&&_5c0.declaredClass.indexOf("TemporalRenderer")===-1){_5c1.renderer=_5c0.toJson();}}var _5c2=null;if(!(_5bf&&!this._fcAdded)){_5c2={geometryType:_5be.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=dojo.mixin({},json.featureSet||{},_5c2);if(_5bf){json.nextObjectId=this._nextId;_5be.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_updateCaps:function(){var _5c3=this._editable,_5c4=dojo.trim(this.capabilities||""),_5c5=dojo.map((_5c4?_5c4.split(","):[]),dojo.trim),caps=dojo.map((_5c4?_5c4.toLowerCase().split(","):[]),dojo.trim),_5c6=dojo.indexOf(caps,"editing"),cap,i,_5c7,_5c8={"Create":dojo.indexOf(caps,"create"),"Update":dojo.indexOf(caps,"update"),"Delete":dojo.indexOf(caps,"delete")};if(_5c3&&_5c6===-1){_5c5.push("Editing");}else{if(!_5c3&&_5c6>-1){_5c7=[_5c6];for(cap in _5c8){if(_5c8[cap]>-1){_5c7.push(_5c8[cap]);}}_5c7.sort();for(i=_5c7.length-1;i>=0;i--){_5c5.splice(_5c7[i],1);}}}this.capabilities=_5c5.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode;if(mode){mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_5c9){var map=this._map;if(_5c9&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_5ca){this._mapTimeExtent=_5ca;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_5cb){var _5cc=this._timeOffset,_5cd=this._timeOffsetUnits;return (_5cb&&_5cc&&_5cd)?_5cb.offset(-1*_5cc,_5cd):_5cb;},_getTimeOverlap:function(_5ce,_5cf){if(_5ce&&_5cf){return _5ce.intersection(_5cf);}else{return _5ce||_5cf;}},_getTimeFilter:function(_5d0){var _5d1=this.getTimeDefinition(),_5d2=null,_5d3;if(_5d1||_5d2){_5d3=this._getTimeOverlap(_5d1,_5d2);if(!_5d3){return [false];}}if(_5d0){_5d0=_5d3?this._getTimeOverlap(_5d0,_5d3):_5d0;if(!_5d0){return [false];}}else{_5d0=_5d3;}return [true,_5d0];},_getAttributeFilter:function(_5d4){var _5d5=this.getDefinitionExpression();if(_5d4){_5d4=_5d5?"("+_5d5+") AND ("+_5d4+")":_5d4;}else{_5d4=_5d5;}return _5d4;},_applyQueryFilters:function(_5d6){_5d6.where=this._getAttributeFilter(_5d6.where);_5d6.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _5d7=this._getTimeFilter(_5d6.timeExtent);if(!_5d7[0]){return false;}else{_5d6.timeExtent=_5d7[1];}}return true;},_add:function(_5d8){var _5d9=this._selectionSymbol,attr=_5d8.attributes,_5da=this.visibilityField;if(_5d9&&this._isSelOnly){_5d8.setSymbol(_5d9);}if(_5da&&attr&&attr.hasOwnProperty(_5da)){_5d8[attr[_5da]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_5db){var _5dc=[],map=this._map;if(this._isTable||!map){return;}if(_5db.text||(_5db.where&&_5db.where!==this.getDefinitionExpression())){return;}var _5dd=this._isSnapshot,_5de=this._isSelOnly;var _5df=_5db.geometry;if(_5df){if(!_5de&&_5db.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_5df.type==="extent"&&(_5dd||map.extent.contains(_5df)))){_5dc.push(1);}else{return;}}var ids=_5db.objectIds;if(ids){if(_5dd){_5dc.push(2);}else{var len=ids.length,mode=this._mode,_5e0=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_5e0++;}}if(_5e0===len){_5dc.push(2);}else{return;}}}if(this.timeInfo){var _5e1=_5db.timeExtent,_5e2=this._mapTimeExtent;if(_5dd){if(_5e1){_5dc.push(3);}}else{if(_5de){if(_5e1){return;}}else{if(_5e2){if(dojo.indexOf(_5dc,2)!==-1){if(_5e1){_5dc.push(3);}}else{return;}}else{if(_5dc.length>0){if(_5e1){_5dc.push(3);}}else{if(_5e1){return;}}}}}}return _5dc.length>0?_5dc:null;},_doQuery:function(_5e3,_5e4,_5e5){var _5e6=[],mode=this._mode,_5e7=this.objectIdField,i,len,_5e8;if(dojo.indexOf(_5e4,2)!==-1){_5e6=[];var ids=_5e3.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_5e6.push(obj);}}if(_5e6.length===0){return [];}}if(dojo.indexOf(_5e4,1)!==-1){_5e8=_5e6.length>0?_5e6:this.graphics;len=_5e8.length;var _5e9=_5e3.geometry._normalize(null,true);_5e6=[];for(i=0;i<len;i++){var _5ea=_5e8[i],_5eb=_5ea.geometry;if(_5eb){if(this.normalization&&_5e9.length){if(_5e9[0].intersects(_5eb)||_5e9[1].intersects(_5eb)){_5e6.push(_5ea);}}else{if(_5e9.intersects(_5eb)){_5e6.push(_5ea);}}}}if(_5e6.length===0){return [];}}if(dojo.indexOf(_5e4,3)!==-1){if(this.timeInfo){_5e8=_5e6.length>0?_5e6:this.graphics;var time=_5e3.timeExtent,_5ec=this._filterByTime(_5e8,time.startTime,time.endTime);_5e6=_5ec.match;}}if(_5e5){return dojo.map(_5e6,function(obj){return obj.attributes[_5e7];},this);}else{return _5e6;}},_filterByTime:function(_5ed,_5ee,_5ef){var _5f0=this._startTimeField,_5f1=this._endTimeField,_5f2;if(!this._twoTimeFields){_5f2=_5f0||_5f1;}var _5f3=esri._isDefined,yea=[],nay=[],i,len=_5ed.length,_5f4,_5f5;_5ee=_5ee?_5ee.getTime():-Infinity;_5ef=_5ef?_5ef.getTime():Infinity;if(_5f2){for(i=0;i<len;i++){_5f4=_5ed[i];_5f5=_5f4.attributes;var time=_5f5[_5f2];if(time>=_5ee&&time<=_5ef){yea.push(_5f4);}else{nay.push(_5f4);}}}else{for(i=0;i<len;i++){_5f4=_5ed[i];_5f5=_5f4.attributes;var _5f6=_5f5[_5f0],end=_5f5[_5f1];_5f6=_5f3(_5f6)?_5f6:-Infinity;end=_5f3(end)?end:Infinity;if((_5f6>=_5ee&&_5f6<=_5ef)||(end>=_5ee&&end<=_5ef)||(_5ee>=_5f6&&_5ef<=end)){yea.push(_5f4);}else{nay.push(_5f4);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_5f7,_5f8,dfd,_5f9){if(_5f7){this[_5f7].apply(this,args);}if(_5f8){_5f8.apply(null,args);}if(dfd){esri._resDfd(dfd,args,_5f9);}},_getShallowClone:function(_5fa){var _5fb=new esri.tasks.Query(),prop;for(prop in _5fa){if(_5fa.hasOwnProperty(prop)){_5fb[prop]=_5fa[prop];}}return _5fb;},_query:function(type,_5fc,_5fd,_5fe,_5ff){var that=this,dfd=new dojo.Deferred(esri._dfdCanceller);var _600=function(_601,_602){if(!_602&&type==="execute"&&!that._isTable){var _603=_601.features,mode=that._mode,_604=that.objectIdField,il=_603.length,i;for(i=il-1;i>=0;i--){var oid=_603[i].attributes[_604];var _605=mode._getFeature(oid);if(_605){_603.splice(i,1,_605);}}}that._resolve([_601],_5fc,_5fe,dfd);};if(type!=="executeRelationshipQuery"){_5fd=this._getShallowClone(_5fd);_5fd.outFields=this._getOutFields();_5fd.returnGeometry=true;var map=this._map,_606;if(map){_5fd.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_5fd)){switch(type){case "execute":_606=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_606=[];break;case "executeForCount":_606=0;break;}_600(_606,true);return dfd;}var _607=this._canDoClientSideQuery(_5fd);if(_607){var _608=this._doQuery(_5fd,_607,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_606=new esri.tasks.FeatureSet();_606.features=_608;break;case "executeForIds":_606=_608;break;case "executeForCount":_606=_608.length;break;}_600(_606,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_5ff,dfd,true);return dfd;}if(this._ts){_5fd._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_5fd);temp.addCallbacks(_600,function(err){that._resolve([err],null,_5ff,dfd,true);});return dfd;},_convertFeaturesToJson:function(_609,_60a,_60b,_60c){var json=[],_60d=this._selectionSymbol,_60e=this.visibilityField,i,_60f,_610=this.objectIdField;if(this.loaded&&(_60b||_60c)){_60f=dojo.filter(this.fields,function(_611){return (_611.editable===false)&&(!_60c||(_611.name!==_610));});}for(i=0;i<_609.length;i++){var _612=_609[i],_613={},_614=_612.geometry,attr=_612.attributes,_615=_612.symbol;if(_614&&(!_60c||!this.loaded||this.allowGeometryUpdates)){_613.geometry=_614.toJson();}if(_60e){_613.attributes=attr=dojo.mixin({},attr);attr[_60e]=_612.visible?1:0;}else{if(attr){_613.attributes=dojo.mixin({},attr);}}if(_613.attributes&&_60f&&_60f.length){dojo.forEach(_60f,function(_616){delete _613.attributes[_616.name];});}if(_615&&(_615!==_60d)){_613.symbol=_615.toJson();}json.push(_613);}return _60a?json:dojo.toJson(json);},_selectHandler:function(_617,_618,_619,_61a,dfd){var _61b,ctor=this.constructor;switch(_618){case ctor.SELECTION_NEW:this.clearSelection(true);_61b=true;break;case ctor.SELECTION_ADD:_61b=true;break;case ctor.SELECTION_SUBTRACT:_61b=false;break;}var i,_61c=_617.features,mode=this._mode,_61d=[],_61e=this.objectIdField,_61f,oid;if(_61b){for(i=0;i<_61c.length;i++){_61f=_61c[i];oid=_61f.attributes[_61e];var _620=mode._addFeatureIIf(oid,_61f);_61d.push(_620);this._selectFeatureIIf(oid,_620,mode);}}else{for(i=0;i<_61c.length;i++){_61f=_61c[i];oid=_61f.attributes[_61e];this._unSelectFeatureIIf(oid,mode);var _621=mode._removeFeatureIIf(oid);_61d.push(_621||_61f);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_61d,_618,_617.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_619,dfd);if(_617.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_622,mode){var _623=this._selectedFeatures,_624=_623[oid];if(!_624){mode._incRefCount(oid);_623[oid]=_622;if(!this._isTable){this._setSelectSymbol(_622);}}return _624||_622;},_unSelectFeatureIIf:function(oid,mode){var _625=this._selectedFeatures[oid];if(_625){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_625);}}return _625;},_isSelected:function(_626){},_setSelectSymbol:function(_627){var _628=this._selectionSymbol;if(_628&&!this._isSelOnly){_627.setSymbol(_628);}},_setUnSelectSymbol:function(_629){var _62a=this._selectionSymbol;if(_62a&&!this._isSelOnly){if(_62a===_629.symbol){_629.setSymbol(null,true);}}},_getOutFields:function(){var _62b=dojo.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_62c,_62d,arr){return !!_62c&&(dojo.indexOf(arr,_62c)===_62d);});var _62e=dojo.clone(this._outFields);if(_62e){if(dojo.indexOf(_62e,"*")!==-1){return _62e;}dojo.forEach(_62b,function(_62f){if(dojo.indexOf(_62e,_62f)===-1){_62e.push(_62f);}});return _62e;}else{return _62b;}},_checkFields:function(_630){var _631=_630||this._getOutFields();dojo.forEach(_631,function(_632){if(_632==="*"){return;}if(!this._getField(_632)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_632},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_630&&!this._isTable&&!this._fserver&&!this._collection){var _633=dojo.some(this.fields,function(_634){return (_634&&_634.type==="esriFieldTypeGeometry")?true:false;});if(!_633){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _635=this.renderer;if(_635&&this.fields.length>0){var _636=dojo.filter([_635,_635.observationRenderer,_635.latestObservationRenderer,_635.trackRenderer],esri._isDefined);var _637=[];dojo.forEach(_636,function(rnd){var _638,_639;_639=rnd.attributeField;if(_639){_638=!this._getField(_639)&&this._getField(_639,true);if(_638){rnd.attributeField=_638.name;}}_639=rnd.attributeField2;if(_639){_638=!this._getField(_639)&&this._getField(_639,true);if(_638){rnd.attributeField2=_638.name;}}_639=rnd.attributeField3;if(_639){_638=!this._getField(_639)&&this._getField(_639,true);if(_638){rnd.attributeField3=_638.name;}}_637.push(rnd.attributeField);_637.push(rnd.attributeField2);_637.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_637,esri._isDefined);}},_getField:function(_63a,_63b){var _63c=this.fields;if(_63c.length===0){return null;}var _63d;if(_63b){_63a=_63a.toLowerCase();}dojo.some(_63c,function(_63e){var _63f=false;if(_63b){_63f=(_63e&&_63e.name.toLowerCase()===_63a)?true:false;}else{_63f=(_63e&&_63e.name===_63a)?true:false;}if(_63f){_63d=_63e;}return _63f;});return _63d;},_getDateOpts:function(){if(!this._dtOpts){var _640=dojo.map(dojo.filter(this.fields,function(_641){return !!(_641&&_641.type==="esriFieldTypeDate");}),function(_642){return _642.name;});this._dtOpts={properties:_640};}return this._dtOpts;},_applyNormalized:function(_643,_644){if(_643&&_644){dojo.forEach(_643,function(_645,_646){if(_645&&_644[_646]){_645.setGeometry(_644[_646]);}});}},_editHandler:function(_647,adds,_648,_649,_64a,dfd){var _64b=_647.addResults,_64c=_647.updateResults,_64d=_647.deleteResults,i,_64e,oid,_64f,attr,_650=this.objectIdField,mode=this._mode,_651=this._isTable;var _652=this.editFieldsInfo,_653=this._getOutFields()||[],_654=_652&&_652.creatorField,_655=_652&&_652.creationDateField,_656=_652&&_652.editorField,_657=_652&&_652.editDateField,_658=_652&&_652.realm;if(dojo.indexOf(_653,"*")===-1){if(_654&&dojo.indexOf(_653,_654)===-1){_654=null;}if(_655&&dojo.indexOf(_653,_655)===-1){_655=null;}if(_656&&dojo.indexOf(_653,_656)===-1){_656=null;}if(_657&&dojo.indexOf(_653,_657)===-1){_657=null;}}var _659=(_655||_657)?(new Date()).getTime():null,_65a=(_654||_656)?this.getUserId():undefined;if(_65a&&_658){_65a=_65a+"@"+_658;}if(_64b){for(i=0;i<_64b.length;i++){_64b[i]=new esri.layers.FeatureEditResult(_64b[i]);if(_651){continue;}_64e=_64b[i];if(_64e.success){oid=_64e.objectId;_64f=adds[i];var gl=_64f._graphicsLayer;if(gl&&gl!==this){gl.remove(_64f);}attr=_64f.attributes||{};attr[_650]=oid;if(_654){attr[_654]=_65a;}if(_656){attr[_656]=_65a;}if(_655){attr[_655]=_659;}if(_657){attr[_657]=_659;}_64f.setAttributes(attr);if(mode._init){mode.drawFeature(_64f);}}}}if(_64c){for(i=0;i<_64c.length;i++){_64c[i]=new esri.layers.FeatureEditResult(_64c[i]);if(_651){continue;}_64e=_64c[i];if(_64e.success){oid=_64e.objectId;_64f=_648[oid];var _65b=mode._getFeature(oid);if(_65b){if(_65b.geometry!==_64f.geometry){_65b.setGeometry(esri.geometry.fromJson(_64f.geometry.toJson()));}this._repaint(_65b,oid);}_64f=_65b||_64f;attr=_64f.attributes||{};if(_656){attr[_656]=_65a;}if(_657){attr[_657]=_659;}_64f.setAttributes(attr);}}}if(_64d){var _65c=[];for(i=0;i<_64d.length;i++){_64d[i]=new esri.layers.FeatureEditResult(_64d[i]);if(_651){continue;}_64e=_64d[i];if(_64e.success){oid=_64e.objectId;_64f=mode._getFeature(oid);if(_64f){if(this._unSelectFeatureIIf(oid,mode)){_65c.push(_64f);}_64f._count=0;mode._removeFeatureIIf(oid);}}}if(_65c.length>0){this.onSelectionComplete(_65c,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_64b,_64c,_64d],"onEditsComplete",_649,dfd);},_sendAttachment:function(type,_65d,_65e,_65f,_660){var _661=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_65d+"/"+_661,self=this;var dfd=esri.request({url:url,form:_65e,content:dojo.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_662){var _663=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_664=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_665=new esri.layers.FeatureEditResult(_662[_663]);_665.attachmentId=_665.objectId;_665.objectId=_65d;self._resolve([_665],_664,_65f);return _665;}).addErrback(function(_666){self._resolve([_666],null,_660,null,true);});return dfd;},_repaint:function(_667,oid,_668){oid=esri._isDefined(oid)?oid:_667.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_667.setSymbol(_667.symbol,_668);}},_getKind:function(_669){var _66a=this._trackManager;if(_66a){return _66a.isLatestObservation(_669)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _66b=json.symbol;if(_66b){this.symbol=esri.symbol.fromJson(_66b);}var _66c=json.domains,_66d,i;var _66e=this.domains={};for(_66d in _66c){if(_66c.hasOwnProperty(_66d)){var _66f=_66c[_66d];switch(_66f.type){case "range":_66e[_66d]=new esri.layers.RangeDomain(_66f);break;case "codedValue":_66e[_66d]=new esri.layers.CodedValueDomain(_66f);break;case "inherited":_66e[_66d]=new esri.layers.InheritedDomain(_66f);break;}}}var _670=json.templates;if(_670){var _671=this.templates=[];for(i=0;i<_670.length;i++){_671.push(new esri.layers.FeatureTemplate(_670[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _672,_673=this.domains,_674=this.templates,_675=esri._sanitize;if(_673){var _676=json.domains={};for(_672 in _673){if(_673.hasOwnProperty(_672)){_676[_672]=_673[_672]&&_673[_672].toJson();}}_675(_676);}if(_674){json.templates=dojo.map(_674,function(_677){return _677.toJson();});}return _675(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _678=json.prototype;this.prototype=new esri.Graphic(_678.geometry,null,_678.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_679){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _67a=this._featureMap[oid];if(_67a){_67a._count++;}},_decRefCount:function(oid){var _67b=this._featureMap[oid];if(_67b){_67b._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_67c){var fmap=this._featureMap,_67d=fmap[oid],_67e=this.featureLayer;if(!_67d){fmap[oid]=_67c;_67e._add(_67c);_67c._count=0;}return _67d||_67c;},_removeFeatureIIf:function(oid){var _67f=this._featureMap[oid],_680=this.featureLayer;if(_67f){if(_67f._count){return;}delete this._featureMap[oid];_680._remove(_67f);}return _67f;},_clearIIf:function(){var i,_681=this.featureLayer,_682=_681.graphics,_683=_681._selectedFeatures,_684=_681.objectIdField;for(i=_682.length-1;i>=0;i--){var _685=_682[i];var oid=_685.attributes[_684];if(oid in _683){_685._count=1;continue;}_685._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _686=this.featureLayer,_687=_686.graphics,_688=show?"show":"hide",i,len=_687.length;show=show&&_686._ager;for(i=0;i<len;i++){var _689=_687[i];_689[_688]();if(show){_686._repaint(_689);}}},_applyTimeFilter:function(_68a){var _68b=this.featureLayer;if(!_68b.timeInfo||_68b.suspended){return;}if(!_68a){_68b._fireUpdateStart();}var _68c=_68b._trackManager;if(_68c){_68c.clearTracks();}var defn=_68b.getTimeDefinition(),_68d=_68b._getOffsettedTE(_68b._mapTimeExtent);if(_68d){_68d=_68b._getTimeOverlap(defn,_68d);if(_68d){var _68e=_68b._filterByTime(_68b.graphics,_68d.startTime,_68d.endTime);if(_68c){_68c.addFeatures(_68e.match);}dojo.forEach(_68e.match,function(_68f){var _690=_68f._shape;if(!_68f.visible){_68f.show();_690=_68f._shape;_690&&_690._moveToFront();}if(_68b._ager&&_690){_68b._repaint(_68f);}});dojo.forEach(_68e.noMatch,function(_691){if(_691.visible){_691.hide();}});}else{this._toggleVisibility(false);}}else{if(_68c){_68c.addFeatures(_68b.graphics);}this._toggleVisibility(true);}if(_68c){_68c.moveLatestToFront();_68c.drawTracks();}if(!_68a){_68b._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_692){this.featureLayer=_692;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_693){this.featureLayer=_693;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _694=this.featureLayer;if(_694._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){this._fetchAll();}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_695){var _696=this.featureLayer,_697=_696.objectIdField,oid=_695.attributes[_697];this._addFeatureIIf(oid,_695);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _698=this.featureLayer;if(_698._collection){_698._fireUpdateStart();_698._refresh(true);_698._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_699){var id="_"+_699.name+_699.layerId+_699._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _69a=this.featureLayer;if(_69a._collection){return;}_69a._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_69b=this.featureLayer,_69c=_69b.getDefinitionExpression();var _69d=new esri.tasks.Query();_69d.outFields=_69b._getOutFields();_69d.where=_69c||"1=1";_69d.returnGeometry=true;_69d.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_69d.timeExtent=_69b.getTimeDefinition();_69d.maxAllowableOffset=_69b._maxOffset;if(_69b._ts){_69d._ts=(new Date()).getTime();}var _69e;if(_69b._usePatch){_69e=this._getRequestId(_69b);this._cancelPendingRequest(null,_69e);}_69b._task.execute(_69d,this._drawFeatures,this._queryErrorHandler,_69e);},_drawFeatures:function(_69f){this._purgeRequests();var _6a0=_69f.features,_6a1=this.featureLayer,_6a2=_6a1.objectIdField,i,len=_6a0.length,_6a3,oid;for(i=0;i<len;i++){_6a3=_6a0[i];oid=_6a3.attributes[_6a2];this._addFeatureIIf(oid,_6a3);this._incRefCount(oid);}this._applyTimeFilter(true);_6a1._fireUpdateEnd(null,_69f.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_69f.exceededTransferLimit){_6a1.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _6a4=this.featureLayer;_6a4._errorHandler(err);_6a4._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_6a5){this.featureLayer=_6a5;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_6a6){var _6a7=this._gridLayer,geom=_6a6.geometry,_6a8=[];if(!geom){return;}_6a8=_6a7.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _6a9=this._cellMap,i,cell,oid=_6a6.attributes[this.featureLayer.objectIdField],_6aa,row,col;for(i=0;i<_6a8.length;i++){cell=_6a8[i];_6aa=cell.latticeID;row=cell.row;col=cell.col;if(_6aa){cell=(_6a9[_6aa]=(_6a9[_6aa]||cell));}else{_6a9[row]=_6a9[row]||{};cell=(_6a9[row][col]=(_6a9[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_6a6);this._addFeatureIIf(oid,_6a6);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_6ab=this.featureLayer;var _6ac=_6ab._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_6ac?_6ac.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_6ab._tileWidth,height:_6ab._tileHeight},{width:map.width,height:map.height},_6ac);this._ioQueue=[];if(!_6ab.suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=dojo.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);dojo.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _6ad=this.featureLayer,map=this.map;if(_6ad.suspended){return;}_6ad._fireUpdateStart();this._clearIIf();var _6ae=_6ad._trackManager;if(_6ae){_6ae.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_6af,cell){var id="_"+_6af.name+_6af.layerId+_6af._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_6b0){this._exceeds=false;var _6b1=this.featureLayer,map=this.map,_6b2=_6b0||map.extent,_6b3=this._gridLayer.getCellsInExtent(_6b2,_6b1.latticeTiling),_6b4=_6b3.cells;if(!_6b1.isEditable()){var _6b5=this._cellMap;_6b4=dojo.filter(_6b4,function(cell){if(cell.lattice){if(_6b5[cell.latticeID]){return false;}}else{if(_6b5[cell.row]&&_6b5[cell.row][cell.col]){return false;}}return true;});}var _6b6=_6b1._getOutFields(),_6b7=_6b1.getDefinitionExpression(),time=_6b1._getOffsettedTE(_6b1._mapTimeExtent),_6b8=_6b1._usePatch,_6b9=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_6ba,_6bb;this._pending=this._pending||0;for(i=0;i<_6b4.length;i++){cell=_6b4[i];_6ba=new esri.tasks.Query();_6ba.geometry=cell.extent||cell.lattice;_6ba.outFields=_6b6;_6ba.where=_6b7;if(_6b1.latticeTiling&&cell.extent){_6ba.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;}_6ba.returnGeometry=true;_6ba.timeExtent=time;_6ba.maxAllowableOffset=_6b1._maxOffset;if(_6b1._ts){_6ba._ts=(new Date()).getTime();}_6bb=null;if(_6b8){_6bb=this._getRequestId(_6b1,cell);if(this._isPending(_6bb)){continue;}}this._pending++;_6b9.push(_6b1._task.execute(_6ba,function(){var _6bc=cell;return function(_6bd){func.apply(self,[_6bd,_6bc]);};}.call(this),this._queryErrorHandler,_6bb));}this._removeOldCells(_6b2);this._endCheck();},_drawFeatures:function(_6be,cell){this._exceeds=this._exceeds||_6be.exceededTransferLimit;this._finalizeIO();var _6bf=this.featureLayer,map=this.map,_6c0=map.extent,_6c1=cell.extent,row=cell.row,col=cell.col,_6c2=_6bf.objectIdField,_6c3=_6be.features,_6c4=this._gridLayer,_6c5=this._cellMap,i,len,_6c6=cell.latticeID,_6c7=_6c6?_6c5[_6c6]:(_6c5[row]&&_6c5[row][col]);if((cell.resolution!=_6c4._resolution)||(_6c6?(_6c6!==_6c4.getLatticeID(_6c0)):(!_6c4.intersects(_6c1,_6c0)))){if(_6c7){this._removeCell(row,col,_6c6);}}else{if(_6c7){this._updateCell(_6c7,_6c3);}else{cell.features=_6c3;if(_6c6){_6c5[_6c6]=cell;}else{_6c5[row]=_6c5[row]||{};_6c5[row][col]=cell;}len=_6c3.length;for(i=0;i<len;i++){var _6c8=_6c3[i];var oid=_6c8.attributes[_6c2];this._addFeatureIIf(oid,_6c8);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_6c9){if(this._pending===0){this._processIOQueue();var _6ca=this.featureLayer,_6cb=_6ca._trackManager;if(_6cb){_6cb.clearTracks();_6cb.addFeatures(_6ca.graphics);if(_6ca._ager){dojo.forEach(_6ca.graphics,function(_6cc){if(_6cc._shape){_6ca._repaint(_6cc);}});}_6cb.moveLatestToFront();_6cb.drawTracks();}this.featureLayer._fireUpdateEnd(_6c9&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_6ca.onQueryLimitExceeded();}}},_processIOQueue:function(_6cd){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_6cd){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_6ce){var _6cf=this._cellMap,_6d0=this._gridLayer,_6d1,_6d2;for(_6d1 in _6cf){if(_6cf[_6d1]){var row=_6cf[_6d1],_6d3=row.latticeID,_6d4=0,_6d5=0;if(_6d3){_6d4++;if(_6d3!==_6d0.getLatticeID(_6ce)){this._removeCell(null,null,_6d3);_6d5++;}}else{for(_6d2 in row){if(row[_6d2]){_6d4++;var _6d6=row[_6d2].extent;if(!_6d0.intersects(_6d6,_6ce)){this._removeCell(_6d1,_6d2);_6d5++;}}}}if(_6d5===_6d4){delete _6cf[_6d1];}}}},_updateCell:function(cell,_6d7){var _6d8=this.featureLayer,_6d9=_6d8.objectIdField,_6da=_6d8._selectedFeatures,i,len=_6d7.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _6db=_6d7[i];var oid=_6db.attributes[_6d9];var _6dc=this._addFeatureIIf(oid,_6db);if(_6dc===_6db){this._incRefCount(oid);cell.features.push(_6dc);}else{if(!(oid in _6da)){_6dc.setGeometry(_6db.geometry);_6dc.setAttributes(_6db.attributes);}}}},_removeCell:function(row,col,_6dd){var _6de=this._cellMap,_6df=this.featureLayer,_6e0=_6df.objectIdField;var cell=_6dd?_6de[_6dd]:(_6de[row]&&_6de[row][col]);if(cell){if(_6dd){delete _6de[_6dd];}else{delete _6de[row][col];}var _6e1=cell.features,i;for(i=0;i<_6e1.length;i++){var _6e2=_6e1[i];var oid=_6e2.attributes[_6e0];this._decRefCount(oid);if(oid in _6df._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_6e3,_6e4,_6e5,_6e6){this.origin=_6e3;this.cellWidth=_6e4.width;this.cellHeight=_6e4.height;this.mapWidth=_6e5.width;this.mapHeight=_6e5.height;this.srInfo=_6e6;},setResolution:function(_6e7){this._resolution=(_6e7.xmax-_6e7.xmin)/this.mapWidth;if(this.srInfo){var _6e8=Math.round((2*this.srInfo.valid[1])/this._resolution),_6e9=Math.round(_6e8/this.cellWidth);this._frameStats=[_6e9,0,_6e9-1];}},getCellCoordinates:function(_6ea){var res=this._resolution,_6eb=this.origin;return {row:Math.floor((_6eb.y-_6ea.y)/(this.cellHeight*res)),col:Math.floor((_6ea.x-_6eb.x)/(this.cellWidth*res))};},normalize:function(col){var _6ec=this._frameStats;if(_6ec){var _6ed=_6ec[0],m180=_6ec[1],p180=_6ec[2];if(col<m180){col=col%_6ed;col=col<m180?col+_6ed:col;}else{if(col>p180){col=col%_6ed;}}}return col;},intersects:function(_6ee,_6ef){var _6f0=this.srInfo;if(_6f0){return dojo.some(_6ef._getParts(_6f0),function(_6f1){return _6ee.intersects(_6f1.extent);});}else{return _6ee.intersects(_6ef);}},getCellExtent:function(row,col){var res=this._resolution,_6f2=this.origin,_6f3=this.cellWidth,_6f4=this.cellHeight;return new esri.geometry.Extent((col*_6f3*res)+_6f2.x,_6f2.y-((row+1)*_6f4*res),((col+1)*_6f3*res)+_6f2.x,_6f2.y-(row*_6f4*res),new esri.SpatialReference(_6f2.spatialReference.toJson()));},getLatticeID:function(_6f5){var _6f6=this.getCellCoordinates({x:_6f5.xmin,y:_6f5.ymax}),_6f7=this.getCellCoordinates({x:_6f5.xmax,y:_6f5.ymin}),_6f8=_6f6.row,_6f9=_6f7.row,_6fa=this.normalize(_6f6.col),_6fb=this.normalize(_6f7.col);return _6f8+"_"+_6f9+"_"+_6fa+"_"+_6fb;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_6fc,_6fd){var _6fe=this.getCellCoordinates({x:_6fc.xmin,y:_6fc.ymax}),_6ff=this.getCellCoordinates({x:_6fc.xmax,y:_6fc.ymin}),_700=_6fe.row,_701=_6ff.row,_702=_6fe.col,_703=_6ff.col,_704=[],i,j,nj,_705=[],_706=[],len,xmin,xmax,ymin,ymax,_707=[],_708,_709;for(i=_700;i<=_701;i++){for(j=_702;j<=_703;j++){nj=this.normalize(j);_6fc=this.getCellExtent(i,nj);_704.push({row:i,col:nj,extent:_6fc,resolution:this._resolution});if(_6fd){_705.push(_6fc.xmin,_6fc.xmax);_706.push(_6fc.ymin,_6fc.ymax);}}}_702=this.normalize(_702);_703=this.normalize(_703);_705.sort(this.sorter);_706.sort(this.sorter);len=_705.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_705[i]===_705[i+1]){_705.splice(i,1);}}}len=_706.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_706[i]===_706[i+1]){_706.splice(i,1);}}}if(_705.length&&_706.length){xmin=_705[0];xmax=_705[_705.length-1];ymin=_706[0];ymax=_706[_706.length-1];len=_705.length;for(i=0;i<len;i++){_707.push([[_705[i],ymax],[_705[i],ymin]]);}len=_706.length;for(i=0;i<len;i++){_707.push([[xmin,_706[i]],[xmax,_706[i]]]);}_708=new esri.geometry.Polyline({paths:_707,spatialReference:this.origin.spatialReference.toJson()});_709=_700+"_"+_701+"_"+_702+"_"+_703;_704.push({latticeID:_709,lattice:_708,resolution:this._resolution});}return {minRow:_700,maxRow:_701,minCol:_702,maxCol:_703,cells:_704};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_70a){this.layer=_70a;this.trackMap={};},initialize:function(map){this.map=map;var _70b=this.layer,_70c=_70b.renderer.trackRenderer;if(_70c&&(_70b.geometryType==="esriGeometryPoint")){var _70d=(this.container=new esri.layers._GraphicsLayer({id:_70b.id+"_tracks",_child:true}));_70d._setMap(map,_70b._div);_70d.setRenderer(_70c);}},addFeatures:function(_70e){var tkid,_70f=this.trackMap,_710=this.layer,_711=_710._trackIdField;dojo.forEach(_70e,function(_712){var _713=_712.attributes;tkid=_713[_711];var ary=(_70f[tkid]=(_70f[tkid]||[]));ary.push(_712);});var _714=_710._startTimeField,_715=_710.objectIdField;var _716=function(a,b){var _717=a.attributes[_714],_718=b.attributes[_714];if(_717===_718){return (a.attributes[_715]<b.attributes[_715])?-1:1;}else{return (_717<_718)?-1:1;}};for(tkid in _70f){_70f[tkid].sort(_716);}},drawTracks:function(){var _719=this.container;if(!_719){return;}var _71a=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_71b,_71c=this.layer._trackIdField,_71d;for(tkid in _71a){ary=_71a[tkid];path=[];for(i=ary.length-1;i>=0;i--){_71b=ary[i].geometry;if(_71b){path.push([_71b.x,_71b.y]);}}_71d={};_71d[_71c]=tkid;if(path.length>0){_719.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr}),null,_71d));}}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_71e){var _71f=_71e._shape;_71f&&_71f._moveToFront();this._repaint(_71e,null,true);},this.layer);},getLatestObservations:function(){var _720=[];if(!this.layer.renderer.latestObservationRenderer){return _720;}var _721=this.trackMap,tkid;for(tkid in _721){var ary=_721[tkid];_720.push(ary[ary.length-1]);}return _720;},clearTracks:function(){var _722=this.getLatestObservations();this.trackMap={};var _723=this.container;if(_723){_723.clear();}dojo.forEach(_722,function(_724){this._repaint(_724,null,true);},this.layer);},isLatestObservation:function(_725){var _726=this.layer._trackIdField;var _727=this.trackMap[_725.attributes[_726]];if(_727){return (_727[_727.length-1]===_725);}return false;},destroy:function(){var _728=this.container;if(_728){_728.clear();_728._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});});},"*noref":1}});require(["dojo/i18n"],function(i18n){i18n._preloadLocalizations("esri/dijit/nls/AttributeInspector-all",["nl-nl","en-us","da","fi-fi","pt-pt","hu","sk","sl","pl","ca","sv","zh-tw","ar","en-gb","he-il","de-de","ko-kr","ja-jp","ro","az","nb","ru","es-es","th","cs","it-it","pt-br","fr-fr","el","tr","zh-cn"]);});define("esri/dijit/AttributeInspector-all",["dijit","dojo","dojox","dojo/require!esri/layers/FeatureLayer,esri/dijit/AttributeInspector"],function(_729,dojo,_72a){dojo.provide("esri.dijit.AttributeInspector-all");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.dijit.AttributeInspector");});