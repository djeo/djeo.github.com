//>>built
require({cache:{"djeo/djeo/Engine":function(){define("djeo/djeo/Engine",["require","dojo/_base/declare","dojo/has","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-geometry","dojo/on","../_base","../dojox/gfx","../dojox/gfx/matrix","../Engine","./Placemark","../util/geometry","../_tiles"],function(o,r,k,p,l,t,j,f,e,m,c,d,a,b,g){var n={mouseover:"onmouseover",mouseout:"onmouseout",click:"onclick"};return r([d],{scaleFactor:1.2,correctionScale:1E4,pointZoomFactor:0.01,resizePoints:!0,
resizeLines:!0,resizeAreas:!0,correctScale:!1,layers:null,_layerReg:null,container:null,constructor:function(){this._require=o;p.mixin(this.ignoredDependencies,{Highlight:1,Tooltip:1});this._supportedLayers=g;this._initBasicFactories(new a({map:this.map,engine:this}))},initialize:function(a){var b=this.map;this.map.container.style.overflow="hidden";this.container=t.create("div",{style:{width:"100%",height:"100%",position:"relative"}},b.container);this.surface=m.createSurface(this.container,b.width,
b.height);this.surface.rawNode.style.position="absolute";this.group=this.surface.createGroup();if(b.resizePoints!==void 0)this.resizePoints=b.resizePoints;if(b.resizeLines!==void 0)this.resizeLines=b.resizeLines;if(b.resizeAreas!==void 0)this.resizeAreas=b.resizeAreas;if(b.resizePoints!==void 0)this.resizePoints=b.resizePoints;if(b.resizeLines!==void 0)this.resizeLines=b.resizeLines;if(b.resizeAreas!==void 0)this.resizeAreas=b.resizeAreas;this.initialized=!0;a()},createContainer:function(a){return a.createGroup()},
prepare:function(){var a=this.map.getBbox();if(a)this.extent=a;var b=a[3]-a[1];if(a[2]-a[0]<1E3||b<1E3)this.correctScale=!0;this.factories.Placemark.init();this.factories.Placemark.prepare()},getTopContainer:function(){return this.group},onForFeature:function(a,b,c,g){var d=[],c=this.normalizeCallback(a,b,c,g),b=n[b];l.forEach(a.baseShapes,function(a){d.push([a,a.connect(b,c)])});return d},disconnect:function(a){l.forEach(a,function(a){a[0].disconnect(a[1])})},destroy:function(){this.surface.destroy()},
onForMap:function(a,b,c){return f(this.map.container,a,p.hitch(this,function(a){var h=j.position(this.container,!0),h=this.map.containerPixelToCoords(a.pageX-h.x,a.pageY-h.y);b.call(c,{mapCoords:h,nativeEvent:a})}))},_on_zoom_changed:function(a,b,c){return f(this,a,p.hitch(c,b))},_on_extent_changed:function(a,b,c){return f(this,a,p.hitch(c,b))},zoomTo:function(a){var b=this.map,g=a[2]-a[0],d=a[3]-a[1],n=(this.group.getTransform()||{xx:1}).xx,i=Math.min(b.width/g,b.height/d),e=this.factories.Placemark,
f=e.getX(a[0]),m=e.getY(a[3]);g==0&&d==0&&(g=b.extent||b.getBbox(),i=this.pointZoomFactor*Math.min(g[2]-g[0],g[3]-g[1]),b.width>b.height?(d=i,g=b.width/b.height*i):(g=i,d=b.height/b.width*i),i=b.width/g,f=e.getX(a[0]-g/2),m=e.getY(a[3]+d/2));var j=this.layers;j.length&&(l.forEach(j,function(b){b.zoomTo(a)}),j[0].discreteScales&&(i=j[0].getScale()));j=i;this.correctScale&&(i/=this.correctionScale);this.group.setTransform([c.translate((b.width-j*g)/2,(b.height-j*d)/2),c.scale(i),c.translate(-f,-m)]);
n!=i&&(e.calculateLengthDenominator(),this.resizeFeatures(this.map.document,n/i));this.onzoom_changed()},resizeFeatures:function(a,b){l.forEach(a.features,function(a){a.isPlacemark?this._resizePlacemark(a,b):a.isContainer&&this.resizeFeatures(a,b)},this)},_resizePlacemark:function(a,b){if(!a.invalid&&(this.resizePoints&&a.isPoint()?l.forEach(a.baseShapes,function(a){a.applyRightTransform(c.scale(b))}):m.renderer!="vml"&&!(m.renderer=="svg"&&(k("webkit")||k("opera")))&&(this.resizeLines&&a.isLine()||
this.resizeAreas&&a.isArea())&&l.forEach(a.baseShapes,function(a){var c=a.getStroke();c&&(c.width*=b,a.setStroke(c))}),a.textShapes)){var g=this.map.engine.factories.Placemark._calculateTextPosition(a);l.forEach(a.textShapes,function(a){a.setTransform(g)})}},_setCamera:function(a){var b=this.map,g=b.engine.factories.Placemark,d=e.scales[a.zoom],n=g.getX(a.center[0]-b.width/d/2),i=g.getY(a.center[1]+b.height/d/2),f=this.layers;f.length&&l.forEach(f,function(b){b._setCenterAndZoom(a.center,a.zoom)},
this);this.correctScale&&(d/=this.correctionScale);this.group.setTransform([c.scale(d),c.translate(-n,-i)]);g.calculateLengthDenominator();this.resizeFeatures(b.document,1/d)},_set_center:function(a){var a=this.map.getCoords(a),b=this.map,g=b.engine.factories.Placemark,d=(this.group.getTransform()||{xx:1}).xx,n=d,i=this.layers;i.length&&l.forEach(i,function(b){b.setCenter(a)},this);this.correctScale&&(n*=this.correctionScale);i=g.getX(a[0]-b.width/n/2);b=g.getY(a[1]+b.height/n/2);this.group.setTransform([c.scale(d),
c.translate(-i,-b)])},_get_center:function(){var a=this.map;return this.containerPixelToCoords(a.width/2,a.height/2)},_set_zoom:function(a){var b=this.map;if(!(a<b.minZoom||a>b.maxZoom)){var c=(this.group.getTransform()||{xx:1}).xx,c=e.scales[a]/c,g=this.layers;g.length&&l.forEach(g,function(b){b.setZoom(a)});this.group.applyLeftTransform({xx:c,yy:c,dx:b.width/2*(1-c),dy:b.height/2*(1-c)});this.factories.Placemark.calculateLengthDenominator();this.resizeFeatures(this.map.document,1/c);this.onzoom_changed()}},
_get_zoom:function(){return this.layers.length?this.layers[0].zoom:-1},_get_extent:function(){var a=this.map,b=this.containerPixelToCoords(0,a.height),a=this.containerPixelToCoords(a.width,0);return[b[0],b[1],a[0],a[1]]},containerPixelToCoords:function(a,b){var c=this.group.getTransform(),g=c.xx,d=-c.dx/g,c=-c.dy/g;this.correctScale&&(d/=this.correctionScale,c/=this.correctionScale);this.correctScale&&(g*=this.correctionScale);d+=this.extent[0]+a/g;c=this.extent[3]-c-b/g;return[d,c]},_appendDiv:function(a){this.container.children[0].appendChild(a)}})})},
"tiles/BaseTileable":function(){define("tiles/BaseTileable",["dojo/_base/declare","dojo/has","dojo/_base/window","dojo/_base/lang","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/_base/sniff"],function(o,r,k,p,l,t,j){var f;if(r("webkit")){t=k.doc.createElement("div");t.style.webkitTransform="translate3d(0px,1px,0px)";k.doc.documentElement.appendChild(t);var e=k.doc.defaultView.getComputedStyle(t,"")["-webkit-transform"];f=e&&e.indexOf("matrix")===0;k.doc.documentElement.removeChild(t)}var m=
function(c,d){c.style.KhtmlUserSelect=d?"auto":"none";c.style.MozUserSelect=d?"":"none";c.onselectstart=d?null:function(){return!1};if(r("ie")){c.unselectable=d?"":"on";for(var a=c.getElementsByTagName("*"),b=0;b<a.length;b++)a[b].unselectable=d?"":"on"}};return o(null,{maxSpeed:500,scrollBar:!1,constraint:!1,numTilesX:0,numTilesY:0,tileBounds:null,wrapHor:!1,tiles:null,ltTile:null,rtTile:null,lbTile:null,rbTile:null,tileSize:256,zoom:0,center:null,setTileContent:null,offsetX:0,offsetY:0,extraTilesL:0,
extraTilesR:0,extraTilesT:0,extraTilesB:0,swapThresholdX:1,swapThresholdY:1,_left:0,_top:0,constructor:function(c,d){this.kwArgs=c;p.isString(d)&&(d=l.byId(d));this.domNode=d;if(!dojo.isArray(this.tileSize))this.tileSize=[this.tileSize,this.tileSize];if(c.zoom!==void 0)this.zoom=c.zoom;if(!c.extent){var a=Math.pow(2,this.zoom);this.extent=[0,0,this.tileSize[0]*a,this.tileSize[1]*a]}if(!c.center)this.center=[0,0];if(!c.setTileContent)this.setTileContent=function(){};this.tiles=[];this.tileBounds=[];
if(c.extraTiles!==void 0)this.extraTilesB=this.extraTilesT=this.extraTilesR=this.extraTilesL=a=c.extraTiles},_calculateTileBounds:function(){var c=this.tileBounds,d=this.extent,a=this.tileSize;c[0]=Math.floor((d[0]+1)/a[0]);c[1]=Math.floor((d[1]+1)/a[1]);c[2]=Math.floor((d[2]-1)/a[0]);c[3]=Math.floor((d[3]-1)/a[1])},_mixin:function(){p.mixin(this,this.kwArgs);delete this.kwArgs},_buildRendering:function(){this.containerNode=j.create("div",{style:{position:"relative"}});this.containerNode.style.height=
(k.global.innerHeight||k.doc.documentElement.clientHeight)*2+"px";this.buildTiles();this.domNode.appendChild(this.containerNode);this.touchNode=this.domNode;m(this.domNode,!1)},buildTiles:function(){this.updateDivDimensions();this.numTilesX=1+Math.ceil(this.width/this.tileSize[0])+this.extraTilesL+this.extraTilesR;this.numTilesY=1+Math.ceil(this.height/this.tileSize[1])+this.extraTilesT+this.extraTilesB;for(var c=this.tiles,d=0,a=0;a<this.numTilesX;a++)for(var b=0;b<this.numTilesY;b++){c[d]={empty:!0,
div:j.create("div",{style:{position:"absolute",left:a*this.tileSize[0]+"px",top:b*this.tileSize[1]+"px",width:this.tileSize[0]+"px",height:this.tileSize[1]+"px"}},this.containerNode),l:a!=0?c[d-this.numTilesY]:null,t:b!=0?c[d-1]:null,r:null,b:null,x:a,y:b};if(a!=0)c[d-this.numTilesY].r=c[d];if(b!=0)c[d-1].b=c[d];d++}this.ltTile=this.tiles[0];this.lbTile=this.tiles[this.numTilesY-1];this.rtTile=this.tiles[this.numTilesY*(this.numTilesX-1)];this.rbTile=this.tiles[this.numTilesY*this.numTilesX-1]},_startup:function(){this.updateTileDivs()},
doZoom:function(c,d,a){this.updateDivDimensions();if(d===void 0)d=this.halfWidth,a=this.halfHeight;var b=Math.pow(2,c-this.zoom);this.zoom=c;for(c=0;c<4;c++)this.extent[c]=Math.floor(b*this.extent[c]);this._calculateTileBounds();var c=this.getPos(),g=b*(-this._top+(this.y1-this.tileOffsetY)*this.tileSize[1]-c.y+a);this.center[0]=b*(-this._left+(this.x1-this.tileOffsetX)*this.tileSize[0]-c.x+d)+this.halfWidth-d;this.center[1]=g+this.halfHeight-a;this.updateTileDivs()},updateDivDimensions:function(){this.width=
this.domNode.clientWidth;this.height=this.domNode.clientHeight;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2)},updateTileDivs:function(){var c=this.center,d=this.tileBounds,a=c[0]-(this.width-this.halfWidth),b=c[1]-(this.height-this.halfHeight),c=a%this.tileSize[0],g=b%this.tileSize[1],a=(a-c)/this.tileSize[0],b=(b-g)/this.tileSize[1],n=0,h=0;c<0&&(n=-c,n=1+(n-n%this.tileSize[0])/this.tileSize[0],c+=n*this.tileSize[0]);g<0&&(h=-g,h=1+(h-h%this.tileSize[1])/this.tileSize[1],
g+=h*this.tileSize[1]);c+=this.extraTilesL*this.tileSize[0];g+=this.extraTilesT*this.tileSize[1];n+=this.extraTilesL;h+=this.extraTilesT;a<d[0]&&(n+=d[0]-a,a=d[0]);b<d[1]&&(h+=d[1]-b,b=d[1]);this.x1=a;this.y1=b;this.tileOffsetX=n;this.tileOffsetY=h;for(var q=this.ltTile,e=0;e<this.numTilesX;e++)for(var f=q,m=0;m<this.numTilesY;m++){var i=e+a-n,w=m+b-h,j=i>=d[0]&&i<=d[2];if(w>=d[1]&&w<=d[3]&&(j||this.wrapHor)){this.wrapHor&&!j&&(i>d[2]?i=d[0]+(i-d[2]-1)%(d[2]-d[0]+1):i<d[0]&&(i=d[2]+(i-d[0]+1)%(d[2]-
d[0]+1)));if(q.empty)q.empty=!1;this.setTileContent(q,this.zoom,i,w)}else q.empty||this.clearTile(q);q=q.b?q.b:f.r}this.offsetX=-this._left-c;this.offsetY=-this._top-g;this.scrollTo({x:this.offsetX,y:this.offsetY})},clearTile:function(c){c.div.removeChild(c.img);delete c.img;c.empty=!0},_renderTile:function(c,d,a){var b=this.tileBounds,d=d+this.x1-this.tileOffsetX,a=a+this.y1-this.tileOffsetY,g=d>=b[0]&&d<=b[2];if(a>=b[1]&&a<=b[3]&&(g||this.wrapHor)){this.wrapHor&&!g&&(d>b[2]?d=b[0]+(d-b[2]-1)%(b[2]-
b[0]+1):d<b[0]&&(d=b[2]+(d-b[0]+1)%(b[2]-b[0]+1)));if(c.empty)c.empty=!1;this.setTileContent(c,this.zoom,d,a)}else c.empty||this.clearTile(c)},onTouchMove:function(c,d){var a=this.getPos(),b=a.x-this.offsetX,g=a.y-this.offsetY,n=(b-b%this.tileSize[0])/this.tileSize[0],h=(g-g%this.tileSize[1])/this.tileSize[1];this.swapTiles(Math.abs(n)>=this.swapThresholdX?n:0,Math.abs(h)>=this.swapThresholdY?h:0);if(Math.abs(n)>=this.swapThresholdX)this.offsetX=a.x-b%this.tileSize[0];if(Math.abs(h)>=this.swapThresholdY)this.offsetY=
a.y-g%this.tileSize[1];this.scrollTo({x:this.startPos.x+c,y:this.startPos.y+d})},swapTiles:function(c,d){if(c){var a=this.ltTile,b=a,g=this.rtTile,n=g,h=this.lbTile,q=this.rbTile,e=Math.abs(c);if(e>1)for(var f=1;f<e;f++)b=b.r,n=g.l,h=h.r,q=q.l;var m=this._left;c<0?(this.ltTile=b.r,this.rtTile=b,this.lbTile=h.r,this.rbTile=h,m+=this.numTilesX*this.tileSize[0]):(this.ltTile=n,this.rtTile=n.l,this.lbTile=q,this.rbTile=q.l,m-=this.tileSize[0]);this._left-=c*this.tileSize[0];for(f=0;f<this.numTilesY;f++){if(c<
0){for(var h=a,i=0;i<e;i++)h.div.style.left=m+i*this.tileSize[0]+"px",this._renderTile(h,this.numTilesX+i,f),h=h.r;b.r.l=null;b.r=null}else{h=g;for(i=0;i<e;i++)h.div.style.left=m-i*this.tileSize[0]+"px",this._renderTile(h,-1-i,f),h=h.l;n.l.r=null;n.l=null}g.r=a;a.l=g;a=a.b;b=b.b;n=n.b;g=g.b}this.x1-=c}if(d){q=h=this.lbTile;b=a=this.ltTile;n=this.rbTile;g=this.rtTile;m=Math.abs(d);if(e>1)for(f=1;f<e;f++)q=q.t,b=b.b,n=n.t,g=g.b;e=this._top;d<0?(this.ltTile=b.b,this.lbTile=b,this.rtTile=g.b,this.rbTile=
g,e+=this.numTilesY*this.tileSize[1]):(this.ltTile=q,this.lbTile=q.t,this.rtTile=n,this.rbTile=n.t,e-=this.tileSize[1]);this._top-=d*this.tileSize[1];for(f=0;f<this.numTilesX;f++){if(d<0){g=a;for(i=0;i<m;i++)g.div.style.top=e+i*this.tileSize[1]+"px",this._renderTile(g,f,this.numTilesY+i),g=g.b;b.b.t=null;b.b=null}else{g=h;for(i=0;i<m;i++)g.div.style.top=e-i*this.tileSize[1]+"px",this._renderTile(g,f,-1-i),g=g.t;q.t.b=null;q.t=null}a.t=h;h.b=a;h=h.r;q=q.r;b=b.r;a=a.r}this.y1-=d}},slideTo:function(){},
scrollTo:function(c){var d=this.containerNode.style;r("webkit")?d.webkitTransform=this.makeTranslateStr(c):(d.top=Math.round(c.y)+"px",d.left=Math.round(c.x)+"px");this._pos=c},makeTranslateStr:function(c){var d=c.y+"px",c=c.x+"px";return f?"translate3d("+c+","+d+",0px)":"translate("+c+","+d+")"},getPos:function(){return this._pos||{x:0,y:0}}})})},"djeo/util/geometry":function(){define("djeo/util/geometry",["./bbox"],function(o){return{center:function(r){var r=o.get(r),k;r&&(k=[(r[0]+r[2])/2,(r[1]+
r[3])/2]);return k}}})},"djeo/djeo/Moveable":function(){define("djeo/djeo/Moveable",["dojo/_base/declare","dojo/_base/event","dojo/on","dojo/touch","dojo/_base/lang","dojo/dom-class","./Mover"],function(o,r,k,p,l,t,j){return o(null,{delay:0,constructor:function(f,e){this.node=f;this.map=e;this.mover=j;this._pressHandle=k(f,p.press,l.hitch(this,this.onPress))},destroy:function(){this._pressHandle.remove();delete this._pressHandle},onPress:function(f){if(this.delay)this._onMoveHandle=k(this.node,p.move,
l.hitch(this,this._onMove)),this._onReleaseHandle=k(this.node,p.release,l.hitch(this,this.onRelease)),this._lastX=f.pageX,this._lastY=f.pageY;else this.onDragDetected(f);r.stop(f)},_onMove:function(f){if(Math.abs(f.pageX-this._lastX)>this.delay||Math.abs(f.pageY-this._lastY)>this.delay)this.onRelease(f),this.onDragDetected(f);r.stop(f)},onRelease:function(f){this._onReleaseHandle.cancel();this._onMoveHandle.cancel();delete this._onReleaseHandle;r.stop(f)},onDragDetected:function(f){new this.mover(this.node,
f,this)},onMoveStart:function(){},onMoveStop:function(){},onFirstMove:function(){for(var f=this.map.engine,e=0;e<f.layers.length;e++)f.layers[e].setStartPos()},onMove:function(f,e,m,c,d){this.onMoving(f,e,m,c,d);var a=this.map.engine;a.group.applyLeftTransform({dx:c,dy:d});if(a._infoWindow){s=a._infoWindow.domNode.style;var b=s.left,g=s.top;s.left=b?parseInt(b.substr(0,b.length-2))+c:c;s.top=g?parseInt(g.substr(0,g.length-2))+d:d}for(b=0;b<a.layers.length;b++)a.layers[b].onMove(e,m);this.onMoved(f,
e,m,c,d)},onMoving:function(){},onMoved:function(){}})})},"djeo/djeo/Mover":function(){define("djeo/djeo/Mover",["dojo/_base/declare","dojo/has","dojo/_base/event","dojo/on","dojo/touch","dojo/_base/lang","dojo/_base/sniff"],function(o,r,k,p,l,t){return o(null,{constructor:function(j,f,e){this.node=j;this.startX=f.touches?f.touches[0].pageX:f.pageX;this.startY=f.touches?f.touches[0].pageY:f.pageY;this.mouseButton=f.button;f=this.host=e;j=j.ownerDocument;this._onFirstMove=p(j,l.move,t.hitch(this,this.onFirstMove));
this._onMouseMove=p(j,l.move,t.hitch(this,this.onMouseMove));this._onMouseUp=p(j,l.release,t.hitch(this,this.onMouseUp));if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(j){var f=j.touches?j.touches[0].pageX:j.pageX,e=j.touches?j.touches[0].pageY:j.pageY;this.host.onMove(this,this.startPosX+(f-this.startX),this.startPosY+(e-this.startY),f-this.lastX,e-this.lastY,j);this.lastX=f;this.lastY=e;k.stop(j)},onMouseUp:function(j){(r("webkit")&&r("mac")&&this.mouseButton==2?j.button==0:this.mouseButton==
j.button)&&this.destroy();k.stop(j)},onFirstMove:function(j){var f=this.node.style,e=this.host;this.startPosX=Math.round(parseFloat(f.left))||0;this.startPosY=Math.round(parseFloat(f.top))||0;this.lastX=this.startX;this.lastY=this.startY;if(e&&e.onFirstMove)e.onFirstMove(this,j);this._onFirstMove.remove();delete this._onFirstMove},destroy:function(){this._onFirstMove&&this._onFirstMove.remove();this._onMouseUp.remove();this._onMouseMove.remove();var j=this.host;if(j&&j.onMoveStop)j.onMoveStop(this);
this._onFirstMove=this._onMouseMove=this._onMouseUp=this._onFirstMove=this.node=this.host=null}})})},"djeo/projection":function(){define("djeo/projection",["dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","./Map","./Placemark","./FeatureContainer","./util/_base","./util/bbox"],function(o,r,k,p,l,t,j,f){var e={},m,c={},d={},a=function(a,b,c){return m.transform(a,b,c)},b=function(a,b,c){return Proj4js.transform(a,b,c)},g=function(a,b,g){return c[a][b](g)},n=function(a,b,c,g,d,h,e){a==1?(b=h(g,
d,{x:b[0],y:b[1]}),c.push(b.x,b.y),f.extend(e,[b.x,b.y])):r.forEach(b,function(b){var q=[];n(a-1,b,q,g,d,h,e);c.push(q)})};e.transform=function(i,h,e,q){var f=e,j;m?(d[i]||(d[i]=new m.Proj(i)),d[h]||(d[h]=new m.Proj(h)),d[i].readyToUse&&d[i].readyToUse&&(i=d[i],h=d[h],j=a)):k.global.Proj4js&&(d[i]||(d[i]=new Proj4js.Proj(i)),d[h]||(d[h]=new Proj4js.Proj(h)),d[i].readyToUse&&d[i].readyToUse&&(i=d[i],h=d[h],j=b));!j&&c[i]&&c[i][h]&&(j=g);if(j)if(q){var f=[],p=[Infinity,Infinity,-Infinity,-Infinity],
l=0;switch(q){case "Point":l=1;break;case "LineString":l=2;break;case "Polygon":l=3;break;case "MultiLineString":l=3;break;case "MultiPolygon":l=4}l&&n(l,e,f,i,h,j,p)}else q=j(i,h,{x:e[0],y:e[1]}),i=j(i,h,{x:e[2],y:e[3]}),f=[q.x,q.y,i.x,i.y];return f};e.addTransform=function(a,b,g){c[a]||(c[a]={});c[a][b]=g};e.setProj4js=function(a){m||(m=a)};var h=l.prototype,q=h.getCoords;h.getCoords=function(){var a=this._coords;if(!a&&(a=q.call(this))){var b=this.getProjection(),c=this.map.projection;if(b&&c&&
b!==c)this._coords=a=e.transform(b,c,a,this.getCoordsType())}return a};var h=p.prototype,y=h._get_center;h._get_center=function(){var a=y.call(this),b=this.appProjection||this.dataProjection||this.projection;this.projection&&b!=this.projection&&(a=e.transform(this.projection,b,a,"Point"));return a};var z=h._get_extent;h._get_extent=function(){var a=z.call(this),b=this.appProjection||this.dataProjection||this.projection;this.projection&&b!=this.projection&&(a=e.transform(this.projection,b,a));return a};
var A=h.containerPixelToCoords;h.containerPixelToCoords=function(a,b){var c=A.call(this,a,b),g=this.appProjection||this.dataProjection||this.projection;this.projection&&g!=this.projection&&(c=e.transform(this.projection,g,c,"Point"));return c};o.extend(l,{getProjection:function(){return this.projection||this.parent.getProjection()},getBbox:function(){var a=this._bbox;if(!a&&this.bbox){var b=this.getProjection(),c=this.map.projection;b&&c&&b!==c&&(a=null)}a||(a=f.get(this));return a}});o.extend(t,
{getProjection:function(){var a=this.projection||this._projection;if(!a)this._projection=a=this.parent.getProjection();return a}});o.extend(p,{getProjection:function(){return this.dataProjection||this.projection},getCoords:function(a,b){var c=this.appProjection||this.dataProjection||this.projection;this.projection&&c!=this.projection&&(a=e.transform(c,this.projection,a,b||"Point"));return a}});e.addTransform("EPSG:4326","EPSG:3857",function(a){return{x:j.earthRadius*a.x*Math.PI/180,y:j.earthRadius*
Math.log(Math.tan(Math.PI/4+a.y*Math.PI/360))}});e.addTransform("EPSG:3857","EPSG:4326",function(a){return{x:180*a.x/(Math.PI*j.earthRadius),y:360/Math.PI*Math.atan(Math.exp(a.y/j.earthRadius))-90}});return e})},"djeo/djeo/Placemark":function(){define("djeo/djeo/Placemark",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../dojox/gfx","../dojox/gfx/matrix","../_base","../common/Placemark","../util/geometry","../gfx"],function(o,r,k,p,l,t,j,f,e,m){var c=function(a){l.renderer==
"svg"&&!p("mozilla")&&a.rawNode.setAttribute("vector-effect","non-scaling-stroke");return a},d={family:1,size:1,weight:1,style:1,variant:1};return o([f],{multipleSymbolizers:!0,constructor:function(a){r.mixin(this,a)},init:function(){this.group=this.engine.group;this.areas=this.group.createGroup();this.lines=this.group.createGroup();this.points=this.group.createGroup();this.text=this.group.createGroup()},prepare:function(){this.calculateLengthDenominator()},calculateLengthDenominator:function(){this.lengthDenominator=
(this.group.getTransform()||{xx:1}).xx},getX:function(a){a-=this.engine.extent[0];this.engine.correctScale&&(a*=this.engine.correctionScale);return parseInt(a)},getY:function(a){a=this.engine.extent[3]-a;this.engine.correctScale&&(a*=this.engine.correctionScale);return parseInt(a)},makePoint:function(){return null},makeLineString:function(a,b){return c(this.lines.createPath({path:this.makePathString(b,1)}))},makePolygon:function(a,b){return c(this.areas.createPath({path:this.makePathString(b,2)}))},
makeMultiLineString:function(a,b){return c(this.lines.createPath({path:this.makePathString(b,2)}))},makeMultiPolygon:function(a,b){return c(this.areas.createPath({path:this.makePathString(b,3)}))},applyPointStyle:function(a,b,c){var d=b.point,h=b.points,e=a.baseShapes,f=e.length;if(h){this._updateShapes(a,c,b,h,!0);var m=!1;k.forEach(h,function(h,j){var l=e[j];l&&m&&(this._removeShape(l,a),l=null);var p=this._applyPointStyle(c,b,d,h,a,l);l&&l!=p&&(m=!0,e[j]=p);j>=f&&e.push(p)},this)}else if(f>1)k.forEach(e,
function(h,e){var q=this._applyPointStyle(c,b,d,null,a,h);if(f==0||q!=h)a.baseShapes[e]=q},this);else{var h=e[0],j=this._applyPointStyle(c,b,d,null,a,h);if(f==0||h!=j)a.baseShapes[0]=j}},_applyPointStyle:function(a,b,g,d,h,e){var l=f.get("shape",b,g,d),p=f.getImgSrc(b,g,d),k,i,o,u=f.getScale(b,g,d),a=[t.translate(this.getX(a[0]),this.getY(a[1]))],x=!0,v=!e?!0:!1;if(l){if(!j.shapes[l])l=f.defaultShapeType;k=!0}else p&&(k=!1);k!==void 0&&(i=k?f.getSize(b,g,d):f.getImgSize(b,g,d));if(i)h.reg.size=[i[0],
i[1]],h.reg.scale=u;else if(e&&(o=f.get("rScale",b,g,d),k!==void 0&&o!==void 0))i=h.reg.size,u=o*h.reg.scale;k?(k=j.shapes[l],p=l=="circle"?2:Math.max(k.size[0],k.size[1]),o=u/this.lengthDenominator/p,a.push(t.scale(o*i[0],o*i[1])),l=="circle"?(e&&e.shape.type!="circle"&&(this._removeShape(e,h),v=!0,e=null),l={cx:0,cy:0,r:1},e?e.setShape(l):e=c(this.points.createCircle(l))):(e&&e.shape.type!="polyline"&&(this._removeShape(e,h),v=!0,e=null),e?e.setShape({points:k.points}):e=c(this.points.createPolyline(k.points))),
m.applyFill(e,b,g,d),m.applyStroke(e,b,g,d,p/Math.max(i[0],i[1])/u)):k===!1?(e&&e.shape.type!="image"&&(this._removeShape(e,h),v=!0,e=null),b=f.getAnchor(b,g,d,i),i={type:"image",src:this._getImageUrl(p),width:i[0],height:i[1],x:-b[0],y:-b[1]},e?e.setShape(i):e=this.points.createImage(i),a.push(t.scale(1/this.lengthDenominator*u))):e&&(e.shape.type!="image"&&m.applyFill(e,b,g,d),o!==void 0&&(e.applyRightTransform(t.scale(b.rScale)),x=!1));if(e){if(x){u=h.reg;i=u.heading;if(i===void 0){i=h.orientation;
if(r.isObject(i))i=i.heading;u.heading=i}i!==void 0&&a.push(t.rotate(i));e.setTransform(a)}v&&this._connectEvents(e,h)}return e},applyLineStyle:function(a,b,c){var d=b.line,e=b.lines,f=a.baseShapes;e?(this._updateShapes(a,c,b,e),k.forEach(e,function(a,c){this._applyLineStyle(f[c],b,d,a)},this)):k.forEach(f,function(a){this._applyLineStyle(a,b,d)},this)},_applyLineStyle:function(a,b,c,d){m.applyStroke(a,b,c,d,1/this.lengthDenominator)},applyPolygonStyle:function(a,b,c){this._updateShapes(a,c,b);this._applyPolygonStyle(a.baseShapes[0],
b,b.area)},_applyPolygonStyle:function(a,b,c){m.applyFill(a,b,c);m.applyStroke(a,b,c,null,1/this.lengthDenominator)},_updateShapes:function(a,b,c,d,e){var c=a.baseShapes,d=d?d.length:1,f=c.length;if(d>f){if(!e)for(e=f;e<d;e++)f=this.createShape(a,b),this._connectEvents(f,a),c.push(f)}else if(d<f)for(e=f-1;e>=d;e--)f=c.pop(),this._removeShape(f,a)},_connectEvents:function(a,b){var c=b.handles,d;for(d in c){var e=c[d][1],f=c[d][2],m=c[d][3];k.forEach(c[d][0],function(c,d){m[d].push([a,a.connect(c,this.engine.normalizeCallback(b,
c,f,e))])},this)}},_removeShape:function(a,b){var c=b.handles;a.removeShape();for(var d in c){var e=c[d][3];k.forEach(c[d][0],function(b,c){a.disconnect(e[c].pop()[1])})}},remove:function(a){a.visible&&k.forEach(a.baseShapes,function(b){this._removeShape(b,a)},this)},show:function(a,b){if(b){var c=a.reg.gfxContainer;delete a.reg.gfxContainer;k.forEach(a.baseShapes,function(a){c.add(a)},this)}else{if(a.baseShapes.length)a.reg.gfxContainer=a.baseShapes[0].getParent();k.forEach(a.baseShapes,function(a){a.removeShape()})}},
makeText:function(a,b){if(l.renderer!="vml"){a.textShapes&&k.forEach(a.textShapes,function(a){a.removeShape()});var c;if(a.isPoint())c=b.point;else if(a.isArea())c=b.area;if(c=f.get("text",b,c)){var d=c.label||this._getLabel(a,c);if(d)a.textShapes=[],a.reg.ts=c,c.haloFill&&c.haloRadius&&this._makeTextShape(a,d,null,{color:c.haloFill,width:2*c.haloRadius},c),this._makeTextShape(a,d,c.fill,null,c)}}},_makeTextShape:function(a,b,c,d,e){var m={},j=!0;if(a.isPoint()){if(e.hAlign)m.align=e.hAlign}else a.isArea()?
m.align="middle":j=!1;if(j)m.text=b,b=this._calculateTextPosition(a,m),m=this.text.createText(m).setTransform(b),c&&m.setFill(c),this._makeFont(m,e,f.getScale(a.reg.cs)),d&&m.setStroke(d),a.textShapes.push(m)},_calculateTextPosition:function(a,b,c){var d;d===void 0?c||(c=a.getCoords()):c=e.center(a);d=this.getX(c[0]);var c=this.getY(c[1]),h=a.reg.ts,m=f.getScale(a.reg.cs),a=[t.scaleAt(1/this.lengthDenominator,d,c)],j="dx"in h?m*h.dx:0,h="dy"in h?-m*h.dy:0;(j||h)&&a.push(t.translate(j,h));if(b)b.x=
d,b.y=c;return a},_makeFont:function(a,b,c){var e,f;for(f in d)f in b&&(e||(e={}),e[f]=b[f]);e&&(e.size&&(e.size*=c),a.setFont(e))},setCoords:function(a,b){var c=b.baseShapes,d=b.textShapes,e=b.getCoords(),f={dx:this.getX(a[0])-this.getX(e[0]),dy:this.getY(a[1])-this.getY(e[1])};k.forEach(c,function(a){a.applyLeftTransform(f)},this);d&&k.forEach(d,function(c){var d=c.getShape(),e=this._calculateTextPosition(b,d,a);c.setShape(d).setTransform(e)},this)},setOrientation:function(a,b){var c=b.reg;if(c.heading===
void 0)c.heading=0;var d=-c.heading+a;k.forEach(b.baseShapes,function(a){a.applyRightTransform(t.rotate(d))},this);c.heading=a},makePathString:function(a,b){var c="";if(b==1)for(var c="M"+this.getX(a[0][0])+","+this.getY(a[0][1]),d=1;d<a.length;d++)c+="L"+this.getX(a[d][0])+","+this.getY(a[d][1]);else k.forEach(a,function(a){c+=this.makePathString(a,b-1)},this);return c}})})},"djeo/WebTiles":function(){define("djeo/WebTiles",["dojo/_base/declare","dojo/_base/lang","./_base"],function(o,r,k){k.registerDependency("WebTiles");
return o(null,{yFirst:!1,dependency:"WebTiles",constructor:function(k){r.mixin(this,k);k=k.paramStr?k.paramStr:this.url;if(r.isString(k)){var l=k.indexOf("[");if(l>-1){var o=k.indexOf("]");parts=k.substring(l+1,o).split(",");this.url=[];for(var j=0;j<parts.length;j++)this.url[j]=k.substring(0,l)+parts[j]+k.substring(o+1)}else this.url=[k]}this.numUrls=this.url.length},startup:function(k){this.map=k;if(k=this.map.engine.getFactory("WebTiles"))r.mixin(this,k),this.init()}})})},"djeo/djeo/Navigation":function(){define("djeo/djeo/Navigation",
["dojo/_base/declare","dojo/has","dojo/on","dojo/aspect","dojo/_base/lang","dojo/_base/event","dojo/dom-geometry","../dojox/gfx","./Moveable","dojo/_base/sniff"],function(o,r,k,p,l,t,j,f,e){return o(null,{moveable:null,enable:function(m){m===void 0&&(m=!0);m?(this.moveable=new e(this.map.engine.container,this.map),this._onFirstMove=p.after(this.moveable,"onFirstMove",l.hitch(this,function(){this._moved=!0})),this._onMoveStop=p.after(this.moveable,"onMoveStop",l.hitch(this,function(){if(this._moved)this._moved=
!1,this.map.engine.emit("extent_changed")})),f.renderer!="silverlight"&&this.enableZoom(!0)):(f.renderer!="silverlight"&&this.enableZoom(!1),this._onMoveStop.remove(),this._onFirstMove.remove(),this.moveable.destroy(),this.moveable=null)},enableZoom:function(e){if(e){var c=this.map.engine,e=!r("mozilla")?"mousewheel":"DOMMouseScroll";this.wheelHandler=k(c.container,e,l.hitch(this,this._onWheel));this.dblclickHandler=k(c.container,"dblclick",l.hitch(this,function(d){this._onZoom(d,c.scaleFactor)}))}else this.dblclickHandler.remove(),
this.wheelHandler.remove(),this.wheelHandler=this.dblclickHandler=null},_onWheel:function(e){var c=e[r("mozilla")?"detail":"wheelDelta"]/(r("mozilla")?-3:120);this._onZoom(e,Math.pow(this.map.engine.scaleFactor,c))},_onZoom:function(e,c){t.stop(e);var d=this.map,a=d.engine,b=a._get_zoom();if(!(b>=0&&(b==d.minZoom&&c<1||b==d.maxZoom&&c>1))){for(var b=j.position(this.map.engine.container,!0),d=e.pageX-b.x,b=e.pageY-b.y,f=0;f<a.layers.length;f++)a.layers[f].doZoom(c,e);a.group.applyLeftTransform({xx:c,
yy:c,dx:d*(1-c),dy:b*(1-c)});a.factories.Placemark.calculateLengthDenominator();a.resizeFeatures(this.map.document,1/c);a._infoWindow&&a._infoWindow._doZoom(c,d,b);a.onzoom_changed();a.emit("extent_changed")}}})})},"djeo/_tiles":function(){define("djeo/_tiles",[],function(){var o=["WebTiles",{url:"http://[a,b,c].tile.openstreetmap.org"}];return{webtiles:["WebTiles",{}],roadmap:o,osm:o,openstreetmap:o,"osm.org":o,"openstreetmap.org":o,"mapquest-osm":["WebTiles",{url:"http://otile[1,2,3,4].mqcdn.com/tiles/1.0.0/osm"}],
"mapquest-oa":["WebTiles",{url:"http://oatile[1,2,3,4].mqcdn.com/tiles/1.0.0/sat"}],arcgis_webtiles:["WebTiles",{}]}})},"djeo/djeo/WebTiles":function(){define("djeo/djeo/WebTiles",["dojo/_base/declare","dojo/_base/lang","dojo/dom-geometry","dojo/dom-style","dojo/dom-construct","../_base","tiles/BaseTileable","../util/_base","../projection"],function(o,r,k,p,l,t,j,f){return o(null,{zoom:3,_urlCounter:0,_lastUrlIndex:0,projection:"EPSG:3857",init:function(){var e=this.map;this.container=l.create("div",
{style:{top:0,left:0,width:"100%",height:"100%",position:"absolute"}},e.engine.container,0);this.discreteScales=t.scales;this._lastUrlIndex=this.url.length-1;if(!e.dataProjection)e.dataProjection="EPSG:4326";e.engine.scaleFactor=2;this.tileable=new j({wrapHor:!0,setTileContent:r.hitch(this,this.setTileContent),extraTiles:1},this.container);this.tileable._mixin();this.tileable._buildRendering()},zoomTo:function(e){var f=this.map,c=t.scales,d=[(e[2]+e[0])/2,(e[3]+e[1])/2],e=Math.min(f.width/(e[2]-e[0]),
f.height/(e[3]-e[1])),a;if(e<=c[0])a=0;else if(f=c.length-1,e>c[f])a=f;else for(var b=0;b<f;b++)if(c[b]<e&&e<=c[b+1]){a=b;break}this._setCenterAndZoom(d,a)},_setCenterAndZoom:function(e,j){var c=this.tileable,d=Math.pow(2,j);c.extent=[0,0,c.tileSize[0]*d,c.tileSize[1]*d];c._calculateTileBounds();var d=c.extent,a=e[0]/(2*Math.PI*f.earthRadius/d[2]),b=e[1]/(2*Math.PI*f.earthRadius/d[3]);a+=d[2]/2;b=-b+d[3]/2;c.center=[a,b];c.zoom=j;this.tileable.updateTileDivs();this.zoom=j},setCenter:function(e){this._setCenterAndZoom(e,
this.zoom)},setZoom:function(e){this.tileable.doZoom(e);this.zoom=e},onMove:function(e,f){this.tileable.onTouchMove(e,f)},setStartPos:function(){this.tileable.startPos=this.tileable.getPos()},getScale:function(){return this.discreteScales[this.zoom]},doZoom:function(e,f){var c=k.position(this.container,!0),d=f.pageX-c.x-p.get(this.container,"borderLeftWidth"),c=f.pageY-c.y-p.get(this.container,"borderTopWidth");this.zoom+=(e>1?e:-1/e)/2;this.tileable.doZoom(this.zoom,d,c)},setTileContent:function(e,
f,c,d){e.img&&e.div.removeChild(e.img);f=l.create("img",{width:256,height:256,src:this.url[this._urlCounter]+"/"+f+"/"+(this.yFirst?d:c)+"/"+(this.yFirst?c:d)+".png"},e.div);e.img=f;this._urlCounter==this._lastUrlIndex?this._urlCounter=0:this._urlCounter++}})})}}});define("djeo/native",[],1);